const w=o=>o.replace(/[?#].*/,""),i=["acumatica.com","adobe.com","adp.com","airtable.com","amazon.au","amazon.ca","amazon.co.uk","amazon.com","amazon.de","amazon.fr","amazon.jp","anthropic.com","appfolio.com","apple.com","asana.com","atlassian.com","atlassian.net","azure.com","azurewebsites.net","bing.com","box.com","calendly.com","canva.com","ceridian.com","chatgpt.com","classlink.com","claude.ai","clickup.com","concur.com","concursolutions.com","confluence.com","cornerstoneondemand.com","csod.com","datadog.com","dayforce.com","docusign.com","docusign.net","doubleclick.net","dropbox.com","dynamics.com","facebook.com","figma.com","force.com","freshworks.com","github.com","gitlab.com","gmail.com","gohighlevel.com","gong.io","google.com","googleapis.com","grammarly.com","hubspot.com","icloud.com","indeed.com","infor.com","intacct.com","intercom.com","intercom.io","intuit.com","invisalign.com","jira.com","linkedin.com","live.com","localhost","login.microsoftonline.com","loom.com","mailchimp.com","microsoft.com","microsoft365.com","mindbody.com","miro.com","mixpanel.com","monday.com","myshopify.com","myworkday.com","netsuite.com","notion.com","notion.so","odoo.com","office.com","office365.com","okta.com","onedrive.live.com","openai.com","oracle.com","oraclecloud.com","outlook.live.com","outlook.office.com","outlook.office365.com","pagerduty.com","paycom.com","paylocity.com","pipedrive.com","powerapps.com","powerschool.com","prismhr.com","procore.com","saashr.com","salesforce.com","sap.com","scribehow.com","scribe.com","segment.com","sendgrid.com","service-now.com","servicenow.com","servicetitan.com","sharepoint.com","shopify.com","sigmacomputing.com","slack.com","smartsheet.com","snowflake.com","splunk.com","squarespace.com","stripe.com","tableau.com","teams.microsoft.com","trello.com","twilio.com","ukg.com","ultipro.com","webflow.com","wix.com","workday.com","xero.com","youtube.com","zendesk.com","zoho.com","zoom.com","zoom.us"],_=new Set(i.map(o=>o.toLowerCase())),b=new Set(i.map(o=>`.${o.toLowerCase()}`));function v(o){try{const c=new URL(o).hostname.toLowerCase();if(_.has(c))return!0;const e=c.split(".");for(let t=1;t<e.length;t+=1){const h=`.${e.slice(t).join(".")}`;if(b.has(h))return!0}return!1}catch{return console.warn("[URL Streaming] Invalid URL for domain check:",o),!1}}var k=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};k.SENTRY_RELEASE={id:"8effd506599f6fafb1a48c2ce96f05fa857d4332"};let n=!1,r=!1,m=null;const T=200;let a=null,s=0;const L=5*60*1e3,l=async()=>{const o=Date.now();return a&&o-s<L?a:new Promise(c=>{try{chrome.runtime.sendMessage({messageType:"getUserData"},e=>{if(chrome.runtime.lastError){chrome.runtime.lastError.message,c(null);return}a={user_id:e==null?void 0:e.user_id,active_org_id:e==null?void 0:e.active_org_id,super_org_id:e==null?void 0:e.super_org_id,url_streaming:e==null?void 0:e.url_streaming},s=o,c(a)})}catch{c(null)}})},d=()=>{m&&clearTimeout(m),m=window.setTimeout(async()=>{try{const o=await l();if(!o)return;const c={url:w(window.location.href),timestamp:Date.now(),user_id:o.user_id,active_org_id:o.active_org_id,super_org_id:o.super_org_id};chrome.runtime.sendMessage({messageType:"stream_url_data",data:c},e=>{chrome.runtime.lastError&&chrome.runtime.lastError.message})}catch(o){console.error("[URL Streaming] Error streaming URL:",o)}},T)},u=()=>{d()},p=o=>{["Shift","Control","Alt","Meta"].includes(o.key)||d()},g=()=>{chrome.runtime.onMessage.addListener(o=>{o.messageType==="startRecording"||o.messageType==="browserStartRecording"||o.messageType==="openGuideMeSidepanel"||o.messageType==="guideMeStepForward"||o.messageType==="getGuideMeSessionId"||o.messageType==="startCopilot"||o.messageType==="startCopilotSearch"||o.messageType==="recaptureStep"||o.messageType==="currentVisibleAction"?(n=!0,E()):(o.messageType==="endRecording"||o.messageType==="optionsChanged"||o.messageType==="browserDeleteRecording"||o.messageType==="browserCompleteCapture")&&(n=!1,f())}),f()},f=()=>{r||n||(document.addEventListener("pointerdown",u,{capture:!0}),document.addEventListener("keydown",p,{capture:!0}),r=!0)},S=()=>{m&&(clearTimeout(m),m=null),a=null,s=0},E=()=>{r&&(S(),document.removeEventListener("pointerdown",u,{capture:!0}),document.removeEventListener("keydown",p,{capture:!0}),r=!1)},z=async()=>{var o;try{return!!((o=await l())!=null&&o.url_streaming)}catch{return!1}},y=()=>{z().then(o=>{o&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",g):g())}).catch(o=>{})};chrome.runtime.onMessage.addListener(o=>{o.messageType==="optionsChanged"&&y()}),y();export{v as shouldStreamUrl};
