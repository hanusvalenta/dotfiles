const w=o=>o.replace(/[?#].*/,""),i=["acumatica.com","adobe.com","adp.com","airtable.com","amazon.au","amazon.ca","amazon.co.uk","amazon.com","amazon.de","amazon.fr","amazon.jp","anthropic.com","appfolio.com","apple.com","asana.com","atlassian.com","atlassian.net","azure.com","azurewebsites.net","bing.com","box.com","calendly.com","canva.com","ceridian.com","chatgpt.com","classlink.com","claude.ai","clickup.com","concur.com","concursolutions.com","confluence.com","cornerstoneondemand.com","csod.com","datadog.com","dayforce.com","docusign.com","docusign.net","doubleclick.net","dropbox.com","dynamics.com","facebook.com","figma.com","force.com","freshworks.com","github.com","gitlab.com","gmail.com","gohighlevel.com","gong.io","google.com","googleapis.com","grammarly.com","hubspot.com","icloud.com","indeed.com","infor.com","intacct.com","intercom.com","intercom.io","intuit.com","invisalign.com","jira.com","linkedin.com","live.com","localhost","login.microsoftonline.com","loom.com","mailchimp.com","microsoft.com","microsoft365.com","mindbody.com","miro.com","mixpanel.com","monday.com","myshopify.com","myworkday.com","netsuite.com","notion.com","notion.so","odoo.com","office.com","office365.com","okta.com","onedrive.live.com","openai.com","oracle.com","oraclecloud.com","outlook.live.com","outlook.office.com","outlook.office365.com","pagerduty.com","paycom.com","paylocity.com","pipedrive.com","powerapps.com","powerschool.com","prismhr.com","procore.com","saashr.com","salesforce.com","sap.com","scribehow.com","scribe.com","segment.com","sendgrid.com","service-now.com","servicenow.com","servicetitan.com","sharepoint.com","shopify.com","sigmacomputing.com","slack.com","smartsheet.com","snowflake.com","splunk.com","squarespace.com","stripe.com","tableau.com","teams.microsoft.com","trello.com","twilio.com","ukg.com","ultipro.com","webflow.com","wix.com","workday.com","xero.com","youtube.com","zendesk.com","zoho.com","zoom.com","zoom.us"],f=new Set(i.map(o=>o.toLowerCase())),b=new Set(i.map(o=>`.${o.toLowerCase()}`));function v(o){try{const c=new URL(o).hostname.toLowerCase();if(f.has(c))return!0;const e=c.split(".");for(let a=1;a<e.length;a+=1){const h=`.${e.slice(a).join(".")}`;if(b.has(h))return!0}return!1}catch{return console.warn("[URL Streaming] Invalid URL for domain check:",o),!1}}var _=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};_.SENTRY_RELEASE={id:"1305c76edd7b4291b80d5f57cd104316065124a5"};let n=!1,t=!1,m=null;const k=200;let r=null,s=0;const T=5*60*1e3,L=async()=>{const o=Date.now();return r&&o-s<T?r:new Promise(c=>{try{chrome.runtime.sendMessage({messageType:"getUserData"},e=>{if(chrome.runtime.lastError){chrome.runtime.lastError.message,c(null);return}r={user_id:e==null?void 0:e.user_id,active_org_id:e==null?void 0:e.active_org_id,super_org_id:e==null?void 0:e.super_org_id,url_streaming:e==null?void 0:e.url_streaming},s=o,c(r)})}catch{c(null)}})},l=()=>{m&&clearTimeout(m),m=window.setTimeout(async()=>{try{const o=await L();if(!o)return;const c={url:w(window.location.href),timestamp:Date.now(),user_id:o.user_id,active_org_id:o.active_org_id,super_org_id:o.super_org_id};chrome.runtime.sendMessage({messageType:"stream_url_data",data:c},e=>{chrome.runtime.lastError&&chrome.runtime.lastError.message})}catch(o){console.error("[URL Streaming] Error streaming URL:",o)}},k)},d=()=>{l()},u=o=>{["Shift","Control","Alt","Meta"].includes(o.key)||l()},p=()=>{chrome.runtime.onMessage.addListener(o=>{o.messageType==="startRecording"||o.messageType==="browserStartRecording"||o.messageType==="openGuideMeSidepanel"||o.messageType==="guideMeStepForward"||o.messageType==="getGuideMeSessionId"||o.messageType==="startCopilot"||o.messageType==="startCopilotSearch"||o.messageType==="recaptureStep"||o.messageType==="currentVisibleAction"?(n=!0,E()):(o.messageType==="endRecording"||o.messageType==="optionsChanged"||o.messageType==="browserDeleteRecording"||o.messageType==="browserCompleteCapture")&&(n=!1,g())}),g()},g=()=>{t||n||(document.addEventListener("pointerdown",d,{capture:!0}),document.addEventListener("keydown",u,{capture:!0}),t=!0)},S=()=>{m&&(clearTimeout(m),m=null),r=null,s=0},E=()=>{t&&(S(),document.removeEventListener("pointerdown",d,{capture:!0}),document.removeEventListener("keydown",u,{capture:!0}),t=!1)},z=async()=>{try{return await new Promise(o=>{try{chrome.runtime.sendMessage({messageType:"getDWOptimizeState"},c=>{if(chrome.runtime.lastError){o(!1);return}o(!!(c!=null&&c.isUrlStreamingActive))})}catch{o(!1)}})}catch{return!1}},y=()=>{z().then(o=>{o&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",p):p())}).catch(o=>{})};chrome.runtime.onMessage.addListener(o=>{o.messageType==="optionsChanged"&&y()}),y();export{v as shouldStreamUrl};
