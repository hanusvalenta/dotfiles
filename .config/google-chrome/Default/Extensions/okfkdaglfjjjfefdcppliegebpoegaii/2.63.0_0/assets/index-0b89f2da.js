import{r as o}from"./index-8b3efc3f.js";import{h as p,u as g,P as y,a as b,j as q,m as G}from"./index-3744168d.js";import{j as w,R as H}from"./Icon-f3e43e02.js";function J(r,e=globalThis==null?void 0:globalThis.document){const n=p(r);o.useEffect(()=>{const s=t=>{t.key==="Escape"&&n(t)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[n,e])}var M="DismissableLayer",h="dismissableLayer.update",Q="dismissableLayer.pointerDownOutside",U="dismissableLayer.focusOutside",x,R=o.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),D=o.forwardRef((r,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:t,onFocusOutside:a,onInteractOutside:l,onDismiss:c,...f}=r,u=o.useContext(R),[d,S]=o.useState(null),v=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,j]=o.useState({}),F=g(e,i=>S(i)),P=Array.from(u.layers),[z]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),N=P.indexOf(z),L=d?P.indexOf(d):-1,A=u.layersWithOutsidePointerEventsDisabled.size>0,C=L>=N,I=X(i=>{const E=i.target,m=[...u.branches].some(K=>K.contains(E));!C||m||(t==null||t(i),l==null||l(i),i.defaultPrevented||(c==null||c()))},v),O=Y(i=>{const E=i.target;[...u.branches].some(m=>m.contains(E))||(a==null||a(i),l==null||l(i),i.defaultPrevented||(c==null||c()))},v);return J(i=>{L===u.layers.size-1&&(s==null||s(i),!i.defaultPrevented&&c&&(i.preventDefault(),c()))},v),o.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(x=v.body.style.pointerEvents,v.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),k(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(v.body.style.pointerEvents=x)}},[d,v,n,u]),o.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),k())},[d,u]),o.useEffect(()=>{const i=()=>j({});return document.addEventListener(h,i),()=>document.removeEventListener(h,i)},[]),w.jsx(y.div,{...f,ref:F,style:{pointerEvents:A?C?"auto":"none":void 0,...r.style},onFocusCapture:b(r.onFocusCapture,O.onFocusCapture),onBlurCapture:b(r.onBlurCapture,O.onBlurCapture),onPointerDownCapture:b(r.onPointerDownCapture,I.onPointerDownCapture)})});D.displayName=M;var V="DismissableLayerBranch",T=o.forwardRef((r,e)=>{const n=o.useContext(R),s=o.useRef(null),t=g(e,s);return o.useEffect(()=>{const a=s.current;if(a)return n.branches.add(a),()=>{n.branches.delete(a)}},[n.branches]),w.jsx(y.div,{...r,ref:t})});T.displayName=V;function X(r,e=globalThis==null?void 0:globalThis.document){const n=p(r),s=o.useRef(!1),t=o.useRef(()=>{});return o.useEffect(()=>{const a=c=>{if(c.target&&!s.current){let f=function(){W(Q,n,u,{discrete:!0})};const u={originalEvent:c};c.pointerType==="touch"?(e.removeEventListener("click",t.current),t.current=f,e.addEventListener("click",t.current,{once:!0})):f()}else e.removeEventListener("click",t.current);s.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",a),e.removeEventListener("click",t.current)}},[e,n]),{onPointerDownCapture:()=>s.current=!0}}function Y(r,e=globalThis==null?void 0:globalThis.document){const n=p(r),s=o.useRef(!1);return o.useEffect(()=>{const t=a=>{a.target&&!s.current&&W(U,n,{originalEvent:a},{discrete:!1})};return e.addEventListener("focusin",t),()=>e.removeEventListener("focusin",t)},[e,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function k(){const r=new CustomEvent(h);document.dispatchEvent(r)}function W(r,e,n,{discrete:s}){const t=n.originalEvent.target,a=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:n});e&&t.addEventListener(r,e,{once:!0}),s?q(t,a):t.dispatchEvent(a)}var _=D,Z=T,$="Portal",B=o.forwardRef((r,e)=>{var c;const{container:n,...s}=r,[t,a]=o.useState(!1);G(()=>a(!0),[]);const l=n||t&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return l?H.createPortal(w.jsx(y.div,{...s,ref:e}),l):null});B.displayName=$;export{Z as B,D,B as P,_ as R};
