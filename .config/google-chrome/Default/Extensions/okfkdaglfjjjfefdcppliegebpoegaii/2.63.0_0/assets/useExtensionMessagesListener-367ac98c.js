import{c as k,j as e}from"./Icon-f3e43e02.js";import{r as l}from"./index-8b3efc3f.js";import{n as S,k as A}from"./index-eeca2896.js";import{D as L}from"./DocumentIcon-1c27b6c5.js";import{z as N,w as $,x as E,aV as R}from"./store-f163b43d.js";import{B as z}from"./Button-97d280d1.js";import{T as P,a as U,b as F,e as O,c as V}from"./Tooltip-cd1b4e9d.js";import{u as D,a as B}from"./react-redux-52a3bd12.js";import{g as H,l as K}from"./dwResultsDB-a3d52d5f.js";const W=t=>({taskId:t.suggestedScribesTask.taskId,isAnalyzing:t.suggestedScribesTask.isAnalyzing,error:t.suggestedScribesTask.error}),G=({appIconName:t,iconUrl:s,size:r=44,className:i})=>{const[o,x]=l.useState(!1),h=k("rounded mix-blend-multiply",{hidden:!o}),u=r,n=r/2;return e.jsx("div",{className:k("relative h-fit w-fit",i),style:{width:u,height:u},children:e.jsx("div",{className:k("relative z-[1] flex items-center justify-center rounded-full bg-gradient-to-b from-white to-slate-50","shadow-[0px_2px_6px_rgba(30,41,59,0.04),_0px_1px_2px_rgba(30,41,59,0.06)]"),style:{width:n*2,height:n*2},children:e.jsx("img",{src:s,onLoad:()=>x(!0),className:h,width:n,height:n,"data-testid":"app-icon-image",alt:`${t} logo`})})})},I=l.forwardRef(({type:t,className:s,...r},i)=>e.jsx("div",{ref:i,className:k("rounded-lg border border-slate-400 border-opacity-15 px-6 py-5 dark:border-slate-700 dark:border-opacity-25",t==="linked"?"cursor-pointer bg-slate-50 hover:border-opacity-25 dark:bg-slate-900 dark:hover:border-opacity-50":"bg-white dark:bg-slate-800",s),...r})),q=({logo:t,icon:s,iconColor:r="gray",leftIcon:i,iconPosition:o="center",title:x,capturedText:h,stepsText:u,ctaLabel:n="View",onCta:w,onDelete:d,className:b,onButtonClick:m,hoverOverlay:p=!0,topIcon:a,location:g,type:y,buttonIcon:v})=>{const j=()=>{m&&!p&&(N("suggested_scribe_card_clicked",{location:g,type:y}),m())},c=()=>{N("suggested_scribe_card_cta_clicked",{location:g}),w==null||w()},C=f=>{f.stopPropagation(),N("suggested_scribe_card_delete_clicked",{location:g,type:y}),d==null||d()},_=f=>{f.stopPropagation(),N("suggested_scribe_card_arrow_clicked",{location:g,type:y}),m==null||m()},M=f=>{(f.key==="Enter"||f.key===" ")&&(f.preventDefault(),c())},T=i??(t?e.jsx(L,{logo:t}):s?e.jsx(L,{icon:s,color:r}):null);return e.jsxs(I,{className:k(`flex flex-row overflow-hidden gap-4 p-[18px] max-h-[130px] relative cursor-pointer dark:text-brand-50 dark:bg-gradient-to-b dark:from-white/25 dark:to-slate-400/20 ${o==="top"?"items-start":o==="bottom"?"items-end":"items-center"} dark:bg-brand-900/20 rounded-xl`,p&&"group",b),style:{boxShadow:"0 1px 2px 0 rgba(15, 23, 42, 0.05)"},onClick:j,children:[T&&e.jsx("div",{className:`shrink-0 flex ${o==="top"?"items-start":o==="bottom"?"items-end":"items-center"} justify-center`,children:T}),e.jsxs("div",{className:"flex flex-col gap-[6px] w-full",children:[e.jsxs("div",{className:"p-0 max-w-full",children:[e.jsx("div",{className:"flex",children:a&&e.jsx("div",{className:"mb-3 flex items-center",children:a})}),e.jsx("h3",{className:"text-sm font-semibold leading-5 m-0 text-slate-800 dark:text-slate-200 max-w-full overflow-hidden text-ellipsis line-clamp-2 max-h-[42px]",style:{width:"calc(100% + 50px)"},children:x})]}),e.jsx("div",{className:"p-0 pr-8 overflow-hidden text-ellipsis line-clamp-2 max-h-[32px]",children:e.jsxs("p",{className:"text-xs font-normal text-slate-500 dark:text-brand-50 m-0",children:[h,u?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-slate-200 dark:text-brand-50 px-2",children:"|"}),u]}):null]})})]}),a&&m&&e.jsx(z,{variant:"ghost",size:"small",onClick:_,className:"absolute bottom-4 right-4 p-2 text-slate-600 dark:text-brand-50",icon:v||S}),p&&e.jsxs("div",{className:k("absolute inset-0 z-10 flex items-center justify-center transition-opacity duration-150 rounded-xl opacity-0 backdrop-blur-sm bg-white/60 group-hover:opacity-100 group-hover:pointer-events-auto dark:bg-gradient-to-b dark:from-white dark:to-brand-300"),onClick:c,role:"button",tabIndex:0,onKeyDown:M,children:[e.jsx(z,{size:"small",variant:"secondary",onClick:c,className:"mx-auto text-slate-800",children:n}),d&&e.jsx(P,{children:e.jsxs(U,{children:[e.jsx(F,{children:e.jsx(z,{icon:A,variant:"secondary",size:"small",onClick:C,className:"absolute top-2 right-2 backdrop-blur-sm z-10 text-slate-400 hover:text-red-500"})}),e.jsx(O,{children:e.jsx(V,{children:"Discard"})})]})})]}),!a&&m&&e.jsx(z,{variant:"ghost",size:"small",onClick:_,className:"absolute bottom-4 right-4 p-2 text-slate-600 dark:text-brand-50",icon:v||S})]})};function J(t){var i,o,x;const s=(o=(i=t==null?void 0:t.active_organization)==null?void 0:i.super_organization)==null?void 0:o.id,r=(x=t==null?void 0:t.active_organization)==null?void 0:x.id;return!s||!r?null:`${s}|${r}`}const Q=()=>{const{userData:t}=D($),s=D(E),r=(s==null?void 0:s.lrr2025)??(s==null?void 0:s.lrr_2025),i=!!r&&(typeof r=="object"||typeof r=="string"),o=l.useMemo(()=>J(t),[t]),[x,h]=l.useState([]),[u,n]=l.useState(!1),[w,d]=l.useState(null),b=l.useCallback(async()=>{var p;if(!i){h([]),n(!1),d(null);return}if(!o){h([]),n(!1),d(null);return}try{n(!0),d(null);const a=((p=await H(o))==null?void 0:p.payload)??{},g=Array.isArray(a==null?void 0:a.scribes)?a.scribes:[];let y=g;try{const v=await K(o);if(v.length>0){const j=new Set(v);y=g.filter(c=>{const C=c==null?void 0:c.suggestion_id,_=c==null?void 0:c.id;return!j.has(C)&&!j.has(_)})}}catch{}h(y)}catch(a){const g=a instanceof Error?a.message:"Failed to load latest DW results";d(g)}finally{n(!1)}},[i,o]);l.useEffect(()=>{b();const p=a=>{((a==null?void 0:a.messageType)==="dwLatestResultsUpdated"||(a==null?void 0:a.messageType)==="dwHiddenUpdated")&&b()};try{chrome.runtime.onMessage.addListener(p)}catch{}return()=>{try{chrome.runtime.onMessage.removeListener(p)}catch{}}},[b]);const m=l.useCallback(async()=>{await b()},[b]);return{scribes:x,loading:u,error:w,refresh:m}},X=()=>{const t=B(),s=l.useCallback(async(r,i,o)=>{r.messageType==="loggedOut"&&(t(R()),o()),r.messageType==="pingContentScript"&&o("success"),r.messageType==="getScreenDimensions"&&o({height:screen.height,width:screen.width,screenLeft:window.screenLeft,screenTop:window.screenTop}),r.messageType==="stopTaskRecording"&&window.postMessage({messageType:"stopTaskRecording"})},[]);l.useEffect(()=>(chrome.runtime.onMessage.addListener(s),()=>{chrome.runtime.onMessage.removeListener(s)}),[s])};export{G as A,I as C,q as S,Q as a,W as s,X as u};
