import{R as y,r as l}from"./index-8b3efc3f.js";import{c as G,u as j,k as K,f as V,h as W,P as L,a as x,l as X}from"./index-3744168d.js";import{j as p}from"./Icon-f3e43e02.js";import{u as Y}from"./index-9279c646.js";function N(e){const t=e+"CollectionProvider",[i,n]=G(t),[S,b]=i(t,{collectionRef:{current:null},itemMap:new Map}),v=f=>{const{scope:o,children:s}=f,r=y.useRef(null),c=y.useRef(new Map).current;return p.jsx(S,{scope:o,itemMap:c,collectionRef:r,children:s})};v.displayName=t;const R=e+"CollectionSlot",A=K(R),m=y.forwardRef((f,o)=>{const{scope:s,children:r}=f,c=b(R,s),d=j(o,c.collectionRef);return p.jsx(A,{ref:d,children:r})});m.displayName=R;const a=e+"CollectionItemSlot",w="data-radix-collection-item",F=K(a),h=y.forwardRef((f,o)=>{const{scope:s,children:r,...c}=f,d=y.useRef(null),C=j(o,d),E=b(a,s);return y.useEffect(()=>(E.itemMap.set(d,{ref:d,...c}),()=>void E.itemMap.delete(d))),p.jsx(F,{[w]:"",ref:C,children:r})});h.displayName=a;function g(f){const o=b(e+"CollectionConsumer",f);return y.useCallback(()=>{const s=o.collectionRef.current;if(!s)return[];const r=Array.from(s.querySelectorAll(`[${w}]`));return Array.from(o.itemMap.values()).sort((c,d)=>r.indexOf(c.ref.current)-r.indexOf(d.ref.current))},[o.collectionRef,o.itemMap])}return[{Provider:v,Slot:m,ItemSlot:h},g,n]}var D="rovingFocusGroup.onEntryFocus",Z={bubbles:!1,cancelable:!0},T="RovingFocusGroup",[_,O,ee]=N(T),[oe,re]=G(T,[ee]),[te,ne]=oe(T),B=l.forwardRef((e,t)=>p.jsx(_.Provider,{scope:e.__scopeRovingFocusGroup,children:p.jsx(_.Slot,{scope:e.__scopeRovingFocusGroup,children:p.jsx(ce,{...e,ref:t})})}));B.displayName=T;var ce=l.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:i,orientation:n,loop:S=!1,dir:b,currentTabStopId:v,defaultCurrentTabStopId:R,onCurrentTabStopIdChange:A,onEntryFocus:m,preventScrollOnEntryFocus:a=!1,...w}=e,F=l.useRef(null),h=j(t,F),g=Y(b),[f,o]=V({prop:v,defaultProp:R??null,onChange:A,caller:T}),[s,r]=l.useState(!1),c=W(m),d=O(i),C=l.useRef(!1),[E,k]=l.useState(0);return l.useEffect(()=>{const u=F.current;if(u)return u.addEventListener(D,c),()=>u.removeEventListener(D,c)},[c]),p.jsx(te,{scope:i,orientation:n,dir:g,loop:S,currentTabStopId:f,onItemFocus:l.useCallback(u=>o(u),[o]),onItemShiftTab:l.useCallback(()=>r(!0),[]),onFocusableItemAdd:l.useCallback(()=>k(u=>u+1),[]),onFocusableItemRemove:l.useCallback(()=>k(u=>u-1),[]),children:p.jsx(L.div,{tabIndex:s||E===0?-1:0,"data-orientation":n,...w,ref:h,style:{outline:"none",...e.style},onMouseDown:x(e.onMouseDown,()=>{C.current=!0}),onFocus:x(e.onFocus,u=>{const H=!C.current;if(u.target===u.currentTarget&&H&&!s){const P=new CustomEvent(D,Z);if(u.currentTarget.dispatchEvent(P),!P.defaultPrevented){const M=d().filter(I=>I.focusable),$=M.find(I=>I.active),J=M.find(I=>I.id===f),Q=[$,J,...M].filter(Boolean).map(I=>I.ref.current);z(Q,a)}}C.current=!1}),onBlur:x(e.onBlur,()=>r(!1))})})}),U="RovingFocusGroupItem",q=l.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:i,focusable:n=!0,active:S=!1,tabStopId:b,children:v,...R}=e,A=X(),m=b||A,a=ne(U,i),w=a.currentTabStopId===m,F=O(i),{onFocusableItemAdd:h,onFocusableItemRemove:g,currentTabStopId:f}=a;return l.useEffect(()=>{if(n)return h(),()=>g()},[n,h,g]),p.jsx(_.ItemSlot,{scope:i,id:m,focusable:n,active:S,children:p.jsx(L.span,{tabIndex:w?0:-1,"data-orientation":a.orientation,...R,ref:t,onMouseDown:x(e.onMouseDown,o=>{n?a.onItemFocus(m):o.preventDefault()}),onFocus:x(e.onFocus,()=>a.onItemFocus(m)),onKeyDown:x(e.onKeyDown,o=>{if(o.key==="Tab"&&o.shiftKey){a.onItemShiftTab();return}if(o.target!==o.currentTarget)return;const s=ie(o,a.orientation,a.dir);if(s!==void 0){if(o.metaKey||o.ctrlKey||o.altKey||o.shiftKey)return;o.preventDefault();let r=F().filter(c=>c.focusable).map(c=>c.ref.current);if(s==="last")r.reverse();else if(s==="prev"||s==="next"){s==="prev"&&r.reverse();const c=r.indexOf(o.currentTarget);r=a.loop?ue(r,c+1):r.slice(c+1)}setTimeout(()=>z(r))}}),children:typeof v=="function"?v({isCurrentTabStop:w,hasTabStop:f!=null}):v})})});q.displayName=U;var se={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ae(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ie(e,t,i){const n=ae(e.key,i);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return se[n]}function z(e,t=!1){const i=document.activeElement;for(const n of e)if(n===i||(n.focus({preventScroll:t}),document.activeElement!==i))return}function ue(e,t){return e.map((i,n)=>e[(t+n)%e.length])}var le=B,fe=q;export{fe as I,le as R,N as a,re as c};
