import{c as u,a as M,b as f}from"./chunk-QIZ4XBKF-Cg-wv63Z.js";import"./main-kvjJkSOS.js";var w,h=(e,o,n)=>w??(w=new Promise(a=>{const r=s=>{const{data:{cmd:c,scope:l,context:m},ports:p}=s;if(c==="webext-port-offer"&&l===o&&m!==e)return window.removeEventListener("message",r),p[0].onmessage=n,p[0].postMessage("port-accepted"),a(p[0])},t=()=>{const s=new MessageChannel;s.port1.onmessage=c=>{if(c.data==="port-accepted")return window.removeEventListener("message",r),a(s.port1);n?.(c)},window.postMessage({cmd:"webext-port-offer",scope:o,context:e},"*",[s.port2])};window.addEventListener("message",r),t()})),b=e=>{let o,n=!1,a,r;return{enable:()=>n=!0,onMessage:t=>a=t,postMessage:async t=>{if(!n)throw new Error("Communication with window has not been allowed");return v(o),(await r).postMessage(t)},setNamespace:t=>{if(o)throw new Error("Namespace once set cannot be changed");o=t,r=h(e,t,({data:s})=>a?.(s))}}};function v(e){if(typeof e!="string"||e.trim().length===0)throw new Error(`webext-bridge uses window.postMessage to talk with other "window"(s) for message routingwhich is global/conflicting operation in case there are other scripts using webext-bridge. Call Bridge#setNamespace(nsps) to isolate your app. Example: setNamespace('com.facebook.react-devtools'). Make sure to use same namespace across all your scripts whereever window.postMessage is likely to be used\``)}var d=b("content-script"),g=M(),i=u("content-script",e=>{e.destination.context==="window"?d.postMessage(e):g.postMessage(e)});d.onMessage(e=>{e.origin={context:"window",tabId:null},i.handleMessage(e)});g.onMessage(i.handleMessage);g.onFailure(e=>{if(e.origin.context==="window"){d.postMessage({type:"error",transactionID:e.transactionId});return}i.endTransaction(e.transactionId)});var{sendMessage:P,onMessage:y}=i;f(i);export{y as onMessage,P as sendMessage};
