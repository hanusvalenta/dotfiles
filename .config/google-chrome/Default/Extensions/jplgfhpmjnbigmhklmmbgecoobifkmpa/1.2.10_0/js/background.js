!function(){var e={430:function(e,t,n){e.exports=n(627)},627:function(e,t){"use strict";var n=/(\w+)[-_].*/;function r(e,t){if(t[e])return t[e];var r=e.match(n);if(!r)throw new Error("Can't find lang or lcale with code "+e);return t[r[1]]}function o(e){return e>1}function i(e){return 1!==e}function a(e){return 0}var s={ach:{n:2,f:o},af:{n:2,f:i},ak:{n:2,f:o},am:{n:2,f:o},an:{n:2,f:i},ar:{n:6,f:function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5}},arn:{n:2,f:o},ast:{n:2,f:i},ay:{n:1,f:a},az:{n:2,f:i},be:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},bg:{n:2,f:i},bn:{n:2,f:i},bo:{n:1,f:a},br:{n:2,f:o},brx:{n:2,f:i},bs:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},ca:{n:2,f:i},cgg:{n:1,f:a},cs:{n:3,f:function(e){return 1===e?0:e>=2&&e<=4?1:2}},csb:{n:3,f:function(e){return 1===e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},cy:{n:4,f:function(e){return 1===e?0:2===e?1:8!==e&&11!==e?2:3}},da:{n:2,f:i},de:{n:2,f:i},doi:{n:2,f:i},dz:{n:1,f:a},el:{n:2,f:i},en:{n:2,f:i},eo:{n:2,f:i},es:{n:2,f:i},et:{n:2,f:i},eu:{n:2,f:i},fa:{n:1,f:a},ff:{n:2,f:i},fi:{n:2,f:i},fil:{n:2,f:o},fo:{n:2,f:i},fr:{n:2,f:function(e){return e<=-2||e>=2}},fur:{n:2,f:i},fy:{n:2,f:i},ga:{n:5,f:function(e){return 1===e?0:2===e?1:e<7?2:e<11?3:4}},gd:{n:4,f:function(e){return 1===e||11===e?0:2===e||12===e?1:e>2&&e<20?2:3}},gl:{n:2,f:i},gu:{n:2,f:i},gun:{n:2,f:o},ha:{n:2,f:i},he:{n:2,f:i},hi:{n:2,f:i},hne:{n:2,f:i},hr:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},hu:{n:2,f:i},hy:{n:2,f:i},id:{n:1,f:a},is:{n:2,f:function(e){return e%10!=1||e%100==11}},it:{n:2,f:i},ja:{n:1,f:a},jbo:{n:1,f:a},jv:{n:2,f:function(e){return 0!==e}},ka:{n:1,f:a},kab:{n:2,f:i},kk:{n:2,f:i},km:{n:1,f:a},kn:{n:2,f:i},ko:{n:1,f:a},ku:{n:2,f:i},kw:{n:4,f:function(e){return 1===e?0:2===e?1:3===e?2:3}},ky:{n:1,f:a},lb:{n:2,f:i},ln:{n:2,f:o},lo:{n:1,f:a},lt:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2}},lv:{n:3,f:function(e){return e%10==1&&e%100!=11?0:0!==e?1:2}},mai:{n:2,f:i},mfe:{n:2,f:o},mg:{n:2,f:o},mi:{n:2,f:o},mk:{n:2,f:function(e){return 1===e||e%10==1?0:1}},ml:{n:2,f:i},mn:{n:2,f:i},mni:{n:2,f:i},mnk:{n:3,f:function(e){return 0===e?0:1===e?1:2}},mr:{n:2,f:i},ms:{n:1,f:a},mt:{n:4,f:function(e){return 1===e?0:0===e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3}},my:{n:1,f:a},nah:{n:2,f:i},nap:{n:2,f:i},nb:{n:2,f:i},ne:{n:2,f:i},nl:{n:2,f:i},nn:{n:2,f:i},no:{n:2,f:i},nso:{n:2,f:i},oc:{n:2,f:o},or:{n:2,f:i},pa:{n:2,f:i},pap:{n:2,f:i},pl:{n:3,f:function(e){return 1===e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},pms:{n:2,f:i},ps:{n:2,f:i},pt:{n:2,f:i},rm:{n:2,f:i},ro:{n:3,f:function(e){return 1===e?0:0===e||e%100>0&&e%100<20?1:2}},ru:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},rw:{n:2,f:i},sah:{n:1,f:a},sat:{n:2,f:i},sco:{n:2,f:i},sd:{n:2,f:i},se:{n:2,f:i},si:{n:2,f:i},sk:{n:3,f:function(e){return 1===e?0:e>=2&&e<=4?1:2}},sl:{n:4,f:function(e){return e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0}},so:{n:2,f:i},son:{n:2,f:i},sq:{n:2,f:i},sr:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},su:{n:1,f:a},sv:{n:2,f:i},sw:{n:2,f:i},ta:{n:2,f:i},te:{n:2,f:i},tg:{n:2,f:o},th:{n:1,f:a},ti:{n:2,f:o},tk:{n:2,f:i},tr:{n:2,f:o},tt:{n:1,f:a},ug:{n:1,f:a},uk:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},ur:{n:2,f:i},uz:{n:2,f:o},vi:{n:1,f:a},wa:{n:2,f:o},wo:{n:1,f:a},yo:{n:2,f:i},zh:{n:1,f:a}};var c={};t.getPluralFunc=function(e){if(c[e])return c[e];var t=r(e,s),n=function(e,n){return n[+t.f(e)]};return c[e]=n,n}},972:function(e){"use strict";e.exports={appVersion:"1.2.10",appId:"jplgfhpmjnbigmhklmmbgecoobifkmpa",baseDomainURL:"https://account.proton.me",tokenDuration:1200,proxyHost:null,proxyPort:4443,singleProxyPort:!1,proxySecureCorePort:443,scheme:"https",apiDomainsExclusion:[],proxyLocalNetworkExclusion:["localhost","127.0.0.1","127.0.0.0/8","127.0.0.1:80","10.0.0.0/8","172.16.0.0/12","192.168.0.0/16","[::1]","<local>"],signupEnabled:!0,torEnabled:!1,incompatibleSoftware:["ANSES","Bitdefender","eblocker.org","ESET Endpoint Security","Kaspersky","McAfee","opendns.com","Sophos","Zscaler"],sentry:"https://5c4abb94f5a644b38cf8e3261dfad0e3@reports.proton.me/api/core/v4/reports/sentry/67"}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){"use strict";var e=function(){return"undefined"==typeof window||-1!==window.location.href.indexOf("_generated_background_page.html")};var t,r=n(972),o=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},i=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},a=r.appVersion,s=function(){return"browser-vpn@"+a},c=r.appId,u=r.baseDomainURL,l="".concat(u,"/").concat(""),f=("".concat(l,"vpn/dashboard"),"".concat(u,"/api/")),d=new URL(f).hostname,p=!0,h=r.sentry,v=i([d],o(r.apiDomainsExclusion),!1),y=r.proxyLocalNetworkExclusion,b=r.signupEnabled,m=r.torEnabled,g=r.incompatibleSoftware,w=r.tokenDuration,_=Math.floor(w/4),x=r.proxyHost,S=r.proxyPort,E=r.singleProxyPort,k=r.proxySecureCorePort,O=r.scheme,I=function(){return I=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},I.apply(this,arguments)},P=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},T=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(e){e.LOCAL="local",e.SESSION="session",e.SYNC="sync"}(t||(t={}));var C=t.LOCAL,j=C,N="bex-",D=function(e){return e===t.SESSION?sessionStorage:localStorage},L={getDefinedItem:function(e,t){return P(this,arguments,void 0,function(e,t,n){return void 0===n&&(n=C),T(this,function(r){switch(r.label){case 0:return[4,this.getItem(e,t,n)];case 1:return[2,r.sent()||t]}})})},getItem:function(e){return P(this,arguments,void 0,function(e,n,r){var o,i,a,s,c,u;return void 0===n&&(n=void 0),void 0===r&&(r=C),T(this,function(l){switch(l.label){case 0:o=N+e,l.label=1;case 1:return l.trys.push([1,5,,10]),[4,new Promise(function(e){chrome.storage[r].get(o,e)})];case 2:return"object"==typeof(i=l.sent())&&i.hasOwnProperty(o)?[2,i[o]]:r===t.LOCAL&&t.SESSION in chrome.storage?[4,new Promise(function(e){chrome.storage[t.SESSION].get(o,e)})]:[3,4];case 3:if("object"==typeof(a=l.sent())&&a.hasOwnProperty(o))return[2,a[o]];l.label=4;case 4:return[2,n];case 5:l.sent(),s=D(r),l.label=6;case 6:return l.trys.push([6,8,,9]),[4,s.getItem(o)];case 7:return"string"==typeof(c=l.sent())?[2,JSON.parse(c)]:[2,n];case 8:return l.sent(),[2,(u=window.bexStorage||(window.bexStorage={})).hasOwnProperty(e)?u[e]:n];case 9:return[3,10];case 10:return[2]}})})},setItem:function(e,t){return P(this,arguments,void 0,function(e,t,n){var r,o,i;return void 0===n&&(n=C),T(this,function(a){switch(a.label){case 0:r=N+e,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,chrome.storage[n].set((i={},i[r]=t,i))];case 2:return a.sent(),[3,4];case 3:a.sent(),o=JSON.stringify(t);try{D(n).setItem(r,o)}catch(n){(window.bexStorage||(window.bexStorage={}))[e]=t}return[3,4];case 4:return[2]}})})},removeItem:function(e){return P(this,arguments,void 0,function(e,t){var n;return void 0===t&&(t=C),T(this,function(r){switch(r.label){case 0:n=N+e,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,chrome.storage[t].remove(n)];case 2:return r.sent(),[3,4];case 3:r.sent();try{D(t).removeItem(n)}catch(t){delete(window.bexStorage||(window.bexStorage={}))[e]}return[3,4];case 4:return[2]}})})},item:function(e,t,n){void 0===t&&(t=C),void 0===n&&(n="value");var r=this;return{key:e,get:function(n){return void 0===n&&(n=void 0),r.getItem(e,n,t)},getDefined:function(n){return r.getDefinedItem(e,n,t)},load:function(){return P(this,arguments,void 0,function(n){var o;return void 0===n&&(n=void 0),T(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,r.getItem(e,n,t)];case 1:return[2,"object"==typeof(o=i.sent())?o:{}];case 2:return i.sent(),[2,{}];case 3:return[2]}})})},set:function(n){return r.setItem(e,n,t)},setValue:function(e,t){var r;return void 0===t&&(t={}),this.set(I(((r={time:Date.now()})[n]=e,r),t))},remove:function(){return r.removeItem(e,t)}}},selfItem:function(e,t){return void 0===t&&(t=C),this.item(e,t,e)}};const A=Object.prototype.toString;function R(e){switch(A.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return z(e,Error)}}function M(e,t){return A.call(e)===`[object ${t}]`}function $(e){return M(e,"ErrorEvent")}function U(e){return M(e,"DOMError")}function G(e){return M(e,"String")}function F(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function V(e){return null===e||F(e)||"object"!=typeof e&&"function"!=typeof e}function B(e){return M(e,"Object")}function H(e){return"undefined"!=typeof Event&&z(e,Event)}function q(e){return Boolean(e?.then&&"function"==typeof e.then)}function z(e,t){try{return e instanceof t}catch{return!1}}function W(e){return!("object"!=typeof e||null===e||!e.__isVue&&!e._isVue)}function Y(e){return new K(t=>{t(e)})}function J(e){return new K((t,n)=>{n(e)})}class K{constructor(e){this._state=0,this._handlers=[],this._runExecutor(e)}then(e,t){return new K((n,r)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){r(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){r(e)}else r(e)}]),this._executeHandlers()})}catch(e){return this.then(e=>e,e)}finally(e){return new K((t,n)=>{let r,o;return this.then(t=>{o=!1,r=t,e&&e()},t=>{o=!0,r=t,e&&e()}).then(()=>{o?n(r):t(r)})})}_executeHandlers(){if(0===this._state)return;const e=this._handlers.slice();this._handlers=[],e.forEach(e=>{e[0]||(1===this._state&&e[1](this._value),2===this._state&&e[2](this._value),e[0]=!0)})}_runExecutor(e){const t=(e,t)=>{0===this._state&&(q(t)?t.then(n,r):(this._state=e,this._value=t,this._executeHandlers()))},n=e=>{t(1,e)},r=e=>{t(2,e)};try{e(n,r)}catch(e){r(e)}}}const X="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,Z="10.11.0",Q=globalThis;function ee(){return te(Q),Q}function te(e){const t=e.__SENTRY__=e.__SENTRY__||{};return t.version=t.version||Z,t[Z]=t[Z]||{}}function ne(e,t,n=Q){const r=n.__SENTRY__=n.__SENTRY__||{},o=r[Z]=r[Z]||{};return o[e]||(o[e]=t())}const re=["debug","info","warn","error","log","assert","trace"],oe={};function ie(e){if(!("console"in Q))return e();const t=Q.console,n={},r=Object.keys(oe);r.forEach(e=>{const r=oe[e];n[e]=t[e],t[e]=r});try{return e()}finally{r.forEach(e=>{t[e]=n[e]})}}function ae(){return ce().enabled}function se(e,...t){X&&ae()&&ie(()=>{Q.console[e](`Sentry Logger [${e}]:`,...t)})}function ce(){return X?ne("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const ue={enable:function(){ce().enabled=!0},disable:function(){ce().enabled=!1},isEnabled:ae,log:function(...e){se("log",...e)},warn:function(...e){se("warn",...e)},error:function(...e){se("error",...e)}},le=/^o(\d+)\./,fe=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function de(e,t=!1){const{host:n,path:r,pass:o,port:i,projectId:a,protocol:s,publicKey:c}=e;return`${s}://${c}${t&&o?`:${o}`:""}@${n}${i?`:${i}`:""}/${r?`${r}/`:r}${a}`}function pe(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function he(e){const t=e.getOptions(),{host:n}=e.getDsn()||{};let r;return t.orgId?r=String(t.orgId):n&&(r=function(e){const t=e.match(le);return t?.[1]}(n)),r}function ve(e){const t="string"==typeof e?function(e){const t=fe.exec(e);if(!t)return void ie(()=>{console.error(`Invalid Sentry Dsn: ${e}`)});const[n,r,o="",i="",a="",s=""]=t.slice(1);let c="",u=s;const l=u.split("/");if(l.length>1&&(c=l.slice(0,-1).join("/"),u=l.pop()),u){const e=u.match(/^\d+/);e&&(u=e[0])}return pe({host:i,pass:o,path:c,projectId:u,port:a,protocol:n,publicKey:r})}(e):pe(e);if(t&&function(e){if(!X)return!0;const{port:t,projectId:n,protocol:r}=e;return!(["protocol","publicKey","host","projectId"].find(t=>!e[t]&&(ue.error(`Invalid Sentry Dsn: ${t} missing`),!0))||(n.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(r)?t&&isNaN(parseInt(t,10))&&(ue.error(`Invalid Sentry Dsn: Invalid port ${t}`),1):(ue.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),1):(ue.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(t))return t}const ye=Q;function be(e,t={}){if(!e)return"<unknown>";try{let n=e;const r=5,o=[];let i=0,a=0;const s=" > ",c=s.length;let u;const l=Array.isArray(t)?t:t.keyAttrs,f=!Array.isArray(t)&&t.maxStringLength||80;for(;n&&i++<r&&(u=me(n,l),!("html"===u||i>1&&a+o.length*c+u.length>=f));)o.push(u),a+=u.length,n=n.parentNode;return o.reverse().join(s)}catch{return"<unknown>"}}function me(e,t){const n=e,r=[];if(!n?.tagName)return"";if(ye.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const o=t?.length?t.filter(e=>n.getAttribute(e)).map(e=>[e,n.getAttribute(e)]):null;if(o?.length)o.forEach(e=>{r.push(`[${e[0]}="${e[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const e=n.className;if(e&&G(e)){const t=e.split(/\s+/);for(const e of t)r.push(`.${e}`)}}const i=["aria-label","type","name","title","alt"];for(const e of i){const t=n.getAttribute(e);t&&r.push(`[${e}="${t}"]`)}return r.join("")}function ge(){try{return ye.document.location.href}catch{return""}}function we(e,t=0){return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function _e(e,t){if(!Array.isArray(e))return"";const n=[];for(let t=0;t<e.length;t++){const r=e[t];try{W(r)?n.push("[VueViewModel]"):n.push(String(r))}catch{n.push("[value cannot be serialized]")}}return n.join(t)}function xe(e,t,n=!1){return!!G(e)&&(M(t,"RegExp")?t.test(e):!!G(t)&&(n?e===t:e.includes(t)))}function Se(e,t=[],n=!1){return t.some(t=>xe(e,t,n))}function Ee(e,t,n){if(!(t in e))return;const r=e[t];if("function"!=typeof r)return;const o=n(r);"function"==typeof o&&Oe(o,r);try{e[t]=o}catch{X&&ue.log(`Failed to replace method "${t}" in object`,e)}}function ke(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch{X&&ue.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function Oe(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,ke(e,"__sentry_original__",t)}catch{}}function Ie(e){return e.__sentry_original__}function Pe(e){if(R(e))return{message:e.message,name:e.name,stack:e.stack,...Ce(e)};if(H(e)){const t={type:e.type,target:Te(e.target),currentTarget:Te(e.currentTarget),...Ce(e)};return"undefined"!=typeof CustomEvent&&z(e,CustomEvent)&&(t.detail=e.detail),t}return e}function Te(e){try{return t=e,"undefined"!=typeof Element&&z(t,Element)?be(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}var t}function Ce(e){if("object"==typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}const je="?",Ne=/\(error: (.*)\)/,De=/captureMessage|captureException/;function Le(...e){const t=e.sort((e,t)=>e[0]-t[0]).map(e=>e[1]);return(e,n=0,r=0)=>{const o=[],i=e.split("\n");for(let e=n;e<i.length;e++){let n=i[e];n.length>1024&&(n=n.slice(0,1024));const a=Ne.test(n)?n.replace(Ne,"$1"):n;if(!a.match(/\S*Error: /)){for(const e of t){const t=e(a);if(t){o.push(t);break}}if(o.length>=50+r)break}}return function(e){if(!e.length)return[];const t=Array.from(e);/sentryWrapped/.test(Ae(t).function||"")&&t.pop();t.reverse(),De.test(Ae(t).function||"")&&(t.pop(),De.test(Ae(t).function||"")&&t.pop());return t.slice(0,50).map(e=>({...e,filename:e.filename||Ae(t).filename,function:e.function||je}))}(o.slice(r))}}function Ae(e){return e[e.length-1]||{}}const Re="<anonymous>";function Me(e){try{return e&&"function"==typeof e&&e.name||Re}catch{return Re}}function $e(e){const t=e.exception;if(t){const e=[];try{return t.values.forEach(t=>{t.stacktrace.frames&&e.push(...t.stacktrace.frames)}),e}catch{return}}}function Ue(e,t=100,n=1/0){try{return Fe("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function Ge(e,t=3,n=102400){const r=Ue(e,t);return o=r,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(o))>n?Ge(e,t-1,n):r;var o}function Fe(e,t,n=1/0,r=1/0,o=function(){const e=new WeakSet;function t(t){return!!e.has(t)||(e.add(t),!1)}function n(t){e.delete(t)}return[t,n]}()){const[i,a]=o;if(null==t||["boolean","string"].includes(typeof t)||"number"==typeof t&&Number.isFinite(t))return t;const s=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!=typeof global&&t===global)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if(W(t))return"[VueViewModel]";if(B(n=t)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n)return"[SyntheticEvent]";if("number"==typeof t&&!Number.isFinite(t))return`[${t}]`;if("function"==typeof t)return`[Function: ${Me(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;const r=function(e){const t=Object.getPrototypeOf(e);return t?.constructor?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(e){return`**non-serializable** (${e})`}var n}(e,t);if(!s.startsWith("[object "))return s;if(t.__sentry_skip_normalization__)return t;const c="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:n;if(0===c)return s.replace("object ","");if(i(t))return"[Circular ~]";const u=t;if(u&&"function"==typeof u.toJSON)try{return Fe("",u.toJSON(),c-1,r,o)}catch{}const l=Array.isArray(t)?[]:{};let f=0;const d=Pe(t);for(const e in d){if(!Object.prototype.hasOwnProperty.call(d,e))continue;if(f>=r){l[e]="[MaxProperties ~]";break}const t=d[e];l[e]=Fe(e,t,c-1,r,o),f++}return a(t),l}function Ve(e,t=[]){return[e,t]}function Be(e,t){const[n,r]=e;return[n,[...r,t]]}function He(e,t){const n=e[1];for(const e of n){if(t(e,e[0].type))return!0}return!1}function qe(e){const t=te(Q);return t.encodePolyfill?t.encodePolyfill(e):(new TextEncoder).encode(e)}function ze(e){const[t,n]=e;let r=JSON.stringify(t);function o(e){"string"==typeof r?r="string"==typeof e?r+e:[qe(r),e]:r.push("string"==typeof e?qe(e):e)}for(const e of n){const[t,n]=e;if(o(`\n${JSON.stringify(t)}\n`),"string"==typeof n||n instanceof Uint8Array)o(n);else{let e;try{e=JSON.stringify(n)}catch{e=JSON.stringify(Ue(n))}o(e)}}return"string"==typeof r?r:function(e){const t=e.reduce((e,t)=>e+t.length,0),n=new Uint8Array(t);let r=0;for(const t of e)n.set(t,r),r+=t.length;return n}(r)}function We(e){const t="string"==typeof e.data?qe(e.data):e.data;return[{type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType},t]}const Ye={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item"};function Je(e){return Ye[e]}function Ke(e){if(!e?.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}const Xe=Symbol.for("SentryBufferFullError");function Ze(e){const t=[];function n(e){return t.splice(t.indexOf(e),1)[0]||Promise.resolve(void 0)}return{$:t,add:function(r){if(!(void 0===e||t.length<e))return J(Xe);const o=r();return-1===t.indexOf(o)&&t.push(o),o.then(()=>n(o)).then(null,()=>n(o).then(null,()=>{})),o},drain:function(e){return new K((n,r)=>{let o=t.length;if(!o)return n(!0);const i=setTimeout(()=>{e&&e>0&&n(!1)},e);t.forEach(e=>{Y(e).then(()=>{--o||(clearTimeout(i),n(!0))},r)})})}}}function Qe(e,{statusCode:t,headers:n},r=Date.now()){const o={...e},i=n?.["x-sentry-rate-limits"],a=n?.["retry-after"];if(i)for(const e of i.trim().split(",")){const[t,n,,,i]=e.split(":",5),a=parseInt(t,10),s=1e3*(isNaN(a)?60:a);if(n)for(const e of n.split(";"))"metric_bucket"===e&&i&&!i.split(";").includes("custom")||(o[e]=r+s);else o.all=r+s}else a?o.all=r+function(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const r=Date.parse(`${e}`);return isNaN(r)?6e4:r-t}(a,r):429===t&&(o.all=r+6e4);return o}function et(e,t,n=Ze(e.bufferSize||64)){let r={};return{send:function(o){const i=[];if(He(o,(t,n)=>{const o=Je(n);!function(e,t,n=Date.now()){return function(e,t){return e[t]||e.all||0}(e,t)>n}(r,o)?i.push(t):e.recordDroppedEvent("ratelimit_backoff",o)}),0===i.length)return Y({});const a=Ve(o[0],i),s=t=>{He(a,(n,r)=>{e.recordDroppedEvent(t,Je(r))})};return n.add(()=>t({body:ze(a)}).then(e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&X&&ue.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),r=Qe(r,e),e),e=>{throw s("network_error"),X&&ue.error("Encountered error running transport request:",e),e})).then(e=>e,e=>{if(e===Xe)return X&&ue.error("Skipped sending event because buffer is full."),s("queue_overflow"),Y({});throw e})},flush:e=>n.drain(e)}}const tt=Q;function nt(){if(!("fetch"in tt))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function rt(e){return e&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}const ot="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,it=Q,at={};function st(e){const t=at[e];if(t)return t;let n=it[e];if(rt(n))return at[e]=n.bind(it);const r=it.document;if(r&&"function"==typeof r.createElement)try{const t=r.createElement("iframe");t.hidden=!0,r.head.appendChild(t);const o=t.contentWindow;o?.[e]&&(n=o[e]),r.head.removeChild(t)}catch(t){ot&&ue.warn(`Could not create sandbox iframe for ${e} check, bailing to window.${e}: `,t)}return n?at[e]=n.bind(it):n}function ct(e){at[e]=void 0}const ut=[];function lt(e,t){for(const n of t)n?.afterAllSetup&&n.afterAllSetup(e)}function ft(e,t,n){if(n[t.name])X&&ue.log(`Integration skipped because it was already installed: ${t.name}`);else{if(n[t.name]=t,-1===ut.indexOf(t.name)&&"function"==typeof t.setupOnce&&(t.setupOnce(),ut.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),"function"==typeof t.preprocessEvent){const n=t.preprocessEvent.bind(t);e.on("preprocessEvent",(t,r)=>n(t,r,e))}if("function"==typeof t.processEvent){const n=t.processEvent.bind(t),r=Object.assign((t,r)=>n(t,r,e),{id:t.name});e.addEventProcessor(r)}X&&ue.log(`Integration installed: ${t.name}`)}}function dt(e){const t=[];e.message&&t.push(e.message);try{const n=e.exception.values[e.exception.values.length-1];n?.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`))}catch{}return t}function pt(e=function(){const e=Q;return e.crypto||e.msCrypto}()){let t=()=>16*Math.random();try{if(e?.randomUUID)return e.randomUUID().replace(/-/g,"");e?.getRandomValues&&(t=()=>{const t=new Uint8Array(1);return e.getRandomValues(t),t[0]})}catch{}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,e=>(e^(15&t())>>e/4).toString(16))}function ht(e){return e.exception?.values?.[0]}function vt(e){const{message:t,event_id:n}=e;if(t)return t;const r=ht(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function yt(e,t,n){const r=e.exception=e.exception||{},o=r.values=r.values||[],i=o[0]=o[0]||{};i.value||(i.value=t||""),i.type||(i.type=n||"Error")}function bt(e,t){const n=ht(e);if(!n)return;const r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...t},t&&"data"in t){const e={...r?.data,...t.data};n.mechanism.data=e}}function mt(e){if(function(e){try{return e.__sentry_captured__}catch{}}(e))return!0;try{ke(e,"__sentry_captured__",!0)}catch{}return!1}const gt=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,'can\'t redefine non-configurable property "solana"',"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],wt=(e={})=>{let t;return{name:"EventFilters",setup(n){const r=n.getOptions();t=xt(e,r)},processEvent(n,r,o){if(!t){const n=o.getOptions();t=xt(e,n)}return function(e,t){if(e.type){if("transaction"===e.type&&function(e,t){if(!t?.length)return!1;const n=e.transaction;return!!n&&Se(n,t)}(e,t.ignoreTransactions))return X&&ue.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${vt(e)}`),!0}else{if(function(e,t){if(!t?.length)return!1;return dt(e).some(e=>Se(e,t))}(e,t.ignoreErrors))return X&&ue.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${vt(e)}`),!0;if(function(e){if(!e.exception?.values?.length)return!1;return!e.message&&!e.exception.values.some(e=>e.stacktrace||e.type&&"Error"!==e.type||e.value)}(e))return X&&ue.warn(`Event dropped due to not having an error message, error type or stacktrace.\nEvent: ${vt(e)}`),!0;if(function(e,t){if(!t?.length)return!1;const n=St(e);return!!n&&Se(n,t)}(e,t.denyUrls))return X&&ue.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${vt(e)}.\nUrl: ${St(e)}`),!0;if(!function(e,t){if(!t?.length)return!0;const n=St(e);return!n||Se(n,t)}(e,t.allowUrls))return X&&ue.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${vt(e)}.\nUrl: ${St(e)}`),!0}return!1}(n,t)?null:n}}},_t=(e={})=>({...wt(e),name:"InboundFilters"});function xt(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:gt],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]]}}function St(e){try{const t=[...e.exception?.values??[]].reverse().find(e=>void 0===e.mechanism?.parent_id&&e.stacktrace?.frames?.length),n=t?.stacktrace?.frames;return n?function(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(n):null}catch{return X&&ue.error(`Cannot extract url for event ${vt(e)}`),null}}function Et(){return Date.now()/1e3}let kt;function Ot(){return(kt??(kt=function(){const{performance:e}=Q;if(!e?.now||!e.timeOrigin)return Et;const t=e.timeOrigin;return()=>(t+e.now())/1e3}()))()}function It(e){const t=Ot(),n={sid:pt(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(e){return{sid:`${e.sid}`,init:e.init,started:new Date(1e3*e.started).toISOString(),timestamp:new Date(1e3*e.timestamp).toISOString(),status:e.status,errors:e.errors,did:"number"==typeof e.did||"string"==typeof e.did?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}}}(n)};return e&&Pt(n,e),n}function Pt(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||Ot(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:pt()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}function Tt(e,t,n=2){if(!t||"object"!=typeof t||n<=0)return t;if(e&&0===Object.keys(t).length)return e;const r={...e};for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=Tt(r[e],t[e],n-1));return r}function Ct(){return pt()}function jt(){return pt().substring(16)}const Nt="_sentrySpan";function Dt(e,t){t?ke(e,Nt,t):delete e[Nt]}function Lt(e){return e[Nt]}class At{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Ct(),sampleRand:Math.random()}}clone(){const e=new At;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,Dt(e,Lt(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Pt(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t="function"==typeof e?e(this):e,n=t instanceof At?t.getScopeData():B(t)?e:void 0,{tags:r,extra:o,user:i,contexts:a,level:s,fingerprint:c=[],propagationContext:u}=n||{};return this._tags={...this._tags,...r},this._extra={...this._extra,...o},this._contexts={...this._contexts,...a},i&&Object.keys(i).length&&(this._user=i),s&&(this._level=s),c.length&&(this._fingerprint=c),u&&(this._propagationContext=u),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,Dt(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Ct(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,t){const n="number"==typeof t?t:100;if(n<=0)return this;const r={timestamp:Et(),...e,message:e.message?we(e.message,2048):e.message};return this._breadcrumbs.push(r),this._breadcrumbs.length>n&&(this._breadcrumbs=this._breadcrumbs.slice(-n),this._client?.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Lt(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=Tt(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,t){const n=t?.event_id||pt();if(!this._client)return X&&ue.warn("No client configured on scope - will not capture exception!"),n;const r=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:r,...t,event_id:n},this),n}captureMessage(e,t,n){const r=n?.event_id||pt();if(!this._client)return X&&ue.warn("No client configured on scope - will not capture message!"),r;const o=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:o,...n,event_id:r},this),r}captureEvent(e,t){const n=t?.event_id||pt();return this._client?(this._client.captureEvent(e,{...t,event_id:n},this),n):(X&&ue.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}class Rt{constructor(e,t){let n,r;n=e||new At,r=t||new At,this._stack=[{scope:n}],this._isolationScope=r}withScope(e){const t=this._pushScope();let n;try{n=e(t)}catch(e){throw this._popScope(),e}return q(n)?n.then(e=>(this._popScope(),e),e=>{throw this._popScope(),e}):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function Mt(){const e=te(ee());return e.stack=e.stack||new Rt(ne("defaultCurrentScope",()=>new At),ne("defaultIsolationScope",()=>new At))}function $t(e){return Mt().withScope(e)}function Ut(e,t){const n=Mt();return n.withScope(()=>(n.getStackTop().scope=e,t(e)))}function Gt(e){return Mt().withScope(()=>e(Mt().getIsolationScope()))}function Ft(e){const t=te(e);return t.acs?t.acs:{withIsolationScope:Gt,withScope:$t,withSetScope:Ut,withSetIsolationScope:(e,t)=>Gt(t),getCurrentScope:()=>Mt().getScope(),getIsolationScope:()=>Mt().getIsolationScope()}}function Vt(){return Ft(ee()).getCurrentScope()}function Bt(){return Ft(ee()).getIsolationScope()}function Ht(){return Vt().getClient()}function qt(e){const t=e.getPropagationContext(),{traceId:n,parentSpanId:r,propagationSpanId:o}=t,i={trace_id:n,span_id:o||jt()};return r&&(i.parent_span_id=r),i}let zt;const Wt=new WeakMap,Yt=()=>({name:"FunctionToString",setupOnce(){zt=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=Ie(this),n=Wt.has(Ht())&&void 0!==t?t:this;return zt.apply(n,e)}}catch{}},setup(e){Wt.set(e,!0)}}),Jt=()=>{let e;return{name:"Dedupe",processEvent(t){if(t.type)return t;try{if(function(e,t){if(!t)return!1;if(function(e,t){const n=e.message,r=t.message;if(!n&&!r)return!1;if(n&&!r||!n&&r)return!1;if(n!==r)return!1;if(!Xt(e,t))return!1;if(!Kt(e,t))return!1;return!0}(e,t))return!0;if(function(e,t){const n=Zt(t),r=Zt(e);if(!n||!r)return!1;if(n.type!==r.type||n.value!==r.value)return!1;if(!Xt(e,t))return!1;if(!Kt(e,t))return!1;return!0}(e,t))return!0;return!1}(t,e))return X&&ue.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return e=t}}};function Kt(e,t){let n=$e(e),r=$e(t);if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++){const t=r[e],o=n[e];if(t.filename!==o.filename||t.lineno!==o.lineno||t.colno!==o.colno||t.function!==o.function)return!1}return!0}function Xt(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return!(n.join("")!==r.join(""))}catch{return!1}}function Zt(e){return e.exception?.values?.[0]}const Qt={},en={};function tn(e,t){Qt[e]=Qt[e]||[],Qt[e].push(t)}function nn(e,t){if(!en[e]){en[e]=!0;try{t()}catch(t){X&&ue.error(`Error while instrumenting ${e}`,t)}}}function rn(e,t){const n=e&&Qt[e];if(n)for(const r of n)try{r(t)}catch(t){X&&ue.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${Me(r)}\nError:`,t)}}function on(){"console"in Q&&re.forEach(function(e){e in Q.console&&Ee(Q.console,e,function(t){return oe[e]=t,function(...t){rn("console",{args:t,level:e});const n=oe[e];n?.apply(Q.console,t)}})})}function an(e,t=!1){t&&!function(){if("string"==typeof EdgeRuntime)return!0;if(!nt())return!1;if(rt(tt.fetch))return!0;let e=!1;const t=tt.document;if(t&&"function"==typeof t.createElement)try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow?.fetch&&(e=rt(n.contentWindow.fetch)),t.head.removeChild(n)}catch(e){X&&ue.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return e}()||Ee(Q,"fetch",function(t){return function(...n){const r=new Error,{method:o,url:i}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){const[t,n]=e;return{url:cn(t),method:sn(n,"method")?String(n.method).toUpperCase():"GET"}}const t=e[0];return{url:cn(t),method:sn(t,"method")?String(t.method).toUpperCase():"GET"}}(n),a={args:n,fetchData:{method:o,url:i},startTimestamp:1e3*Ot(),virtualError:r,headers:un(n)};return e||rn("fetch",{...a}),t.apply(Q,n).then(async t=>(e?e(t):rn("fetch",{...a,endTimestamp:1e3*Ot(),response:t}),t),e=>{if(rn("fetch",{...a,endTimestamp:1e3*Ot(),error:e}),R(e)&&void 0===e.stack&&(e.stack=r.stack,ke(e,"framesToPop",1)),e instanceof TypeError&&("Failed to fetch"===e.message||"Load failed"===e.message||"NetworkError when attempting to fetch resource."===e.message))try{const t=new URL(a.fetchData.url);e.message=`${e.message} (${t.host})`}catch{}throw e})}})}function sn(e,t){return!!e&&"object"==typeof e&&!!e[t]}function cn(e){return"string"==typeof e?e:e?sn(e,"url")?e.url:e.toString?e.toString():"":""}function un(e){const[t,n]=e;try{if("object"==typeof n&&null!==n&&"headers"in n&&n.headers)return new Headers(n.headers);if(r=t,"undefined"!=typeof Request&&z(r,Request))return new Headers(t.headers)}catch{}var r}const ln=100;function fn(e,t){const n=Ht(),r=Bt();if(!n)return;const{beforeBreadcrumb:o=null,maxBreadcrumbs:i=ln}=n.getOptions();if(i<=0)return;const a={timestamp:Et(),...e},s=o?ie(()=>o(a,t)):a;null!==s&&(n.emit&&n.emit("beforeAddBreadcrumb",s,t),r.addBreadcrumb(s,i))}function dn(e){return"warn"===e?"warning":["fatal","error","warning","log","info","debug"].includes(e)?e:"log"}function pn(e){return void 0===e?void 0:e>=400&&e<500?"warning":e>=500?"error":void 0}function hn(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:r,relative:t[5]+n+r}}let vn,yn,bn;function mn(){if(!it.document)return;const e=rn.bind(null,"dom"),t=gn(e,!0);it.document.addEventListener("click",t,!1),it.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(t=>{const n=it,r=n[t]?.prototype;r?.hasOwnProperty?.("addEventListener")&&(Ee(r,"addEventListener",function(t){return function(n,r,o){if("click"===n||"keypress"==n)try{const r=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},i=r[n]=r[n]||{refCount:0};if(!i.handler){const r=gn(e);i.handler=r,t.call(this,n,r,o)}i.refCount++}catch{}return t.call(this,n,r,o)}}),Ee(r,"removeEventListener",function(e){return function(t,n,r){if("click"===t||"keypress"==t)try{const n=this.__sentry_instrumentation_handlers__||{},o=n[t];o&&(o.refCount--,o.refCount<=0&&(e.call(this,t,o.handler,r),o.handler=void 0,delete n[t]),0===Object.keys(n).length&&delete this.__sentry_instrumentation_handlers__)}catch{}return e.call(this,t,n,r)}}))})}function gn(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const r=function(e){try{return e.target}catch{return null}}(n);if(function(e,t){return"keypress"===e&&(!t?.tagName||"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&!t.isContentEditable)}(n.type,r))return;ke(n,"_sentryCaptured",!0),r&&!r._sentryId&&ke(r,"_sentryId",pt());const o="keypress"===n.type?"input":n.type;if(!function(e){if(e.type!==yn)return!1;try{if(!e.target||e.target._sentryId!==bn)return!1}catch{}return!0}(n)){e({event:n,name:o,global:t}),yn=n.type,bn=r?r._sentryId:void 0}clearTimeout(vn),vn=it.setTimeout(()=>{bn=void 0,yn=void 0},1e3)}}const wn="__sentry_xhr_v3__";function _n(){if(!it.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;e.open=new Proxy(e.open,{apply(e,t,n){const r=new Error,o=1e3*Ot(),i=G(n[0])?n[0].toUpperCase():void 0,a=function(e){if(G(e))return e;try{return e.toString()}catch{}return}(n[1]);if(!i||!a)return e.apply(t,n);t[wn]={method:i,url:a,request_headers:{}},"POST"===i&&a.match(/sentry_key/)&&(t.__sentry_own_request__=!0);const s=()=>{const e=t[wn];if(e&&4===t.readyState){try{e.status_code=t.status}catch{}rn("xhr",{endTimestamp:1e3*Ot(),startTimestamp:o,xhr:t,virtualError:r})}};return"onreadystatechange"in t&&"function"==typeof t.onreadystatechange?t.onreadystatechange=new Proxy(t.onreadystatechange,{apply(e,t,n){return s(),e.apply(t,n)}}):t.addEventListener("readystatechange",s),t.setRequestHeader=new Proxy(t.setRequestHeader,{apply(e,t,n){const[r,o]=n,i=t[wn];return i&&G(r)&&G(o)&&(i.request_headers[r.toLowerCase()]=o),e.apply(t,n)}}),e.apply(t,n)}}),e.send=new Proxy(e.send,{apply(e,t,n){const r=t[wn];if(!r)return e.apply(t,n);void 0!==n[0]&&(r.body=n[0]);return rn("xhr",{startTimestamp:1e3*Ot(),xhr:t}),e.apply(t,n)}})}let xn;function Sn(e){const t="history";tn(t,e),nn(t,En)}function En(){function e(e){return function(...t){const n=t.length>2?t[2]:void 0;if(n){const r=xn,o=function(e){try{return new URL(e,it.location.origin).toString()}catch{return e}}(String(n));if(xn=o,r===o)return e.apply(this,t);rn("history",{from:r,to:o})}return e.apply(this,t)}}it.addEventListener("popstate",()=>{const e=it.location.href,t=xn;if(xn=e,t===e)return;rn("history",{from:t,to:e})}),"history"in tt&&tt.history&&(Ee(it.history,"pushState",e),Ee(it.history,"replaceState",e))}const kn="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,On="production";function In(e,t,n,r=0){return new K((o,i)=>{const a=e[r];if(null===t||"function"!=typeof a)o(t);else{const s=a({...t},n);X&&a.id&&null===s&&ue.log(`Event processor "${a.id}" dropped event`),q(s)?s.then(t=>In(e,t,n,r+1).then(o)).then(null,i):In(e,s,n,r+1).then(o).then(null,i)}})}const Pn="sentry.profile_id",Tn="sentry.exclusive_time",Cn=/^sentry-/;function jn(e){const t=function(e){if(!e||!G(e)&&!Array.isArray(e))return;if(Array.isArray(e))return e.reduce((e,t)=>{const n=Nn(t);return Object.entries(n).forEach(([t,n])=>{e[t]=n}),e},{});return Nn(e)}(e);if(!t)return;const n=Object.entries(t).reduce((e,[t,n])=>{if(t.match(Cn)){e[t.slice(7)]=n}return e},{});return Object.keys(n).length>0?n:void 0}function Nn(e){return e.split(",").map(e=>e.split("=").map(e=>{try{return decodeURIComponent(e.trim())}catch{return}})).reduce((e,[t,n])=>(t&&n&&(e[t]=n),e),{})}const Dn="_sentryScope",Ln="_sentryIsolationScope";function An(e){return{scope:e[Dn],isolationScope:e[Ln]}}let Rn=!1;function Mn(e){const{spanId:t,traceId:n,isRemote:r}=e.spanContext(),o=r?t:Fn(e).parent_span_id,i=An(e).scope;return{parent_span_id:o,span_id:r?i?.getPropagationContext().propagationSpanId||jt():t,trace_id:n}}function $n(e){return e&&e.length>0?e.map(({context:{spanId:e,traceId:t,traceFlags:n,...r},attributes:o})=>({span_id:e,trace_id:t,sampled:1===n,attributes:o,...r})):void 0}function Un(e){return"number"==typeof e?Gn(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?Gn(e.getTime()):Ot()}function Gn(e){return e>9999999999?e/1e3:e}function Fn(e){if(function(e){return"function"==typeof e.getSpanJSON}(e))return e.getSpanJSON();const{spanId:t,traceId:n}=e.spanContext();if(function(e){const t=e;return!!(t.attributes&&t.startTime&&t.name&&t.endTime&&t.status)}(e)){const{attributes:r,startTime:o,name:i,endTime:a,status:s,links:c}=e;return{span_id:t,trace_id:n,data:r,description:i,parent_span_id:"parentSpanId"in e?e.parentSpanId:"parentSpanContext"in e?e.parentSpanContext?.spanId:void 0,start_timestamp:Un(o),timestamp:Un(a)||void 0,status:Bn(s),op:r["sentry.op"],origin:r["sentry.origin"],links:$n(c)}}return{span_id:t,trace_id:n,start_timestamp:0,data:{}}}function Vn(e){const{traceFlags:t}=e.spanContext();return 1===t}function Bn(e){if(e&&0!==e.code)return 1===e.code?"ok":e.message||"unknown_error"}const Hn="_sentryRootSpan";function qn(e){return e[Hn]||e}function zn(){Rn||(ie(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")}),Rn=!0)}const Wn="_frozenDsc";function Yn(e,t){const n=t.getOptions(),{publicKey:r}=t.getDsn()||{},o={environment:n.environment||On,release:n.release,public_key:r,trace_id:e,org_id:he(t)};return t.emit("createDsc",o),o}function Jn(e){const t=Ht();if(!t)return{};const n=qn(e),r=Fn(n),o=r.data,i=n.spanContext().traceState,a=i?.get("sentry.sample_rate")??o["sentry.sample_rate"]??o["sentry.previous_trace_sample_rate"];function s(e){return"number"!=typeof a&&"string"!=typeof a||(e.sample_rate=`${a}`),e}const c=n[Wn];if(c)return s(c);const u=i?.get("sentry.dsc"),l=u&&jn(u);if(l)return s(l);const f=Yn(e.spanContext().traceId,t),d=o["sentry.source"],p=r.description;return"url"!==d&&p&&(f.transaction=p),function(e){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const t=e||Ht()?.getOptions();return!(!t||null==t.tracesSampleRate&&!t.tracesSampler)}()&&(f.sampled=String(Vn(n)),f.sample_rand=i?.get("sentry.sample_rand")??An(n).scope?.getPropagationContext().sampleRand.toString()),s(f),t.emit("createDsc",f,n),f}function Kn(e,t){const{fingerprint:n,span:r,breadcrumbs:o,sdkProcessingMetadata:i}=t;!function(e,t){const{extra:n,tags:r,user:o,contexts:i,level:a,transactionName:s}=t;Object.keys(n).length&&(e.extra={...n,...e.extra});Object.keys(r).length&&(e.tags={...r,...e.tags});Object.keys(o).length&&(e.user={...o,...e.user});Object.keys(i).length&&(e.contexts={...i,...e.contexts});a&&(e.level=a);s&&"transaction"!==e.type&&(e.transaction=s)}(e,t),r&&function(e,t){e.contexts={trace:Mn(t),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:Jn(t),...e.sdkProcessingMetadata};const n=qn(t),r=Fn(n).description;r&&!e.transaction&&"transaction"===e.type&&(e.transaction=r)}(e,r),function(e,t){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],t&&(e.fingerprint=e.fingerprint.concat(t));e.fingerprint.length||delete e.fingerprint}(e,n),function(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}(e,o),function(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}(e,i)}function Xn(e,t){const{extra:n,tags:r,user:o,contexts:i,level:a,sdkProcessingMetadata:s,breadcrumbs:c,fingerprint:u,eventProcessors:l,attachments:f,propagationContext:d,transactionName:p,span:h}=t;Zn(e,"extra",n),Zn(e,"tags",r),Zn(e,"user",o),Zn(e,"contexts",i),e.sdkProcessingMetadata=Tt(e.sdkProcessingMetadata,s,2),a&&(e.level=a),p&&(e.transactionName=p),h&&(e.span=h),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),u.length&&(e.fingerprint=[...e.fingerprint,...u]),l.length&&(e.eventProcessors=[...e.eventProcessors,...l]),f.length&&(e.attachments=[...e.attachments,...f]),e.propagationContext={...e.propagationContext,...d}}function Zn(e,t,n){e[t]=Tt(e[t],n,1)}let Qn,er,tr;function nr(e){const t=Q._sentryDebugIds;if(!t)return{};const n=Object.keys(t);return tr&&n.length===er||(er=n.length,tr=n.reduce((n,r)=>{Qn||(Qn={});const o=Qn[r];if(o)n[o[0]]=o[1];else{const o=e(r);for(let e=o.length-1;e>=0;e--){const i=o[e],a=i?.filename,s=t[r];if(a&&s){n[a]=s,Qn[r]=[a,s];break}}}return n},{})),tr}function rr(e,t,n,r,o,i){const{normalizeDepth:a=3,normalizeMaxBreadth:s=1e3}=e,c={...t,event_id:t.event_id||n.event_id||pt(),timestamp:t.timestamp||Et()},u=n.integrations||e.integrations.map(e=>e.name);!function(e,t){const{environment:n,release:r,dist:o,maxValueLength:i=250}=t;e.environment=e.environment||n||On,!e.release&&r&&(e.release=r);!e.dist&&o&&(e.dist=o);const a=e.request;a?.url&&(a.url=we(a.url,i))}(c,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(c,u),o&&o.emit("applyFrameMetadata",t),void 0===t.type&&function(e,t){const n=nr(t);e.exception?.values?.forEach(e=>{e.stacktrace?.frames?.forEach(e=>{e.filename&&(e.debug_id=n[e.filename])})})}(c,e.stackParser);const l=function(e,t){if(!t)return e;const n=e?e.clone():new At;return n.update(t),n}(r,n.captureContext);n.mechanism&&bt(c,n.mechanism);const f=o?o.getEventProcessors():[],d=ne("globalScope",()=>new At).getScopeData();if(i){Xn(d,i.getScopeData())}if(l){Xn(d,l.getScopeData())}const p=[...n.attachments||[],...d.attachments];p.length&&(n.attachments=p),Kn(c,d);return In([...f,...d.eventProcessors],c,n).then(e=>(e&&function(e){const t={};if(e.exception?.values?.forEach(e=>{e.stacktrace?.frames?.forEach(e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)})}),0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.entries(t).forEach(([e,t])=>{n.push({type:"sourcemap",code_file:e,debug_id:t})})}(e),"number"==typeof a&&a>0?function(e,t,n){if(!e)return null;const r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(e=>({...e,...e.data&&{data:Ue(e.data,t,n)}}))},...e.user&&{user:Ue(e.user,t,n)},...e.contexts&&{contexts:Ue(e.contexts,t,n)},...e.extra&&{extra:Ue(e.extra,t,n)}};e.contexts?.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=Ue(e.contexts.trace.data,t,n)));e.spans&&(r.spans=e.spans.map(e=>({...e,...e.data&&{data:Ue(e.data,t,n)}})));e.contexts?.flags&&r.contexts&&(r.contexts.flags=Ue(e.contexts.flags,3,n));return r}(e,a,s):e))}function or(e){if(e)return function(e){return e instanceof At||"function"==typeof e}(e)||function(e){return Object.keys(e).some(e=>ir.includes(e))}(e)?{captureContext:e}:e}const ir=["user","level","extra","contexts","tags","fingerprint","propagationContext"];function ar(e,t){return Vt().captureEvent(e,t)}function sr(e){const t=Bt(),n=Vt(),{userAgent:r}=Q.navigator||{},o=It({user:n.getUser()||t.getUser(),...r&&{userAgent:r},...e}),i=t.getSession();return"ok"===i?.status&&Pt(i,{status:"exited"}),cr(),t.setSession(o),o}function cr(){const e=Bt(),t=Vt().getSession()||e.getSession();t&&function(e,t){let n={};t?n={status:t}:"ok"===e.status&&(n={status:"exited"}),Pt(e,n)}(t),ur(),e.setSession()}function ur(){const e=Bt(),t=Ht(),n=e.getSession();n&&t&&t.captureSession(n)}function lr(e=!1){e?cr():ur()}const fr=Q;let dr=0;function pr(){return dr>0}function hr(e,t={}){if(!function(e){return"function"==typeof e}(e))return e;try{const t=e.__sentry_wrapped__;if(t)return"function"==typeof t?t:e;if(Ie(e))return e}catch{return e}const n=function(...n){try{const r=n.map(e=>hr(e,t));return e.apply(this,r)}catch(e){throw dr++,setTimeout(()=>{dr--}),function(...e){const t=Ft(ee());if(2===e.length){const[n,r]=e;return n?t.withSetScope(n,r):t.withScope(r)}t.withScope(e[0])}(r=>{var o,i;r.addEventProcessor(e=>(t.mechanism&&(yt(e,void 0,void 0),bt(e,t.mechanism)),e.extra={...e.extra,arguments:n},e)),o=e,Vt().captureException(o,or(i))}),e}};try{for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}catch{}Oe(n,e),ke(e,"__sentry_wrapped__",n);try{Object.getOwnPropertyDescriptor(n,"name").configurable&&Object.defineProperty(n,"name",{get(){return e.name}})}catch{}return n}const vr=1024,yr=(e={})=>{const t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:"Breadcrumbs",setup(e){var n;t.console&&function(e){const t="console";tn(t,e),nn(t,on)}(function(e){return function(t){if(Ht()!==e)return;const n={category:"console",data:{arguments:t.args,logger:"console"},level:dn(t.level),message:_e(t.args," ")};if("assert"===t.level){if(!1!==t.args[0])return;n.message=`Assertion failed: ${_e(t.args.slice(1)," ")||"console.assert"}`,n.data.arguments=t.args.slice(1)}fn(n,{input:t.args,level:t.level})}}(e)),t.dom&&(n=function(e,t){return function(n){if(Ht()!==e)return;let r,o,i="object"==typeof t?t.serializeAttribute:void 0,a="object"==typeof t&&"number"==typeof t.maxStringLength?t.maxStringLength:void 0;a&&a>vr&&(kn&&ue.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${a} was configured. Sentry will use 1024 instead.`),a=vr),"string"==typeof i&&(i=[i]);try{const e=n.event,t=function(e){return!!e&&!!e.target}(e)?e.target:e;r=be(t,{keyAttrs:i,maxStringLength:a}),o=function(e){if(!ye.HTMLElement)return null;let t=e;for(let e=0;e<5;e++){if(!t)return null;if(t instanceof HTMLElement){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}t=t.parentNode}return null}(t)}catch{r="<unknown>"}if(0===r.length)return;const s={category:`ui.${n.name}`,message:r};o&&(s.data={"ui.component_name":o}),fn(s,{event:n.event,name:n.name,global:n.global})}}(e,t.dom),tn("dom",n),nn("dom",mn)),t.xhr&&function(e){tn("xhr",e),nn("xhr",_n)}(function(e){return function(t){if(Ht()!==e)return;const{startTimestamp:n,endTimestamp:r}=t,o=t.xhr[wn];if(!n||!r||!o)return;const{method:i,url:a,status_code:s,body:c}=o,u={method:i,url:a,status_code:s},l={xhr:t.xhr,input:c,startTimestamp:n,endTimestamp:r},f={category:"xhr",data:u,type:"http",level:pn(s)};e.emit("beforeOutgoingRequestBreadcrumb",f,l),fn(f,l)}}(e)),t.fetch&&function(e,t){const n="fetch";tn(n,e),nn(n,()=>an(void 0,t))}(function(e){return function(t){if(Ht()!==e)return;const{startTimestamp:n,endTimestamp:r}=t;if(r&&(!t.fetchData.url.match(/sentry_key/)||"POST"!==t.fetchData.method))if(t.fetchData.method,t.fetchData.url,t.error){const o=t.fetchData,i={data:t.error,input:t.args,startTimestamp:n,endTimestamp:r},a={category:"fetch",data:o,level:"error",type:"http"};e.emit("beforeOutgoingRequestBreadcrumb",a,i),fn(a,i)}else{const o=t.response,i={...t.fetchData,status_code:o?.status};t.fetchData.request_body_size,t.fetchData.response_body_size;const a={input:t.args,response:o,startTimestamp:n,endTimestamp:r},s={category:"fetch",data:i,type:"http",level:pn(i.status_code)};e.emit("beforeOutgoingRequestBreadcrumb",s,a),fn(s,a)}}}(e)),t.history&&Sn(function(e){return function(t){if(Ht()!==e)return;let n=t.from,r=t.to;const o=hn(fr.location.href);let i=n?hn(n):void 0;const a=hn(r);i?.path||(i=o),o.protocol===a.protocol&&o.host===a.host&&(r=a.relative),o.protocol===i.protocol&&o.host===i.host&&(n=i.relative),fn({category:"navigation",data:{from:n,to:r}})}}(e)),t.sentry&&e.on("beforeSendEvent",function(e){return function(t){Ht()===e&&fn({category:"sentry."+("transaction"===t.type?"transaction":"event"),event_id:t.event_id,level:t.level,message:vt(t)},{event:t})}}(e))}}};const br=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],mr=(e={})=>{const t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,unregisterOriginalCallbacks:!1,...e};return{name:"BrowserApiErrors",setupOnce(){t.setTimeout&&Ee(fr,"setTimeout",gr),t.setInterval&&Ee(fr,"setInterval",gr),t.requestAnimationFrame&&Ee(fr,"requestAnimationFrame",wr),t.XMLHttpRequest&&"XMLHttpRequest"in fr&&Ee(XMLHttpRequest.prototype,"send",_r);const e=t.eventTarget;if(e){(Array.isArray(e)?e:br).forEach(e=>function(e,t){const n=fr,r=n[e]?.prototype;if(!r?.hasOwnProperty?.("addEventListener"))return;Ee(r,"addEventListener",function(n){return function(r,o,i){try{"function"==typeof o.handleEvent&&(o.handleEvent=hr(o.handleEvent,{mechanism:{data:{handler:Me(o),target:e},handled:!1,type:"auto.browser.browserapierrors.handleEvent"}}))}catch{}return t.unregisterOriginalCallbacks&&function(e,t,n){e&&"object"==typeof e&&"removeEventListener"in e&&"function"==typeof e.removeEventListener&&e.removeEventListener(t,n)}(this,r,o),n.apply(this,[r,hr(o,{mechanism:{data:{handler:Me(o),target:e},handled:!1,type:"auto.browser.browserapierrors.addEventListener"}}),i])}}),Ee(r,"removeEventListener",function(e){return function(t,n,r){try{const o=n.__sentry_wrapped__;o&&e.call(this,t,o,r)}catch{}return e.call(this,t,n,r)}})}(e,t))}}}};function gr(e){return function(...t){const n=t[0];return t[0]=hr(n,{mechanism:{handled:!1,type:`auto.browser.browserapierrors.${Me(e)}`}}),e.apply(this,t)}}function wr(e){return function(t){return e.apply(this,[hr(t,{mechanism:{data:{handler:Me(e)},handled:!1,type:"auto.browser.browserapierrors.requestAnimationFrame"}})])}}function _r(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(e=>{e in n&&"function"==typeof n[e]&&Ee(n,e,function(t){const n={mechanism:{data:{handler:Me(t)},handled:!1,type:`auto.browser.browserapierrors.xhr.${e}`}},r=Ie(t);return r&&(n.mechanism.data.handler=Me(r)),hr(t,n)})}),e.apply(this,t)}}const xr=()=>({name:"BrowserSession",setupOnce(){void 0!==fr.document?(sr({ignoreDuration:!0}),lr(),Sn(({from:e,to:t})=>{void 0!==e&&e!==t&&(sr({ignoreDuration:!0}),lr())})):kn&&ue.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.")}});let Sr=null;function Er(){Sr=Q.onerror,Q.onerror=function(e,t,n,r,o){return rn("error",{column:r,error:o,line:n,msg:e,url:t}),!!Sr&&Sr.apply(this,arguments)},Q.onerror.__SENTRY_INSTRUMENTED__=!0}let kr=null;function Or(){kr=Q.onunhandledrejection,Q.onunhandledrejection=function(e){return rn("unhandledrejection",e),!kr||kr.apply(this,arguments)},Q.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function Ir(e,t){const n=Cr(e,t),r={type:Dr(t),value:Lr(t)};return n.length&&(r.stacktrace={frames:n}),void 0===r.type&&""===r.value&&(r.value="Unrecoverable error caught"),r}function Pr(e,t,n,r){const o=Ht(),i=o?.getOptions().normalizeDepth,a=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(n instanceof Error)return n}return}(t),s={__serialized__:Ge(t,i)};if(a)return{exception:{values:[Ir(e,a)]},extra:s};const c={exception:{values:[{type:H(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:Mr(t,{isUnhandledRejection:r})}]},extra:s};if(n){const t=Cr(e,n);t.length&&(c.exception.values[0].stacktrace={frames:t})}return c}function Tr(e,t){return{exception:{values:[Ir(e,t)]}}}function Cr(e,t){const n=t.stacktrace||t.stack||"",r=function(e){if(e&&jr.test(e.message))return 1;return 0}(t),o=function(e){if("number"==typeof e.framesToPop)return e.framesToPop;return 0}(t);try{return e(n,r,o)}catch{}return[]}const jr=/Minified React error #\d+;/i;function Nr(e){return"undefined"!=typeof WebAssembly&&void 0!==WebAssembly.Exception&&e instanceof WebAssembly.Exception}function Dr(e){const t=e?.name;if(!t&&Nr(e)){return e.message&&Array.isArray(e.message)&&2==e.message.length?e.message[0]:"WebAssembly.Exception"}return t}function Lr(e){const t=e?.message;return Nr(e)?Array.isArray(e.message)&&2==e.message.length?e.message[1]:"wasm exception":t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function Ar(e,t,n,r,o){let i;if($(t)&&t.error){return Tr(e,t.error)}if(U(t)||M(t,"DOMException")){const o=t;if("stack"in t)i=Tr(e,t);else{const t=o.name||(U(o)?"DOMError":"DOMException"),a=o.message?`${t}: ${o.message}`:t;i=Rr(e,a,n,r),yt(i,a)}return"code"in o&&(i.tags={...i.tags,"DOMException.code":`${o.code}`}),i}if(R(t))return Tr(e,t);if(B(t)||H(t)){return i=Pr(e,t,n,o),bt(i,{synthetic:!0}),i}return i=Rr(e,t,n,r),yt(i,`${t}`,void 0),bt(i,{synthetic:!0}),i}function Rr(e,t,n,r){const o={};if(r&&n){const r=Cr(e,n);r.length&&(o.exception={values:[{value:t,stacktrace:{frames:r}}]}),bt(o,{synthetic:!0})}if(F(t)){const{__sentry_template_string__:e,__sentry_template_values__:n}=t;return o.logentry={message:e,params:n},o}return o.message=t,o}function Mr(e,{isUnhandledRejection:t}){const n=function(e,t=40){const n=Object.keys(Pe(e));n.sort();const r=n[0];if(!r)return"[object has no keys]";if(r.length>=t)return we(r,t);for(let e=n.length;e>0;e--){const r=n.slice(0,e).join(", ");if(!(r.length>t))return e===n.length?r:we(r,t)}return""}(e),r=t?"promise rejection":"exception";if($(e))return`Event \`ErrorEvent\` captured as ${r} with message \`${e.message}\``;if(H(e)){return`Event \`${function(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{}}(e)}\` (type=${e.type}) captured as ${r}`}return`Object captured as ${r} with keys: ${n}`}const $r=(e={})=>{const t={onerror:!0,onunhandledrejection:!0,...e};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(e){t.onerror&&(!function(e){!function(e){const t="error";tn(t,e),nn(t,Er)}(t=>{const{stackParser:n,attachStacktrace:r}=Gr();if(Ht()!==e||pr())return;const{msg:o,url:i,line:a,column:s,error:c}=t,u=function(e,t,n,r){const o=e.exception=e.exception||{},i=o.values=o.values||[],a=i[0]=i[0]||{},s=a.stacktrace=a.stacktrace||{},c=s.frames=s.frames||[],u=r,l=n,f=function(e){if(!G(e)||0===e.length)return;if(e.startsWith("data:")){const t=e.match(/^data:([^;]+)/);return`<data:${t?t[1]:"text/javascript"}${e.includes("base64,")?",base64":""}>`}return e.slice(0,1024)}(t)??ge();0===c.length&&c.push({colno:u,filename:f,function:je,in_app:!0,lineno:l});return e}(Ar(n,c||o,void 0,r,!1),i,a,s);u.level="error",ar(u,{originalException:c,mechanism:{handled:!1,type:"auto.browser.global_handlers.onerror"}})})}(e),Ur("onerror")),t.onunhandledrejection&&(!function(e){!function(e){const t="unhandledrejection";tn(t,e),nn(t,Or)}(t=>{const{stackParser:n,attachStacktrace:r}=Gr();if(Ht()!==e||pr())return;const o=function(e){if(V(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}(t),i=V(o)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(o)}`}]}}:Ar(n,o,void 0,r,!0);i.level="error",ar(i,{originalException:o,mechanism:{handled:!1,type:"auto.browser.global_handlers.onunhandledrejection"}})})}(e),Ur("onunhandledrejection"))}}};function Ur(e){kn&&ue.log(`Global Handler attached: ${e}`)}function Gr(){const e=Ht();return e?.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const Fr=()=>({name:"HttpContext",preprocessEvent(e){if(!fr.navigator&&!fr.location&&!fr.document)return;const t=function(){const e=ge(),{referrer:t}=fr.document||{},{userAgent:n}=fr.navigator||{};return{url:e,headers:{...t&&{Referer:t},...n&&{"User-Agent":n}}}}(),n={...t.headers,...e.request?.headers};e.request={...t,...e.request,headers:n}}});function Vr(e,t,n,r,o,i){if(!o.exception?.values||!i||!z(i.originalException,Error))return;const a=o.exception.values.length>0?o.exception.values[o.exception.values.length-1]:void 0;a&&(o.exception.values=Br(e,t,r,i.originalException,n,o.exception.values,a,0))}function Br(e,t,n,r,o,i,a,s){if(i.length>=n+1)return i;let c=[...i];if(z(r[o],Error)){Hr(a,s);const i=e(t,r[o]),u=c.length;qr(i,o,u,s),c=Br(e,t,n,r[o],o,[i,...c],i,u)}return Array.isArray(r.errors)&&r.errors.forEach((r,i)=>{if(z(r,Error)){Hr(a,s);const u=e(t,r),l=c.length;qr(u,`errors[${i}]`,l,s),c=Br(e,t,n,r,o,[u,...c],u,l)}}),c}function Hr(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,..."AggregateError"===e.type&&{is_exception_group:!0},exception_id:t}}function qr(e,t,n,r){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:r}}const zr=(e={})=>{const t=e.limit||5,n=e.key||"cause";return{name:"LinkedErrors",preprocessEvent(e,r,o){Vr(Ir,o.getOptions().stackParser,n,t,e,r)}}};function Wr(e){return[_t(),Yt(),mr(),yr(),$r(),zr(),Jt(),Fr(),xr()]}function Yr(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function Jr(e,t,n){return t||`${function(e){return`${Yr(e)}${e.projectId}/envelope/`}(e)}?${function(e,t){const n={sentry_version:"7"};return e.publicKey&&(n.sentry_key=e.publicKey),t&&(n.sentry_client=`${t.name}/${t.version}`),new URLSearchParams(n).toString()}(e,n)}`}function Kr(e,t,n,r){const o=Ke(n),i=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){if(!t)return e;const n=e.sdk||{};e.sdk={...n,name:n.name||t.name,version:n.version||t.version,integrations:[...e.sdk?.integrations||[],...t.integrations||[]],packages:[...e.sdk?.packages||[],...t.packages||[]],settings:e.sdk?.settings||t.settings?{...e.sdk?.settings,...t.settings}:void 0}}(e,n?.sdk);const a=function(e,t,n,r){const o=e.sdkProcessingMetadata?.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&r&&{dsn:de(r)},...o&&{trace:o}}}(e,o,r,t);delete e.sdkProcessingMetadata;return Ve(a,[[{type:i},e]])}function Xr(e,t){if(!t?.length||!e.description)return!1;for(const n of t){if(Qr(n)){if(xe(e.description,n))return!0;continue}if(!n.name&&!n.op)continue;const t=!n.name||xe(e.description,n.name),r=!n.op||e.op&&xe(e.op,n.op);if(t&&r)return!0}return!1}function Zr(e,t){const n=t.parent_span_id,r=t.span_id;if(n)for(const t of e)t.parent_span_id===r&&(t.parent_span_id=n)}function Qr(e){return"string"==typeof e||e instanceof RegExp}const eo="Not capturing exception because it's already been captured.",to="Discarded session because of missing or non-string release",no=Symbol.for("SentryInternalError"),ro=Symbol.for("SentryDoNotSendEventError");function oo(e){return{message:e,[no]:!0}}function io(e){return{message:e,[ro]:!0}}function ao(e){return!!e&&"object"==typeof e&&no in e}function so(e){return!!e&&"object"==typeof e&&ro in e}class co{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=ve(e.dsn):X&&ue.warn("No DSN provided, client will not send events."),this._dsn){const t=Jr(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}}captureException(e,t,n){const r=pt();if(mt(e))return X&&ue.log(eo),r;const o={event_id:r,...t};return this._process(this.eventFromException(e,o).then(e=>this._captureEvent(e,o,n))),o.event_id}captureMessage(e,t,n,r){const o={event_id:pt(),...n},i=F(e)?e:String(e),a=V(e)?this.eventFromMessage(i,t,o):this.eventFromException(e,o);return this._process(a.then(e=>this._captureEvent(e,o,r))),o.event_id}captureEvent(e,t,n){const r=pt();if(t?.originalException&&mt(t.originalException))return X&&ue.log(eo),r;const o={event_id:r,...t},i=e.sdkProcessingMetadata||{},a=i.capturedSpanScope,s=i.capturedSpanIsolationScope;return this._process(this._captureEvent(e,o,a||n,s)),o.event_id}captureSession(e){this.sendSession(e),Pt(e,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?(this.emit("flush"),this._isClientDoneProcessing(e).then(n=>t.flush(e).then(e=>n&&e))):Y(!0)}close(e){return this.flush(e).then(e=>(this.getOptions().enabled=!1,this.emit("close"),e))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const t=this._integrations[e.name];ft(this,e,this._integrations),t||lt(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=Kr(e,this._dsn,this._options._metadata,this._options.tunnel);for(const e of t.attachments||[])n=Be(n,We(e));const r=this.sendEnvelope(n);r&&r.then(t=>this.emit("afterSendEvent",e,t),null)}sendSession(e){const{release:t,environment:n=On}=this._options;if("aggregates"in e){const r=e.attrs||{};if(!r.release&&!t)return void(X&&ue.warn(to));r.release=r.release||t,r.environment=r.environment||n,e.attrs=r}else{if(!e.release&&!t)return void(X&&ue.warn(to));e.release=e.release||t,e.environment=e.environment||n}this.emit("beforeSendSession",e);const r=function(e,t,n,r){const o=Ke(n);return Ve({sent_at:(new Date).toISOString(),...o&&{sdk:o},...!!r&&t&&{dsn:de(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(r)}recordDroppedEvent(e,t,n=1){if(this._options.sendClientReports){const r=`${e}:${t}`;X&&ue.log(`Recording outcome: "${r}"${n>1?` (${n} times)`:""}`),this._outcomes[r]=(this._outcomes[r]||0)+n}}on(e,t){const n=this._hooks[e]=this._hooks[e]||[];return n.push(t),()=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)}}emit(e,...t){const n=this._hooks[e];n&&n.forEach(e=>e(...t))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,e=>(X&&ue.error("Error while sending envelope:",e),e)):(X&&ue.error("Transport disabled"),Y({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(e,t){const n={};return t.forEach(t=>{t&&ft(e,t,n)}),n}(this,e),lt(this,e)}_updateSessionFromEvent(e,t){let n="fatal"===t.level,r=!1;const o=t.exception?.values;if(o){r=!0;for(const e of o){const t=e.mechanism;if(!1===t?.handled){n=!0;break}}}const i="ok"===e.status;(i&&0===e.errors||i&&n)&&(Pt(e,{...n&&{status:"crashed"},errors:e.errors||Number(r||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new K(t=>{let n=0;const r=setInterval(()=>{0==this._numProcessing?(clearInterval(r),t(!0)):(n+=1,e&&n>=e&&(clearInterval(r),t(!1)))},1)})}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,n,r){const o=this.getOptions(),i=Object.keys(this._integrations);return!t.integrations&&i?.length&&(t.integrations=i),this.emit("preprocessEvent",e,t),e.type||r.setLastEventId(e.event_id||t.event_id),rr(o,e,t,n,this,r).then(e=>{if(null===e)return e;this.emit("postprocessEvent",e,t),e.contexts={trace:qt(n),...e.contexts};const r=function(e,t){const n=t.getPropagationContext();return n.dsc||Yn(n.traceId,e)}(this,n);return e.sdkProcessingMetadata={dynamicSamplingContext:r,...e.sdkProcessingMetadata},e})}_captureEvent(e,t={},n=Vt(),r=Bt()){return X&&uo(e)&&ue.log(`Captured error event \`${dt(e)[0]||"<unknown>"}\``),this._processEvent(e,t,n,r).then(e=>e.event_id,e=>{X&&(so(e)?ue.log(e.message):ao(e)?ue.warn(e.message):ue.warn(e))})}_processEvent(e,t,n,r){const o=this.getOptions(),{sampleRate:i}=o,a=lo(e),s=uo(e),c=e.type||"error",u=`before send for type \`${c}\``,l=void 0===i?void 0:function(e){if("boolean"==typeof e)return Number(e);const t="string"==typeof e?parseFloat(e):e;return"number"!=typeof t||isNaN(t)||t<0||t>1?void 0:t}(i);if(s&&"number"==typeof l&&Math.random()>l)return this.recordDroppedEvent("sample_rate","error"),J(io(`Discarding event because it's not included in the random sample (sampling rate = ${i})`));const f="replay_event"===c?"replay":c;return this._prepareEvent(e,t,n,r).then(e=>{if(null===e)throw this.recordDroppedEvent("event_processor",f),io("An event processor returned `null`, will not send event.");if(t.data&&!0===t.data.__sentry__)return e;const n=function(e,t,n,r){const{beforeSend:o,beforeSendTransaction:i,beforeSendSpan:a,ignoreSpans:s}=t;let c=n;if(uo(c)&&o)return o(c,r);if(lo(c)){if(a||s){const t=function(e){const{trace_id:t,parent_span_id:n,span_id:r,status:o,origin:i,data:a,op:s}=e.contexts?.trace??{};return{data:a??{},description:e.transaction,op:s,parent_span_id:n,span_id:r??"",start_timestamp:e.start_timestamp??0,status:o,timestamp:e.timestamp,trace_id:t??"",origin:i,profile_id:a?.[Pn],exclusive_time:a?.[Tn],measurements:e.measurements,is_segment:!0}}(c);if(s?.length&&Xr(t,s))return null;if(a){const e=a(t);e?c=Tt(n,{type:"transaction",timestamp:(u=e).timestamp,start_timestamp:u.start_timestamp,transaction:u.description,contexts:{trace:{trace_id:u.trace_id,span_id:u.span_id,parent_span_id:u.parent_span_id,op:u.op,status:u.status,origin:u.origin,data:{...u.data,...u.profile_id&&{[Pn]:u.profile_id},...u.exclusive_time&&{[Tn]:u.exclusive_time}}}},measurements:u.measurements}):zn()}if(c.spans){const t=[],n=c.spans;for(const e of n)if(s?.length&&Xr(e,s))Zr(n,e);else if(a){const n=a(e);n?t.push(n):(zn(),t.push(e))}else t.push(e);const r=c.spans.length-t.length;r&&e.recordDroppedEvent("before_send","span",r),c.spans=t}}if(i){if(c.spans){const e=c.spans.length;c.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:e}}return i(c,r)}}var u;return c}(this,o,e,t);return function(e,t){const n=`${t} must return \`null\` or a valid event.`;if(q(e))return e.then(e=>{if(!B(e)&&null!==e)throw oo(n);return e},e=>{throw oo(`${t} rejected with ${e}`)});if(!B(e)&&null!==e)throw oo(n);return e}(n,u)}).then(o=>{if(null===o){if(this.recordDroppedEvent("before_send",f),a){const t=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",t)}throw io(`${u} returned \`null\`, will not send event.`)}const i=n.getSession()||r.getSession();if(s&&i&&this._updateSessionFromEvent(i,o),a){const e=(o.sdkProcessingMetadata?.spanCountBeforeProcessing||0)-(o.spans?o.spans.length:0);e>0&&this.recordDroppedEvent("before_send","span",e)}const c=o.transaction_info;if(a&&c&&o.transaction!==e.transaction){const e="custom";o.transaction_info={...c,source:e}}return this.sendEvent(o,t),o}).then(null,e=>{if(so(e)||ao(e))throw e;throw this.captureException(e,{mechanism:{handled:!1,type:"internal"},data:{__sentry__:!0},originalException:e}),oo(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)})}_process(e){this._numProcessing++,e.then(e=>(this._numProcessing--,e),e=>(this._numProcessing--,e))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([e,t])=>{const[n,r]=e.split(":");return{reason:n,category:r,quantity:t}})}_flushOutcomes(){X&&ue.log("Flushing outcomes...");const e=this._clearOutcomes();if(0===e.length)return void(X&&ue.log("No outcomes to send"));if(!this._dsn)return void(X&&ue.log("No dsn provided, will not send outcomes"));X&&ue.log("Sending outcomes:",e);const t=(n=e,Ve((r=this._options.tunnel&&de(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:o||Et(),discarded_events:n}]]));var n,r,o;this.sendEnvelope(t)}}function uo(e){return void 0===e.type}function lo(e){return"transaction"===e.type}function fo(e,t){const n=t??po(e)??[];if(0===n.length)return;const r=e.getOptions(),o=function(e,t,n,r){const o={};return t?.sdk&&(o.sdk={name:t.sdk.name,version:t.sdk.version}),n&&r&&(o.dsn=de(r)),Ve(o,[(i=e,[{type:"log",item_count:i.length,content_type:"application/vnd.sentry.items.log+json"},{items:i}])]);var i}(n,r._metadata,r.tunnel,e.getDsn());ho().set(e,[]),e.emit("flushLogs"),e.sendEnvelope(o)}function po(e){return ho().get(e)}function ho(){return ne("clientToLogBufferMap",()=>new WeakMap)}function vo(e){"aggregates"in e?void 0===e.attrs?.ip_address&&(e.attrs={...e.attrs,ip_address:"{{auto}}"}):void 0===e.ipAddress&&(e.ipAddress="{{auto}}")}class yo extends co{constructor(e){const t=(n=e,{release:"string"==typeof __SENTRY_RELEASE__?__SENTRY_RELEASE__:fr.SENTRY_RELEASE?.id,sendClientReports:!0,parentSpanIsAlwaysRootSpan:!0,...n});var n;!function(e,t,n=[t],r="npm"){const o=e._metadata||{};o.sdk||(o.sdk={name:`sentry.javascript.${t}`,packages:n.map(e=>({name:`${r}:@sentry/${e}`,version:Z})),version:Z}),e._metadata=o}(t,"browser",["browser"],fr.SENTRY_SDK_SOURCE||"npm"),t._metadata?.sdk&&(t._metadata.sdk.settings={infer_ip:t.sendDefaultPii?"auto":"never",...t._metadata.sdk.settings}),super(t);const{sendDefaultPii:r,sendClientReports:o,enableLogs:i}=this._options;fr.document&&(o||i)&&fr.document.addEventListener("visibilitychange",()=>{"hidden"===fr.document.visibilityState&&(o&&this._flushOutcomes(),i&&fo(this))}),i&&(this.on("flush",()=>{fo(this)}),this.on("afterCaptureLog",()=>{this._logFlushIdleTimeout&&clearTimeout(this._logFlushIdleTimeout),this._logFlushIdleTimeout=setTimeout(()=>{fo(this)},5e3)})),r&&this.on("beforeSendSession",vo)}eventFromException(e,t){return function(e,t,n,r){const o=Ar(e,t,n?.syntheticException||void 0,r);return bt(o),o.level="error",n?.event_id&&(o.event_id=n.event_id),Y(o)}(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return function(e,t,n="info",r,o){const i=Rr(e,t,r?.syntheticException||void 0,o);return i.level=n,r?.event_id&&(i.event_id=r.event_id),Y(i)}(this._options.stackParser,e,t,n,this._options.attachStacktrace)}_prepareEvent(e,t,n,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n,r)}}function bo(e,t,n,r){const o={filename:e,function:"<anonymous>"===t?je:t,in_app:!0};return void 0!==n&&(o.lineno=n),void 0!==r&&(o.colno=r),o}const mo=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,go=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,wo=/\((\S*)(?::(\d+))(?::(\d+))\)/,_o=/at (.+?) ?\(data:(.+?),/,xo=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,So=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Eo=Le(...[[30,e=>{const t=e.match(_o);if(t)return{filename:`<data:${t[2]}>`,function:t[1]};const n=mo.exec(e);if(n){const[,e,t,r]=n;return bo(e,je,+t,+r)}const r=go.exec(e);if(r){if(r[2]&&0===r[2].indexOf("eval")){const e=wo.exec(r[2]);e&&(r[2]=e[1],r[3]=e[2],r[4]=e[3])}const[e,t]=ko(r[1]||je,r[2]);return bo(t,e,r[3]?+r[3]:void 0,r[4]?+r[4]:void 0)}}],[50,e=>{const t=xo.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const e=So.exec(t[3]);e&&(t[1]=t[1]||"eval",t[3]=e[1],t[4]=e[2],t[5]="")}let e=t[3],n=t[1]||je;return[n,e]=ko(n,e),bo(e,n,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}]]),ko=(e,t)=>{const n=-1!==e.indexOf("safari-extension"),r=-1!==e.indexOf("safari-web-extension");return n||r?[-1!==e.indexOf("@")?e.split("@")[0]:je,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]};var Oo=n(430),Io=function(e,t){Object.keys(e).forEach(function(n){t(n,e[n])})},Po=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},To=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Co=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},jo=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},No={},Do={},Lo=function(e,t,n,r,o){var i,a;void 0===r&&(r=[]),void 0===o&&(o=[]);var s=n.join("${}"),c=null===(a=null===(i=No.contexts)||void 0===i?void 0:i[e])||void 0===a?void 0:a[s];if(c){var u=c.key,l=c.value,f=Do[u]||(Do[u]=function(e){var t=[];return e.replace(/\$\{[^}]+}/g,function(e){return t.push(e.substring(2,e.length-1).trim()),""}),t}(u)),d=t(l);if(d)return d.replace(/\$\{[^}]+}/g,function(e){var t=f.indexOf(e.substring(2,e.length-1).trim());return void 0!==r[t]?r[t]:""})}return t&&t(jo([void 0],Co(o),!1))||n.reduce(function(e,t,n){return e+t+(void 0!==r[n]?r[n]:"")},"")},Ao=function(e,t){Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:t})},Ro=void 0,Mo=function(){function e(e){Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:e})}return Object.defineProperty(e.prototype,"t",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Lo(this.context,function(e){return Co(e,1)[0]},e,t)}}),Object.defineProperty(e.prototype,"plural",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return Lo(this.context,function(t){return Ro?Ro(e,t):t[1===Math.abs(e)?0:1]},t.template,t.args,n)}}),e}(),$o=function(e){return new Mo(e)},Uo={},Go=/\splural ?=?([\s\S]*);?/,Fo=function(e,t){var n={};Io(t.contexts||{},function(e,t){var r={};Io(t,function(e,t){r[e.replace(/\$\{[^}]+}/g,"${}")]={key:e,value:t}}),n[e]=r}),No={headers:t.headers||{},contexts:n};var r,o=t.headers;Ro=(0,Oo.getPluralFunc)((null==o?void 0:o.language)||e)||(r=function(e){var t,n=(null==e?void 0:e["plural-forms"])||"nplurals=2; plural=(n != 1);",r=null===(t=Go.exec(n))||void 0===t?void 0:t[1];return r&&";"===r[r.length-1]&&(r=r.slice(0,-1)),r||"plural=(n != 1)"}(o),Uo[r]||(Uo[r]=new Function("n","args",function(e){return"return args[+ (".concat(e,")];")}(r))))},Vo=function(e){return Po(void 0,void 0,void 0,function(){var t,n;return To(this,function(r){switch(r.label){case 0:switch(e){case"es_419":case"es_AR":case"es_CL":case"es_DO":case"es_MX":e="es_LA"}return t=Fo,n=[e],[4,fetch("/locales/"+e+".json")];case 1:return[4,r.sent().json()];case 2:return t.apply(void 0,n.concat([r.sent()])),[2]}})})},Bo=function(){return navigator.language||navigator.userLanguage},Ho=function(e){return e||(e="en"),{be:"be_BY",ca:"ca_ES",cs:"cs_CZ",el:"el_GR",en:"en_US",hi:"hi_IN",ja:"ja_JP",ka:"ka_GE",ko:"ko_KR",nb:"nb_NO",nn:"nb_NO",no:"nb_NO",pt:"pt_BR",sl:"sl_SI",sv:"sv_SE",uk:"uk_UA",vi:"vi_VN"}[e]||e+"_"+e.toUpperCase()},qo=function(){var e=Bo();if("string"!=typeof e||!e)return"en_US";var t=e.replace("-","_");return-1!==t.indexOf("_")?t:Ho(t)},zo=function(e,t){return new Intl.NumberFormat(e||"".concat(Bo()||"en").split(/[_-]/)[0]||"en",t)},Wo=function(e){return Object.keys(e)},Yo=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Jo=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Ko=[],Xo=function(e,t){var n,r,o=void 0;(n={})[e]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.apply(void 0,Jo([],Yo(e),!1)),null==o||o()},r=n,Ko.push(r),o=function(){Ko.splice(Ko.indexOf(r),1)}};chrome.runtime.onMessage.addListener(function(e){return Ko.forEach(function(t){var n=e.type,r=n?t[n]:void 0;"function"!=typeof r?t.error&&e.error&&t.error(e.error):r(e.data)}),!1});var Zo=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Qo=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ei=n.g||window;ei.browser||(ei.browser=chrome);var ti,ni,ri,oi,ii,ai=function(e,t){return void 0===t&&(t=void 0),new Promise(function(n,r){return Zo(void 0,void 0,void 0,function(){var o,i,a,s;return Qo(this,function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),o=function(e){var t;if(e){var o=null==e?void 0:e.result,i=null==o?void 0:o.error;if(!i||i.Warning){var a=null===(t=null===browser||void 0===browser?void 0:browser.runtime)||void 0===t?void 0:t.lastError;a?r(a.message?new Error(a.message):a):n(o)}else r(i)}},i=function(){try{var n=Date.now()+":"+Math.random(),r=browser.runtime.sendMessage(browser.runtime.id,{type:e,data:t,respondTo:"broadcast",requestId:n},void 0,o);return Xo("answer:"+n,o),r}catch(n){return browser.runtime.sendMessage(browser.runtime.id,{type:e,data:t,respondTo:"promise"})}}(),i instanceof Promise?(a=o,[4,i]):[3,2];case 1:a.apply(void 0,[c.sent()]),c.label=2;case 2:return[3,4];case 3:return s=c.sent(),r(s),[3,4];case 4:return[2]}})})})},si=function(e,t){return void 0===t&&(t=void 0),ai(e,t)};!function(e){e.SIGN_OUT="signOut",e.SWITCH_ACCOUNT="switchAccount",e.DISCONNECT="disconnect",e.CONNECT="connect",e.CONNECTING="connecting"}(ti||(ti={})),function(e){e.BYPASS_LIST="bypassList"}(ni||(ni={})),function(e){e.PROXY="proxy"}(ri||(ri={})),function(e){e.FORK="fork",e.FORGET_ERROR="forgetError",e.LOG="log"}(oi||(oi={})),function(e){e.USER="user",e.PM_USER="pmUser",e.STATE="state"}(ii||(ii={}));var ci=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},ui=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},li=[],fi=!1,di=L.item("logs");di.get().then(function(e){(null==e?void 0:e.value)&&(li.push.apply(li,ui([],ci(e.value),!1)),di.setValue(li),fi=!0)}),n.g.getLogs=function(){return li.slice()};var pi=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(e())return li.unshift(ui([Date.now()],ci(t),!1)),li.splice(100,1e3),void(fi&&di.setValue(li));Gi(si(oi.LOG,ui([],ci(t),!1)))},hi=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},vi=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},yi=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(void 0===n.g.debugEnabled||n.g.debugEnabled)&&(console[e].apply(console,t),pi(vi([e],hi(t),!1)))}},bi=(yi("log"),yi("warn")),mi=yi("error"),gi=yi("info"),wi=yi("debug");function _i(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return e.bind.apply(e,vi([e,t],hi(n),!1))}var xi,Si=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function Ei(e,t){void 0===t&&(t=!1);var n=e.Error||e.message||e;if(n instanceof Error)return n.message;if("string"==typeof n)return n;bi(n);var r="".concat(e).replace(/^TypeError:\s+/,"");if(/\[object/.test(r)){bi(n);var o=Wo(n);return t&&0!==o.length&&"_id"!==o.join(",")?"<pre>"+(JSON.stringify(n,null,2).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/\//g,"&#47;")+"</pre>"):$o("Error").t(xi||(xi=Si(["Something went wrong. If the problem persists, please try to re-install the extension"],["Something went wrong. If the problem persists, please try to re-install the extension"])))}return r}var ki,Oi,Ii={fromSeconds:function(e,t){return(t||0)+1e3*e},fromMinutes:function(e,t){return e*this.fromSeconds(60,t)},fromHours:function(e,t){return e*this.fromMinutes(60,t)},fromDays:function(e,t){return e*this.fromHours(24,t)},toSeconds:function(e){return e/1e3},toMinutes:function(e){return this.toSeconds(e)/60},toHours:function(e){return this.toMinutes(e)/60},toDays:function(e){return this.toHours(e)/24},diffInMilliSeconds:function(e,t){return(t||Date.now())-(e||0)},diffInSeconds:function(e,t){return this.toSeconds(this.diffInMilliSeconds(e,t))},diffInMinutes:function(e,t){return this.toMinutes(this.diffInMilliSeconds(e,t))},diffInHours:function(e,t){return this.toHours(this.diffInMilliSeconds(e,t))},diffInDays:function(e,t){return this.toDays(this.diffInMilliSeconds(e,t))}},Pi=function(){return Pi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Pi.apply(this,arguments)},Ti=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Ci=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ji=L.item("crash-reports-disabled"),Ni=function(e){var t=e.toString();return t.includes("/envelope/")?{"content-type":"application/x-sentry-envelope"}:t.includes("/store/")?{"content-type":"application/json"}:{}},Di=function(e,t){return globalThis.fetch(e,Pi(Pi({},t),{headers:Pi(Pi(Pi({},null==t?void 0:t.headers),Ni(e)),{"x-pm-uid":""})}))},Li=function(e){return function(e,t=st("fetch")){let n=0,r=0;return et(e,function(o){const i=o.body.length;n+=i,r++;const a={body:o.body,method:"POST",referrerPolicy:"strict-origin",headers:e.headers,keepalive:n<=6e4&&r<15,...e.fetchOptions};if(!t)return ct("fetch"),J("No fetch implementation available");try{return t(e.url,a).then(e=>(n-=i,r--,{statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}}))}catch(e){return ct("fetch"),n-=i,r--,J(e)}})}(e,Di)},Ai={},Ri=function(e){if(e){switch("object"==typeof e&&"Code"in e?e.Code:void 0){case 86110:case 86111:case 86112:case 86113:case 86114:case 86115:case 86300:return}var t=Ei(e);if(!/Url already open/.test(t)){var n=Date.now();n-((null==Ai?void 0:Ai[t])||0)<Ii.fromMinutes(5)||(Ai[t]=n,$i().captureException(function(e,t){if(e instanceof Error)return e;var n=new Error(t);return n.previous=e,n}(e,t)))}}},Mi=void 0,$i=function(){if(Mi)return Mi;var e=[],t=Wr().filter(function(e){return!["BrowserApiErrors","TryCatch","Breadcrumbs","GlobalHandlers"].includes(e.name)}),n=new yo({dsn:h,release:s(),environment:/\.proton.me$/.test(d)?"prod":"test",normalizeDepth:5,transport:Li,stackParser:Eo,integrations:t,sendClientReports:!1,beforeSend:function(t){return Ti(this,void 0,void 0,function(){var n,r;return Ci(this,function(o){switch(o.label){case 0:return[4,Ti(void 0,void 0,void 0,function(){return Ci(this,function(e){switch(e.label){case 0:return[4,Ti(void 0,void 0,void 0,function(){var e;return Ci(this,function(t){switch(t.label){case 0:return[4,ji.getDefined({value:!1})];case 1:return(e=t.sent()).value=!e.value,[2,e]}})})];case 1:return[2,e.sent().value]}})})];case 1:return o.sent()?(n=Date.now(),r=n-6e5,(e=e.filter(function(e){return e>=r})).length>5?[2,null]:(e.push(n),[2,t])):[2,null]}})})}});return(Mi=new At).setClient(n),n.init(),Mi},Ui=function(e){try{return e()}catch(e){throw Ri(e),e}},Gi=function(e){"function"==typeof(null==e?void 0:e.then)&&e.then(function(){},Ri)},Fi=function(e){"function"==typeof(null==e?void 0:e.catch)&&e.catch(function(){})},Vi=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Bi=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Hi=L.item("session",j),qi=L.item("session"),zi=function(){return Vi(void 0,void 0,void 0,function(){var e,t;return Bi(this,function(n){switch(n.label){case 0:return[4,Hi.load()];case 1:return(e=n.sent())&&Wo(e).length?[2,e]:[4,qi.load()];case 2:return(t=n.sent())&&Gi(Hi.set(t)),[2,t]}})})},Wi=L.selfItem("credentials",j),Yi=function(){return Wi.remove()},Ji=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Ki=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Xi=function(e){return Ji(void 0,void 0,void 0,function(){var t,n,r;return Ki(this,function(o){switch(o.label){case 0:return[4,zi()];case 1:return t=null===(r=o.sent())||void 0===r?void 0:r.uid,n=(null==e?void 0:e.uid)||t,Gi(e.persistent?qi.set(e):qi.remove()),[4,Hi.set(e)];case 2:return o.sent(),n===t?[3,4]:[4,Yi()];case 3:o.sent(),o.label=4;case 4:return[2]}})})},Zi=function(e,t){void 0===t&&(t=!0),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"logout",{enumerable:!0,configurable:!0,writable:!0,value:t}),this.message||(this.message="Missing refresh token")},Qi=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},ea=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ta=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},na=!1,ra=[],oa=function(e){return Qi(void 0,void 0,void 0,function(){var t,n,r;return ea(this,function(o){switch(o.label){case 0:return e?[3,2]:[4,zi()];case 1:e=o.sent(),o.label=2;case 2:if(!e.uid||!e.refreshToken)throw new Zi;return na?[4,new Promise(function(e,t){ra.push([e,t])})]:[3,4];case 3:return[2,o.sent()];case 4:return o.trys.push([4,8,12,13]),na=!0,e.expiresAt=Date.now(),[4,Xi(e)];case 5:return o.sent(),[4,Va("auth/refresh",La("POST",{UID:e.uid,ResponseType:"token",GrantType:"refresh_token",RefreshToken:e.refreshToken,RedirectURI:e.redirectURI||"https://protonvpn.com"},{"x-pm-uid":e.uid}))];case 6:return t=o.sent(),delete e.expiresAt,e.refreshToken=t.RefreshToken,e.accessToken=t.AccessToken,[4,Xi(e)];case 7:return o.sent(),ra.forEach(function(t){(0,ta(t,1)[0])(e)}),ra=[],[2,e];case 8:return n=o.sent(),[4,zi()];case 9:return(r=o.sent()).expiresAt&&r.accessToken===e.accessToken?(delete r.expiresAt,[4,Xi(r)]):[3,11];case 10:o.sent(),o.label=11;case 11:if(10013===n.Code){bi(n,(new Error).stack),n=new Zi(Ei(n));try{Gi(si(ti.SIGN_OUT))}catch(e){}ra.forEach(function(e){(0,ta(e,2)[1])(n)}),ra=[]}throw n;case 12:return na=!1,[7];case 13:return[2]}})})},ia=function(e){for(var t=0,n=1,r=3;r>=0;r--)t+=n*Number(e[r]),n*=256;return t},aa=function(e,t){var n=t.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)\/(\d+)$/);if(!n)return!1;var r=e.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)(:\d+)?$/);return!!r&&function(e,t){var n=Math.pow(2,32-Number(t[5])),r=ia(t.slice(1,5)),o=ia(e.slice(1,5));return o>=r&&o<r+n}(r,n)},sa=function(e,t){void 0===t&&(t=void 0),ai(e,t).catch(function(e){-1==="".concat((null==e?void 0:e.message)||e).indexOf("Receiving end does not exist.")&&mi(e)})},ca=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},ua=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},la=void 0,fa=L.item("upgrade-error",t.LOCAL,"error"),da=function(e){la={version:a,time:Date.now(),error:e},Fi(e?fa.set(la):fa.remove())},pa=function(){return ca(void 0,void 0,void 0,function(){return ua(this,function(e){switch(e.label){case 0:return la?[3,2]:[4,fa.get()];case 1:(la=e.sent())||da(void 0),e.label=2;case 2:return la?la.version!==a||Date.now()-la.time>Ii.fromHours(2)?(da(void 0),[2,void 0]):[2,la.error]:[2,void 0]}})})},ha=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},va=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},ya=function(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];return t&&(e+=Math.round(t*(2*Math.random()-1))),setTimeout.apply(void 0,va([n,e],ha(r),!1))},ba=function(e,t){return void 0===t&&(t=0),new Promise(function(n){ya(e,t,n)})},ma=function(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var i=void 0,a=function(){i=ya(e,t,function(){n.apply(void 0,va([],ha(r),!1)),a()})};return a(),{clear:function(){clearTimeout(i)}}},ga=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},wa=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},_a=L.item("browser-type");!function(e){e.BRAVE="brave",e.VIVALDI="vivaldi",e.OCULUS="Oculus"}(Oi||(Oi={}));var xa,Sa,Ea=function(e,t){return t in(e||{})},ka=function(e){return"whenNavigator"in e},Oa=function(e){return"whenWindow"in e},Ia=((ki={})[Oi.OCULUS]={whenNavigator:function(e){return e.userAgent.includes("OculusBrowser")}},ki[Oi.BRAVE]={whenNavigator:function(e){return Ea(e,Oi.BRAVE)}},ki[Oi.VIVALDI]={whenWindow:function(e){return Ea(e,Oi.VIVALDI)}},ki),Pa=function(e){return Gi(_a.setValue(e)),e},Ta=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Ca=function(){return Ca=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ca.apply(this,arguments)},ja=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Na=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Da=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},La=function(e,t,n){return void 0===n&&(n={}),{method:e,headers:Ca({Accept:"application/json","Content-Type":"application/json"},n),body:JSON.stringify(t)}},Aa={},Ra=function(e,t,n,r,o){return ja(void 0,void 0,void 0,function(){var i,a,c,u,l,d,p,h,v,y,b,m,g,w,_,x;return Na(this,function(S){switch(S.label){case 0:if(i="".concat((null==t?void 0:t.method)||"GET"," ").concat(e),a=Aa[i]){if(a.time>=Date.now())return[2,a.response.clone()];delete Aa[i]}return(c=(null==t?void 0:t.headers)||{})["x-pm-uid"]?[3,5]:(l=r)?[3,2]:[4,zi()];case 1:l=S.sent(),S.label=2;case 2:return(u=l).expiresAt?[3,3]:(d=null==u?void 0:u.uid,p=null==u?void 0:u.accessToken,d&&p&&Object.assign(c,function(e,t){return{"x-pm-uid":e,Authorization:"Bearer ".concat(t)}}(d,p)),[3,5]);case 3:return!r&&(o||0)<Date.now()?[4,ba(200)]:[3,5];case 4:return S.sent(),[2,Ra(e,t,n,r,o||Ii.fromSeconds(8,Date.now()))];case 5:return v=[Ca({mode:"cors",credentials:"include",redirect:"follow",method:"GET"},t)],w={},_={"x-pm-appversion":s()},y="x-pm-browser-type",[4,ga(void 0,void 0,void 0,function(){var e,t,n;return wa(this,function(r){switch(r.label){case 0:if("object"==typeof navigator)for(t in Ia)if(n=Ia[t],ka(n)&&n.whenNavigator(navigator))return[2,Pa(t)];return[4,_a.get()];case 1:if(void 0!==(e=r.sent()))return[2,e.value];if("object"==typeof window)for(t in Ia)if(n=Ia[t],Oa(n)&&n.whenWindow(window))return[2,Pa(t)];return[2,""]}})})];case 6:return h=Ca.apply(void 0,v.concat([(w.headers=Ca.apply(void 0,[(_[y]=S.sent(),_),c]),w)])),[4,fetch("".concat(n||f).concat(e),h)];case 7:return b=S.sent(),as(b)&&(m="".concat(b.headers.get("Retry-After")||"0"),g=Math.min(Date.now()+Ii.fromMinutes(30),/^\d+$/.test(m)?Date.now()+Ii.fromSeconds(Math.max(10,Number(m))):new Date(m).getTime()),((null===(x=Aa[i])||void 0===x?void 0:x.time)||0)<g&&(Aa[i]={time:g,response:b.clone()})),[2,b]}})})},Ma=function(e){return ja(void 0,void 0,void 0,function(){var t;return Na(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,4]),[4,e.clone().json()];case 1:return[2,n.sent()];case 2:return t=n.sent(),[4,Ga(e)];case 3:throw n.sent(),bi(e.status,t),new Error($o("Error").t(Ba||(Ba=Ta(["Service temporarily unavailable"],["Service temporarily unavailable"]))));case 4:return[2]}})})},$a=function(e,t){return ja(void 0,void 0,void 0,function(){var n;return Na(this,function(r){switch(r.label){case 0:return[4,Ma(e)];case 1:return n=r.sent(),[2,t?t(e,n):n]}})})},Ua=function(e){var t=function(e){var t,n;try{for(var r=Da(g),o=r.next();!o.done;o=r.next()){var i=o.value;if(e.includes(i))return i}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return null}(e);return t?new Error($o("Info").t(Ha||(Ha=Ta(["VPN blocked by external software: ",".\n\nSome tools, like anti-viruses or proxies, can interfere with Proton VPN. You can try disabling it to confirm."],["VPN blocked by external software: ",".\\n\\nSome tools, like anti-viruses or proxies, can interfere with Proton VPN. You can try disabling it to confirm."])),t)):(Ri("HTML Content Received: "+e.replace(/<script[^>]*>[\s\S]*?<\/script[^>]*>/gi,"").replace(/<style[^>]*>[\s\S]*?<\/style[^>]*>/gi,"").replace(/src=["']data:[^"']+["']/gi,"")),new Error($o("Info").t(qa||(qa=Ta(["VPN blocked by external software.\n\nSome tools, like anti-viruses or proxies, can interfere with Proton VPN. Disable them and retry."],["VPN blocked by external software.\\n\\nSome tools, like anti-viruses or proxies, can interfere with Proton VPN. Disable them and retry."])))))},Ga=function(e){return ja(void 0,void 0,void 0,function(){var t;return Na(this,function(n){switch(n.label){case 0:return[4,e.text()];case 1:if(function(e){return/^\s*</.test(e)}(t=n.sent()))throw Ua(t);return[2,t]}})})},Fa=function(e){return ja(void 0,void 0,void 0,function(){return Na(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,4]),[4,e.clone().json()];case 1:case 3:return[2,t.sent()];case 2:return t.sent(),[4,Ga(e)];case 4:return[2]}})})},Va=function(e,t,n,r){return ja(void 0,void 0,void 0,function(){var o,i,a,s,c,u,l,f,d;return Na(this,function(p){switch(p.label){case 0:return[4,pa()];case 1:if(o=p.sent())throw sa("updateExtension",{error:o}),o;return[4,Ra(e,t,n)];case 2:return i=p.sent(),ts(i)?[3,9]:[4,Fa(i)];case 3:if(a=p.sent(),(s=(null==a?void 0:a.Error)?a:new Error(a)).response=i,s&&"object"==typeof s&&(s.httpStatus=i.status),is(a))throw sa("updateExtension",{error:s}),da(a),s;return da(void 0),/\/?auth(\/.*)$/.test(e)||!os(s)?[3,8]:[4,zi()];case 4:return c=p.sent(),u=c.uid,l=c.accessToken,[4,oa(c)];case 5:return!(f=p.sent()).uid||!f.accessToken||f.uid===u&&f.accessToken===l?[3,7]:[4,Ra(e,t,n,f)];case 6:if(d=p.sent(),ts(d))return[2,$a(d,r)];p.label=7;case 7:bi(s),p.label=8;case 8:throw s;case 9:return da(void 0),[2,$a(i,r)]}})})};!function(e){e.UPGRADE="Upgrade"}(xa||(xa={})),function(e){e.MAIN_ACTION="main_action",e.SECONDARY_ACTION="secondary_action",e.LINK="link"}(Sa||(Sa={}));var Ba,Ha,qa,za,Wa,Ya,Ja,Ka,Xa,Za,Qa,es,ts=function(e){return e.status>=200&&e.status<300},ns=function(e,t){return"object"==typeof e&&(null==e?void 0:e.httpStatus)===t},rs=function(e){return ns(e,401)},os=function(e){return rs(e)&&401===e.Code},is=function(e){return"object"==typeof e&&5003===(null==e?void 0:e.Code)},as=function(e){return"object"==typeof e&&(429===(null==e?void 0:e.Code)||503===(null==e?void 0:e.Code))},ss=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},cs=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},us=function(){return ss(void 0,void 0,void 0,function(){var e,t,n;return cs(this,function(r){switch(r.label){case 0:return[4,zi()];case 1:return(e=null===(t=r.sent())||void 0===t?void 0:t.accessToken)?[3,3]:[4,oa()];case 2:e=null===(n=r.sent())||void 0===n?void 0:n.accessToken,r.label=3;case 3:return[2,e]}})})},ls=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},fs=function(e,t){var n=chrome.action||chrome.browserAction;n&&(Gi(n.setIcon({path:browser.runtime.getURL("/img/"+e)})),"string"==typeof t&&Gi(n.setTitle({title:t})))},ds={loggedOut:function(){return $o("Label").t(za||(za=ls(["Unprotected"],["Unprotected"])))},off:function(){return $o("Label").t(Wa||(Wa=ls(["Unprotected"],["Unprotected"])))},on:function(){return $o("Label").t(Ya||(Ya=ls(["Protected"],["Protected"])))},error:function(){return $o("Error").t(Ja||(Ja=ls(["Network error."],["Network error."])))},warning:function(){return $o("Error").t(Ka||(Ka=ls(["Network error."],["Network error."])))},connecting:function(){return $o("Label").t(Xa||(Xa=ls(["Connecting"],["Connecting"])))}},ps=void 0,hs=function(e,t){ps&&clearTimeout(ps);var n=t||ds[e](),r=$o("Status").t(Za||(Za=ls(["Proton VPN: ",""],["Proton VPN: ",""])),n);fs("state-".concat({loggedOut:"not-logged-in",off:"unprotected-1",connecting:"unprotected-2",on:"protected"}[e]||e,".png"),r),"connecting"===e&&(ps=setTimeout(function(){fs("state-unprotected-1.png",r),ps=setTimeout(function(){hs(e,t)},700)},700))},vs=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},ys=function(e,t){var n,r;if(void 0===t&&(t=!1),function(e){return"object"==typeof e&&("NetworkError"===(null==e?void 0:e.name)||/^(NetworkError |(TypeError: )?Failed to fetch)/.test((null==e?void 0:e.message)||""))}(e)){bi(e);var o=bf();if(-1!==(null===(n=o.data.error)||void 0===n?void 0:n.Code)){hs("warning"),o.data.error={httpStatus:-1,Code:-1,Warning:!0,Error:$o("Error").t(Qa||(Qa=vs(["Network is unreachable"],["Network is unreachable"])))},null===(r=o.refreshState)||void 0===r||r.call(o);var i=o.data.server;sa("changeState",{state:i?"connected":"disconnected",server:i,error:o.data.error})}if(t)throw e}Ri(e)},bs="active";!function(e){e.FAILED="FAILED",e.ABORTED="ABORTED",e.TIMED_OUT="TIMED_OUT",e.BLOCKED_BY_CLIENT="BLOCKED_BY_CLIENT",e.NETWORK_CHANGED="NETWORK_CHANGED",e.NETWORK_IO_SUSPENDED="NETWORK_IO_SUSPENDED",e.TUNNEL_CONNECTION_FAILED="TUNNEL_CONNECTION_FAILED",e.PROXY_CONNECTION_FAILED="PROXY_CONNECTION_FAILED"}(es||(es={}));var ms,gs=function(e){return e.replace(/^net::/,"").replace(/^ERR_/,"")},ws=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},_s=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},xs=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ss=!1,Es=0,ks=void 0,Os=function(e){void 0===e&&(e=!1),ks||(ks=setTimeout(function(){return _s(void 0,void 0,void 0,function(){var t,n,r;return xs(this,function(o){switch(o.label){case 0:if(clearTimeout(ks),ks=void 0,Es=Date.now(),Ss)return[2];Ss=!0,o.label=1;case 1:return o.trys.push([1,4,5,6]),[4,Dc()];case 2:if(!o.sent())throw new Error($o("Error").t(ms||(ms=ws(["Unable to reach the server, please try to reconnect, or to log out and log in again if the problem persists"],["Unable to reach the server, please try to reconnect, or to log out and log in again if the problem persists"]))));return[4,null===(r=null===(n=bf())||void 0===n?void 0:n.connectCurrentServer)||void 0===r?void 0:r.call(n)];case 3:return o.sent(),[3,6];case 4:return t=o.sent(),e&&Jl(t),[3,6];case 5:return Ss=!1,[7];case 6:return[2]}})})},Math.max(1,Es+Ii.fromSeconds(20)-Date.now())))},Is={},Ps=function(e){if(ef()){var t=e.error;if(t)switch(gs(t)){case es.NETWORK_CHANGED:case es.NETWORK_IO_SUSPENDED:Os();break;case es.TUNNEL_CONNECTION_FAILED:case es.PROXY_CONNECTION_FAILED:Os(!0)}else Is[e.requestId]&&delete Is[e.requestId]}},Ts=function(e){var t=e.requestId;return!!Is[t]},Cs=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},js=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ns=_i(gi,"[authHandler]"),Ds=function(e,t){return Ui(function(){if(!t)throw new Error("asyncBlocking not supported");var n=setTimeout(function(){return Ui(function(){t({cancel:!0})})},Ii.fromSeconds(Math.min(20,_)));Gi(function(e){return Cs(void 0,void 0,void 0,function(){return js(this,function(t){return[2,(n=function(){return Cs(void 0,void 0,void 0,function(){var t;return js(this,function(n){switch(n.label){case 0:return e.isProxy?Ts(e)?[2,{cancel:!0}]:Fl(e.challenger.host)?(Ns("Auth required for ",e),[4,Dc()]):[3,2]:[3,2];case 1:return[2,(t=n.sent())&&Vl(t,e)||{cancel:!0}];case 2:return[2,{}]}})})},Ti(void 0,void 0,void 0,function(){var e;return Ci(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,n()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),Ri(e),e;case 3:return[2]}})}))];var n})})}(e).then(function(r){clearTimeout(n),t(r||(e.isProxy&&Fl(e.challenger.host)?{cancel:!0}:{}))}))})},Ls=function(){return Ui(function(){var e;(null===(e=bf())||void 0===e?void 0:e.proxyEnabled)&&Gi(Dc())})},As=function(){var e,t,n,r=browser.webRequest;r&&(null===(e=r.onBeforeRequest)||void 0===e||e.removeListener(Ls),null===(t=r.onCompleted)||void 0===t||t.removeListener(Ps),null===(n=r.onErrorOccurred)||void 0===n||n.removeListener(Ps))},Rs=function(){var e,t=browser.webRequest;t&&(!function(e){var t,n,r,o,i,a,s={urls:["<all_urls>"]};if(As(),null===(t=e.onBeforeRequest)||void 0===t||t.addListener(Ls,s),!(null===(n=e.onAuthRequired)||void 0===n?void 0:n.hasListener(Ds)))try{null===(r=e.onAuthRequired)||void 0===r||r.addListener(Ds,s,["asyncBlocking","extraHeaders"])}catch(t){null===(o=e.onAuthRequired)||void 0===o||o.addListener(Ds,s,["asyncBlocking"])}null===(i=e.onCompleted)||void 0===i||i.addListener(Ps,s),null===(a=e.onErrorOccurred)||void 0===a||a.addListener(Ps,s)}(t),Qi(void 0,void 0,void 0,function(){return ea(this,function(t){switch(t.label){case 0:return e?[3,2]:[4,zi()];case 1:e=t.sent(),t.label=2;case 2:return[2,Boolean(e.refreshToken)]}})}).then(function(e){e||As()}))},Ms=function(e){var t=function(e){if("string"!=typeof e)return{};try{var t=JSON.parse(atob(e.split(".")[1]||"")||"{}");return"object"!=typeof t||t instanceof Array?{}:t}catch(e){return{}}}(null==e?void 0:e.Username);return{expiration:t.exp||0,groups:(t.grp||"").split(",").filter(Boolean),sessionId:t.sid||null}},$s=L.selfItem("user",j),Us=function(e){var t;return"object"==typeof(null===(t=null==e?void 0:e.User)||void 0===t?void 0:t.VPN)},Gs=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Fs=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Vs=function(){return Gs(void 0,void 0,void 0,function(){var e;return Fs(this,function(t){switch(t.label){case 0:return[4,$s.load()];case 1:return e=t.sent(),Us(null==e?void 0:e.user)&&(e.user=e.user.User),[2,e]}})})};var Bs=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Hs=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},qs=function(e){return Bs(void 0,void 0,void 0,function(){var n;return Hs(this,function(r){switch(r.label){case 0:return[4,L.getItem("backoff-"+e,void 0,t.LOCAL)];case 1:return(n=r.sent())?Date.now()>n.forget?(function(e){Gi(L.removeItem("backoff-"+e,t.LOCAL))}(e),[2,!1]):[2,Date.now()<=n.expiration]:[2,!1]}})})},zs=function(e,n){void 0===n&&(n=5e3),Gi(Bs(void 0,void 0,void 0,function(){var r,o,i,a;return Hs(this,function(s){switch(s.label){case 0:return[4,L.getItem("backoff-"+e,void 0,t.LOCAL)];case 1:return r=s.sent(),o=((null==r?void 0:r.increment)||0)+1,i=Date.now()+1e3*Math.min(300,Math.pow(n/1e3,(1+o)/2)),a=Date.now()+2e4+1e3*(c=15,u=Math.pow(n/1e3,(2+o)/2),l=600,Math.max(c,Math.min(u,l))),[4,L.setItem("backoff-"+e,{increment:o,expiration:i,forget:a},t.LOCAL)];case 2:return s.sent(),[2]}var c,u,l})}))},Ws=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Ys=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Js=L.item("connectedServer",t.SESSION),Ks=function(){return Ws(void 0,void 0,void 0,function(){var e,t;return Ys(this,function(n){switch(n.label){case 0:return[4,Js.get()];case 1:return[2,!!(null===(t=null===(e=n.sent())||void 0===e?void 0:e.value)||void 0===t?void 0:t.proxyHost)]}})})},Xs=function(e){var t;return(null===(t=null==e?void 0:e.VPN)||void 0===t?void 0:t.MaxTier)||0},Zs=function(){var e,t=!1;n.g.browser||(n.g.browser=chrome);var r=((e={})[ii.USER]=function(e){var n=e.user;t=function(e){return Xs(e)>0}(n)},e);return browser.runtime.onMessage.addListener(function(e){var t,n=null==e?void 0:e.event;return null===(t=r[n])||void 0===t||t.call(r,e),!1}),function(){return!t}}(),Qs=function(){return Zs()?Ii.fromMinutes(30):Ii.fromMinutes(10)},ec=function(){return Zs()?Ii.fromDays(1):Ii.fromHours(6)},tc=function(){return 8*ec()},nc=function(){return Zs()?Ii.fromMinutes(20):Ii.fromMinutes(10)},rc=function(){return Ii.fromDays(10)},oc=function(){return oc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},oc.apply(this,arguments)},ic=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},ac=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},sc=L.item("location",t.LOCAL),cc=L.item("location-fetching",t.LOCAL);Gi(sc.remove());var uc=function(){return sc.load()},lc=function(){return ic(void 0,void 0,void 0,function(){var e,t,n,r,o,i,a,s;return ac(this,function(c){switch(c.label){case 0:return[4,uc()];case 1:return e=c.sent(),t=Qs(),(n=Ii.diffInMilliSeconds(null==e?void 0:e.time)<t)?[3,3]:[4,qs("location")];case 2:n=c.sent(),c.label=3;case 3:if(n)return[2,null==e?void 0:e.location];c.label=4;case 4:return r=Date.now(),[4,cc.get()];case 5:return r-((null===(s=c.sent())||void 0===s?void 0:s.time)||0)<Ii.fromSeconds(2)?[4,ba(200)]:[3,8];case 6:return c.sent(),[4,uc()];case 7:return o=c.sent(),Ii.diffInMilliSeconds(null==o?void 0:o.time)<t?[2,null==o?void 0:o.location]:[3,4];case 8:return[4,ic(void 0,void 0,void 0,function(){return ac(this,function(e){switch(e.label){case 0:return[2,!0];case 1:return[2,e.sent()]}})})];case 9:if(!c.sent())return[2,null==e?void 0:e.location];c.label=10;case 10:return c.trys.push([10,15,16,17]),[4,cc.setValue(null)];case 11:return c.sent(),[4,Va("vpn/v1/location")];case 12:return(i=c.sent())?[4,sc.set({time:Date.now(),location:i})]:[3,14];case 13:c.sent(),c.label=14;case 14:return[2,i];case 15:if(a=c.sent(),zs("location"),a instanceof Zi)throw a;return[2,null==e?void 0:e.location];case 16:return Gi(cc.remove()),[7];case 17:return[2]}})})},fc=function(e,t,n){return ic(void 0,void 0,void 0,function(){var r,o;return ac(this,function(i){switch(i.label){case 0:return[4,lc()];case 1:return r=i.sent(),(o=null==r?void 0:r.IP)&&(t||(t={}),t.headers=oc(oc({},t.headers),{"x-pm-netzone":o.replace(/\.\d+$/,".0"),"x-pm-country":null==r?void 0:r.Country})),[4,Va(e,t,void 0,n)];case 2:return[2,i.sent()]}})})},dc=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},pc=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},hc=function(e,t,n){return dc(void 0,void 0,void 0,function(){var r,o,i,a,s,c;return pc(this,function(u){switch(u.label){case 0:return[4,Vs()];case 1:if(r=(null===(c=null===(s=u.sent())||void 0===s?void 0:s.user)||void 0===c?void 0:c.VPN)||{},o=r.MaxTier,i=r.Groups,t||(t={}),"number"!=typeof o)throw new Error("Cannot fetch ".concat(e," while not authenticated"));return Object.assign(t.headers||(t.headers={}),{"x-pm-max-tier":"".concat(o)}),i&&(a=i.length,Object.assign(t.headers||(t.headers={}),1===a?{"x-pm-single-group":i.join(",")}:{"x-pm-group-count":a})),[4,fc(e,t,n)];case 2:return[2,u.sent()]}})})},vc=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},yc=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},bc=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},mc=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},gc=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},wc="file:///builds/ProtonVPN/browser-extension/proton-vpn-browser-extension/vpn-bex/source/js/account/credentials/getConnectionCredentials.ts".split("/").pop();if(!e())throw new Error("'use background' directive detected in: "+wc);var _c,xc,Sc=!1,Ec=[],kc=0,Oc=null,Ic=void 0,Pc=function(){Oc&&clearTimeout(Oc)},Tc=function(e,t){var n=1e3*Ms(null==Ic?void 0:Ic.credentials).expiration,r=Date.now(),o=Ii.fromSeconds(e.Expire,r),i=Ii.fromSeconds(e.Expire/2,r);Ic={time:n?Math.min(n,o):o,halfLife:n?Math.min((r+n)/2,i):i,credentials:e,sessionUid:t},Gi(Wi.set(Ic))},Cc=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return yc(void 0,gc([e],mc(t),!1),void 0,function(e,t){var n,r,o,i,a,s,c,u,l,f,d;return void 0===t&&(t=!0),bc(this,function(p){switch(p.label){case 0:Sc=!0,kc++,p.label=1;case 1:return p.trys.push([1,6,9,11]),kc>1?[4,ba(Math.pow(2,kc-2)*(500+1500*Math.random()))]:[3,3];case 2:p.sent(),p.label=3;case 3:return[4,hc("vpn/v1/browser/token?Duration="+w,{headers:{"x-pm-try-number":"".concat(kc)}})];case 4:return n=p.sent(),[4,null===(c=null===(s=null===browser||void 0===browser?void 0:browser.webRequest)||void 0===s?void 0:s.handlerBehaviorChanged)||void 0===c?void 0:c.call(s)];case 5:return p.sent(),kc=0,r=bf(),n&&(Tc(n,e),r.proxyEnabled&&(Rs(),"function"==typeof r.setCredentials&&r.setCredentials(n)),wi("Fetch at "+Date.now()+", expires at "+((null==Ic?void 0:Ic.time)||"unknown time"))),o=r.data,r.proxyEnabled&&(null===(u=o.error)||void 0===u?void 0:u.Warning)&&(delete o.error,i=(null===(l=o.server)||void 0===l?void 0:l.name)||"",hs("on","".concat($o("Label").t(_c||(_c=vc(["Protected"],["Protected"])))," - ").concat(i))),[2,n];case 6:return(a=p.sent())._id=Date.now()+"-"+Math.random(),t&&os(a)?(kc--,[4,oa()]):[3,8];case 7:return p.sent(),[2,Cc(e,!1)];case 8:try{ys(a,!0)}catch(e){return[2,void 0]}throw!function(e){return"object"==typeof e&&(2028===(null==e?void 0:e.Code)||2027===(null==e?void 0:e.Code))}(a)?"active"===bs&&(function(e){return ns(e,403)}(a)||kc>2||!as(a))&&Jl(a):(bi(a,(new Error).stack),Yl(!0)),a;case 9:return Sc=!1,[4,null===(d=null===(f=null===browser||void 0===browser?void 0:browser.webRequest)||void 0===f?void 0:f.handlerBehaviorChanged)||void 0===d?void 0:d.call(f)];case 10:return p.sent(),[7];case 11:return[2]}})})},jc=function(e){return yc(void 0,void 0,void 0,function(){var t,n,r;return bc(this,function(o){switch(o.label){case 0:if(Sc)return[2,new Promise(function(e,t){Ec.push([e,t])})];if((null==Ic?void 0:Ic.halfLife)&&e&&Ic.sessionUid===e&&Date.now()<Ic.halfLife)return[2,Ic.credentials];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Cc(e)];case 2:if(1e3!==(null==(t=o.sent())?void 0:t.Code))throw new Error(Ei(t||{error:"No credentials found"}));return Ec.forEach(function(e){(0,mc(e,1)[0])(t)}),Ec=[],Sc=!1,Tc(t,e),n=.1*Ii.fromSeconds(t.Expire),Pc(),Oc=ya(Ii.fromSeconds(t.Expire)-n,n,function(){return yc(void 0,void 0,void 0,function(){var t,r,o,i;return bc(this,function(a){switch(a.label){case 0:return Oc=null,[4,Nc()];case 1:return t=a.sent(),(r=((null==t?void 0:t.time)||0)>=Date.now()-2*n&&!Sc)?(o=e,[4,zi()]):[3,3];case 2:r=o===(null===(i=a.sent())||void 0===i?void 0:i.uid),a.label=3;case 3:return r&&Gi(jc(e)),[2]}})})}),[2,t];case 3:throw r=o.sent(),Ec.forEach(function(e){(0,mc(e,2)[1])(r)}),Ec=[],Sc=!1,r;case 4:return[2]}})})},Nc=function(){return Wi.load()},Dc=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return yc(void 0,gc([],mc(e),!1),void 0,function(e){var t,n,r,o;return void 0===e&&(e=!1),bc(this,function(i){switch(i.label){case 0:return[4,zi()];case 1:return(t=null===(o=i.sent())||void 0===o?void 0:o.uid)?[4,us()]:[2,void 0];case 2:i.sent(),i.label=3;case 3:return i.trys.push([3,5,,7]),[4,yc(void 0,void 0,void 0,function(){var e;return bc(this,function(n){switch(n.label){case 0:return[4,Nc()];case 1:return((null==(e=n.sent())?void 0:e.time)||0)<Date.now()?[2,jc(t)]:[2,null==e?void 0:e.credentials]}})})];case 4:return(n=i.sent())||!e?[2,n]:[3,7];case 5:if(r=i.sent(),!e||!rs(r))throw r;return[4,Xi({})];case 6:return i.sent(),[3,7];case 7:return[4,oa()];case 8:return i.sent(),[2,Dc()]}})})};!function(e){e.CLEAR="clear",e.DEFAULT="default",e.DISABLED="disable_non_proxied_udp"}(xc||(xc={}));var Lc=function(e){return new Promise(function(t){chrome.privacy?e!==xc.CLEAR?chrome.privacy.network.webRTCIPHandlingPolicy.set({value:e},function(){chrome.privacy.network.webRTCIPHandlingPolicy.get({},function(n){var r,o;t(("controlled_by_this_extension"===(o=null==(r=n)?void 0:r.levelOfControl)||"controllable_by_this_extension"===o?null==r?void 0:r.value:void 0)===e)})}):chrome.privacy.network.webRTCIPHandlingPolicy.clear({},t):t(!1)})},Ac=L.item("prevent-webrtc-leak"),Rc=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Mc=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},$c=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Uc=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Gc=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Fc=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Vc="file:///builds/ProtonVPN/browser-extension/proton-vpn-browser-extension/vpn-bex/source/js/tools/proxy.ts".split("/").pop();if(!e())throw new Error("'use background' directive detected in: "+Vc);var Bc,Hc=function(e){return"fixed_servers"===e.mode},qc=!1,zc=!1,Wc=function(e){return new Promise(function(t){chrome.proxy&&wf()?(qc=!0,Rs(),chrome.proxy.settings.set({value:e,scope:"regular"},function(){Kc().then(function(e){var t,n,r=null===(n=null===(t=null===browser||void 0===browser?void 0:browser.webRequest)||void 0===t?void 0:t.handlerBehaviorChanged)||void 0===n?void 0:n.call(t);return r?r.then(function(){return e}):e}).then(function(e){var n,r;zc||(zc=!0,null===(r=null===(n=chrome.proxy.onProxyError)||void 0===n?void 0:n.addListener)||void 0===r||r.call(n,function(e){return $c(void 0,void 0,void 0,function(){return Uc(this,function(t){switch(gs(e.error)){case es.TIMED_OUT:case es.TUNNEL_CONNECTION_FAILED:case es.PROXY_CONNECTION_FAILED:Os(!0)}return[2]})})})),t(e)})}),Gi(Hc(e)?Rc(void 0,void 0,void 0,function(){return Mc(this,function(e){switch(e.label){case 0:return[4,Ac.getDefined({value:!0})];case 1:return[4,e.sent().value?Lc(xc.DISABLED):Lc(xc.CLEAR)];case 2:return e.sent(),[2]}})}):Lc(xc.CLEAR))):t(!1)})},Yc=function(e,t,n){return void 0===n&&(n=[]),{mode:"fixed_servers",rules:{singleProxy:{scheme:O,host:e,port:t},bypassList:Fc(Fc(Fc([],Gc(n),!1),Gc(v),!1),Gc(y),!1)}}},Jc=function(){return new Promise(function(e){chrome.proxy?(qc=!1,chrome.proxy.settings.clear({},function(t){qc||(As(),Gi(Lc(xc.CLEAR))),e(Boolean(t))})):e(!1)})},Kc=function(){return $c(void 0,void 0,void 0,function(){return Uc(this,function(e){switch(e.label){case 0:return[4,(t=new Promise(function(e){chrome.proxy?chrome.proxy.settings.get({},function(t){return $c(void 0,void 0,void 0,function(){var n,r,o,i,a;return Uc(this,function(s){switch(s.label){case 0:return n=e,(r="controlled_by_this_extension"===(null==t?void 0:t.levelOfControl))?[3,5]:(null===(a=null==t?void 0:t.value)||void 0===a?void 0:a.mode)?(o=Hc(null==t?void 0:t.value),[3,4]):[3,1];case 1:return(i="controllable_by_this_extension"===(null==t?void 0:t.levelOfControl))?[4,Ks()]:[3,3];case 2:i=s.sent(),s.label=3;case 3:o=i,s.label=4;case 4:r=o,s.label=5;case 5:return n.apply(void 0,[r]),[2]}})})}):e(!1)}),n=Ii.fromSeconds(5),r="Unable to check proxy settings",void 0===o&&(o=Error),new Promise(function(e,i){var a=!1,s=setTimeout(function(){a=!0,i(new o(r||"Timeout"))},n);t.then(function(t){a||(e(t),clearTimeout(s))}).catch(i)}))];case 1:return[2,e.sent()]}var t,n,r,o})})},Xc=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Zc=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Qc=function(e,t){return"string"==typeof e&&"string"==typeof t?e.localeCompare(t):e>t?1:e<t?-1:0},eu=(function(){function e(e){Object.defineProperty(this,"transformer",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"sortingCallbacks",{enumerable:!0,configurable:!0,writable:!0,value:[]})}Object.defineProperty(e.prototype,"getField",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.transformer?this.transformer.apply(this,Zc([e],Xc(t),!1)):e}}),Object.defineProperty(e.prototype,"sort",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.sortingCallbacks.length&&e.sort(function(e,r){var o=t.getField.apply(t,Zc([e],Xc(n),!1)),i=t.getField.apply(t,Zc([r],Xc(n),!1)),a=0;return t.sortingCallbacks.some(function(e){return a=e(o,i)}),a})}}),Object.defineProperty(e.prototype,"asc",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.sortingCallbacks.push(function(t,n){return Qc(null==t?void 0:t[e],null==n?void 0:n[e])}),this}}),Object.defineProperty(e.prototype,"desc",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.sortingCallbacks.push(function(t,n){return Qc(null==n?void 0:n[e],null==t?void 0:t[e])}),this}})}(),function(e){return function(e){return e&&"object"==typeof e&&"number"==typeof(null==e?void 0:e.time)}(e)?Date.now()-e.time:1/0}),tu=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},nu=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ru=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},ou=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},iu={},au=function(e,n){return tu(void 0,void 0,void 0,function(){var r,o,i;return nu(this,function(a){switch(a.label){case 0:return[4,Va("vpn/v1/cities/names")];case 1:return r=a.sent(),(o=r.Cities)?(i={time:Date.now(),value:o},iu[n]=i,Gi(L.setItem("city-names-"+e,i,t.LOCAL)),[2,o]):[2,{}]}})})},su=function(e,n){return tu(void 0,void 0,void 0,function(){var r;return nu(this,function(o){switch(o.label){case 0:return iu[e]?[2,iu[e]]:[4,L.getItem("city-names-"+n,void 0,t.LOCAL)];case 1:return(r=o.sent())&&(iu[e]=r),[2,r]}})})},cu=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return tu(void 0,ou([e],ru(t),!1),void 0,function(e,t){var n,r,o,i;return void 0===t&&(t=!1),nu(this,function(a){switch(a.label){case 0:return n=navigator.languages||[Bo()],/^en(-.*)$/.test("".concat(n[0]||""))?[2,{}]:(r=n.join("/"),o=(e||"")+":"+r,t?[3,2]:[4,su(o,r)]);case 1:if(i=a.sent(),eu(i)<Ii.fromDays(20))return[2,(null==i?void 0:i.value)||{}];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,au(r,o)];case 3:return[2,a.sent()];case 4:return a.sent(),[2,{}];case 5:return[2]}})})};!function(e){e[e.SECURE_CORE=1]="SECURE_CORE",e[e.TOR=2]="TOR",e[e.P2P=4]="P2P",e[e.STREAMING=8]="STREAMING",e[e.IPV6=16]="IPV6",e[e.RESTRICTED=32]="RESTRICTED",e[e.PARTNER=64]="PARTNER"}(Bc||(Bc={}));var uu=function(e){return!(!(e&&e.Status>0)||3&(e.ServicesDown||0))},lu=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},fu=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},du=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},pu=L.item("logicals-servers",t.LOCAL),hu={},vu=function(){Gi(pu.remove())},yu=function(e){return lu(void 0,void 0,void 0,function(){var t,n,r,o,i,a;return fu(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),t=null==e?void 0:e.lastModified,[4,hc("vpn/v1/logicals",{headers:{"If-Modified-Since":t||"Thu, 01 Jan 1970 00:00:00 GMT"}},function(e,t){return{logicals:null==t?void 0:t.LogicalServers,lastModified:e.headers.get("Last-Modified")}})];case 1:return n=s.sent(),r=n.logicals,o=n.lastModified,r.forEach(gu),Gi(pu.setValue(r,{lastModified:o})),Gi(cu()),[2,r];case 2:if(i=s.sent(),null==e?void 0:e.value)return function(e){return 304===(null==e?void 0:e.status)||ns(e,304)}(a=null==i?void 0:i.response)&&Gi(pu.setValue(e.value,{lastModified:a.headers.get("Last-Modified")})),[2,e.value];throw i;case 3:return[2]}})})},bu=function(){return lu(void 0,void 0,void 0,function(){var e;return fu(this,function(t){switch(t.label){case 0:return[4,lu(void 0,void 0,void 0,function(){var e,t;return fu(this,function(n){switch(n.label){case 0:return[4,pu.get()];case 1:return e=n.sent(),t=eu(e),e&&t<ec()?[2,e.value]:e&&t<tc()?(Gi(yu(e)),[2,e.value]):[4,yu(e)];case 2:return[2,n.sent()]}})})];case 1:return function(e){e.sort(function(e,t){if(e.SearchScore!==t.SearchScore)return Qc(t.SearchScore,e.SearchScore);if(e.ExitCountry!==t.ExitCountry)return Qc(e.ExitCountry,t.ExitCountry);var n=du(e.Name.split("#",2),2),r=n[0],o=n[1],i=du(t.Name.split("#",2),2),a=i[0],s=i[1];return r===a?/^\d+$/.test(o||"0")&&/^\d+$/.test(s||"0")?Qc(parseInt(o||"0",10),parseInt(s||"0",10)):Qc(o,s):Qc(r,a)})}(e=t.sent().filter(function(e){return e.Tier<=(n.g.logicalMaxTier||2)&&(m||0===(e.Features&(Bc.TOR|Bc.RESTRICTED)))})),e.forEach(function(e){hu[e.ID]=e}),[2,e]}})})},mu=function(e){return hu[e]},gu=function(e){e._up=e.Status>0&&(e.Servers||[]).some(uu)},wu=function(e){return void 0===e._up&&gu(e),e._up},_u=L.item("notifications-enabled"),xu=function(){return xu=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},xu.apply(this,arguments)};function Su(e,t,n){_u.getDefined({value:!0}).then(function(r){var o;if(r.value){"string"==typeof t&&(t={message:t});var i=xu({type:"basic",title:"Proton VPN",iconUrl:"/img/icon-512.png"},t);i.message&&(null===(o=null===chrome||void 0===chrome?void 0:chrome.notifications)||void 0===o||o.create("proton-vpn-"+e,i,n||function(){}))}})}var Eu,ku=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Ou=function(e,t){var n=(e||[]).filter(function(e){return wu(e)&&t>=e.Tier}),r=1/0,o=void 0;return n.forEach(function(e){e.Score<r&&(r=e.Score,o=e)}),o},Iu=function(e,t,n){var r=Ou(e,t);if(!r)throw null==n||n(new Error($o("Error").t(Eu||(Eu=ku(["Unable to find appropriate server, try to logout and login again if it persists."],["Unable to find appropriate server, try to logout and login again if it persists."]))))),new Error("Misconfigured server. Cannot find the best one.");return r},Pu=function(e){var t=((null==e?void 0:e.Servers)||[]).filter(uu);return t[Math.floor(Math.random()*t.length)]},Tu=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Cu=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ju=function(e,t){return Tu(void 0,void 0,void 0,function(){var n,r,o,i;return Cu(this,function(a){switch(a.label){case 0:return[4,bu()];case 1:if(n=a.sent(),!(r=n.find(function(t){return t.ID===e})))return[2,{}];for(o=[function(t){return t.ID!==e},function(e){return e.Tier<=r.Tier},function(e){return(e.Features&Bc.SECURE_CORE)===(r.Features&Bc.SECURE_CORE)},function(e){return e.ExitCountry===r.ExitCountry},function(e){return e.Features===(r.Features&~Bc.RESTRICTED)}];o.length>2;){if(i=Ou(n.filter(function(e){return o.every(function(t){return t(e)})}),t))return[2,{logical:i,server:Pu(i)}];o.pop()}return[2,{server:void 0,logical:void 0}]}})})},Nu=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Du=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Lu=L.item("last-choice",t.LOCAL),Au=function(){return Gi(Lu.remove())},Ru=function(){return Nu(void 0,void 0,void 0,function(){var e;return Du(this,function(t){switch(t.label){case 0:return[4,Lu.get()];case 1:return[2,(null===(e=t.sent())||void 0===e?void 0:e.value)||{connected:!1}]}})})},Mu=function(e,t,n){return t.logicalId?n?n(t.logicalId):e.filter(function(e){return e.ID===t.logicalId}):e.filter(function(e){return 0===(e.Features&(Bc.TOR|Bc.RESTRICTED|Bc.PARTNER))&&(("other"!==t.filter||!(0!==(e.Features&Bc.TOR)||e.Tier>0||e.City))&&(("number"!=typeof t.tier||e.Tier===t.tier)&&((!t.excludedFeatures||0===(e.Features&t.excludedFeatures))&&((!t.requiredFeatures||0!==(e.Features&t.requiredFeatures))&&((!t.exitCountry||e.ExitCountry===t.exitCountry)&&((!t.entryCountry||e.EntryCountry===t.entryCountry)&&(!t.city||e.City===t.city)))))))})},$u=function(e){var t;return void 0!==(null===(t=null==e?void 0:e.User)||void 0===t?void 0:t.Name)},Uu=L.item("pmUser",j),Gu=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Fu=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Vu=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Bu=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Hu=function(){return Gu(void 0,void 0,void 0,function(){var e;return Fu(this,function(t){switch(t.label){case 0:return[4,Va("users")];case 1:return(e=t.sent())&&(Ql()||Wl(),Gi(Uu.set({time:Date.now(),user:e}))),[2,$u(e)?e.User:e]}})})},qu=function(){return Gu(void 0,void 0,void 0,function(){var e,t,n;return Fu(this,function(r){switch(r.label){case 0:return[4,Gu(void 0,void 0,void 0,function(){var e;return Fu(this,function(t){switch(t.label){case 0:return[4,Uu.load()];case 1:return e=t.sent(),$u(null==e?void 0:e.user)&&(e.user=e.user.User),[2,e]}})})];case 1:if(e=r.sent(),(t=eu(e))<(Zs()?Ii.fromMinutes(20):Ii.fromMinutes(10)))return[2,null==e?void 0:e.user];if(t<Ii.fromDays(3))return Gi(Hu()),[2,null==e?void 0:e.user];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Hu()];case 3:return[2,r.sent()];case 4:if(n=r.sent(),null==e?void 0:e.user)return[2,e.user];throw n;case 5:return[2]}})})},zu=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Gu(void 0,Bu([],Vu(e),!1),void 0,function(e){var t,n,r;return void 0===e&&(e=!1),Fu(this,function(o){switch(o.label){case 0:return[4,zi()];case 1:return(null===(r=o.sent())||void 0===r?void 0:r.uid)?[4,us()]:[2,void 0];case 2:o.sent(),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,qu()];case 4:return(t=o.sent())||!e?[2,t]:[3,6];case 5:if(n=o.sent(),!e||!rs(n))throw n;return[3,6];case 6:return[4,oa()];case 7:return o.sent(),[4,qu()];case 8:return[2,o.sent()]}})})},Wu=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Yu=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ju=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Ku=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Xu=[],Zu=function(){return Wu(void 0,void 0,void 0,function(){var e;return Yu(this,function(t){switch(t.label){case 0:return[4,Va("vpn/v2")];case 1:return(e=t.sent())&&(Ql()||Wl(),Gi($s.setValue(e))),[2,e]}})})},Qu=function(e){return Wu(void 0,void 0,void 0,function(){var t,n,r,o,i,a,s;return Yu(this,function(c){switch(c.label){case 0:return[4,Vs()];case 1:if(t=c.sent(),n=eu(t),r=e&&((null===(s=t.user)||void 0===s?void 0:s.VPN.MaxTier)||0)<1,o=nc(),n<(r?Ii.fromSeconds(1):o))return[2,null==t?void 0:t.user];if(!r&&n<Ii.fromDays(3))return Gi(Wu(void 0,void 0,void 0,function(){var e;return Yu(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,7]),[4,us()];case 1:return t.sent(),[4,Zu()];case 2:return t.sent(),[3,7];case 3:return e=t.sent(),rs(e)?[4,oa()]:[3,6];case 4:return t.sent(),[4,Promise.all([Zu(),Hu()])];case 5:return t.sent(),[2];case 6:throw ys(e),e;case 7:return[2]}})})),[2,null==t?void 0:t.user];i=Date.now(),(Xu=Xu.filter(function(e){return e<i-o})).push(i),c.label=2;case 2:return c.trys.push([2,4,5,6]),[4,Zu()];case 3:return[2,c.sent()];case 4:if(a=c.sent(),null==t?void 0:t.user)return[2,t.user];throw a;case 5:return e&&Gi(Hu()),[7];case 6:return[2]}})})},el=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Wu(void 0,Ku([],Ju(e),!1),void 0,function(e,t){var n,r,o,i;return void 0===e&&(e=!1),Yu(this,function(a){switch(a.label){case 0:return[4,zi()];case 1:return(null===(i=a.sent())||void 0===i?void 0:i.uid)?[4,us()]:[2,void 0];case 2:a.sent(),a.label=3;case 3:return a.trys.push([3,5,,6]),[4,Qu(t&&(s=Date.now(),(Xu=Xu.filter(function(e){return e<s-nc()})).length<20))];case 4:return(n=a.sent())||!e?[2,Us(n)?n.User:n]:[3,6];case 5:if(r=a.sent(),!e||!rs(r))throw r;return[3,6];case 6:return[4,oa()];case 7:return a.sent(),[4,Qu()];case 8:return o=a.sent(),[2,Us(o)?o.User:o]}var s})})},tl=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Wu(void 0,Ku([],Ju(e),!1),void 0,function(e,t){var r;return void 0===e&&(e=!1),Yu(this,function(o){switch(o.label){case 0:return[4,el(e,t)];case 1:return r=o.sent(),n.g.browser||(n.g.browser=chrome),Fi(browser.runtime.sendMessage({event:ii.USER,user:r})),[2,r]}})})},nl=function(){return tl(!0,!0)},rl=function(){return Gi($s.remove())},ol=function(){return Gi(Uu.remove())},il=function(){return il=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},il.apply(this,arguments)};function al(e,t){void 0===t&&(t={}),t.error instanceof Error&&(t.error={message:t.error.message,stack:t.error.stack}),sa("changeState",il({state:e},t))}var sl=L.item("split-tunneling"),cl=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},ul=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},ll=function(e,t){if(e<1)return[];var n=[];return t.forEach(function(e){n.push.apply(n,ul([e.domain],cl(e.withSubDomains?["."+e.domain]:[]),!1))}),n},fl=function(e,t){return function(n){return 0!==(n.Features&Bc.SECURE_CORE)===(e>0&&t.value)}},dl=function(e){return-1!==Ms(e).groups.indexOf("vpn-paid")?2:0},pl=L.item("client-config",t.LOCAL),hl=function(){return Gi(pl.remove())},vl=function(){return vl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},vl.apply(this,arguments)},yl=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},bl=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ml=L.item("review-info",t.SYNC),gl=function(){return yl(void 0,void 0,void 0,function(){var e,t;return bl(this,function(n){switch(n.label){case 0:return e=[{lastReviewTimestamp:0,lastDismissTimestamp:0,firstConnectionTimestamp:void 0,successConnectionsInRow:0,milliSecondsConnectedInRow:0,lastSeenConnectedTimestamp:void 0}],[4,ml.get()];case 1:return[2,vl.apply(void 0,e.concat([null!==(t=n.sent())&&void 0!==t?t:{}]))]}})})},wl=function(e,t,n){if(!t)return 0;var o=Ii.diffInMilliSeconds(t,n);return Ii.toSeconds(o)<r.tokenDuration?e+o:Ii.toDays(o)<2?e:0};function _l(e){return yl(this,void 0,void 0,function(){return bl(this,function(t){return[2,gl().then(function(t){return ml.set(vl(vl({},t),e instanceof Function?e(t):e||{}))})]})})}function xl(){return yl(this,void 0,void 0,function(){var e;return bl(this,function(t){return e=Date.now(),[2,_l(function(t){var n=t.milliSecondsConnectedInRow,r=void 0===n?0:n,o=t.lastSeenConnectedTimestamp;return{milliSecondsConnectedInRow:wl(r,void 0===o?0:o,e),lastSeenConnectedTimestamp:e}})]})})}var Sl=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},El=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},kl={},Ol=function(e,t,n,r,o){return Sl(void 0,void 0,void 0,function(){var i,a;return El(this,function(s){switch(s.label){case 0:return[4,ba(o)];case 1:if(s.sent(),Date.now()-(kl[e]||0)<Ii.fromMinutes(30))return[2];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,fetch("http://".concat(e,"/vpn/v1/browser/token"),{method:"HEAD",headers:t&&n?{"x-pm-vpn-authorization":"".concat(t,".").concat(n)}:{}})];case 3:if(403===(i=s.sent()).status)return kl[e]=Date.now(),[2];if(!ts(i))throw new Error("".concat(i.status||""," ").concat(i.statusText).trim());return Gi(xl()),[3,6];case 4:if(a=s.sent(),r>4)throw a;return[4,Ol(e,t,n,r+1,{1:500,2:Ii.fromSeconds(2),3:Ii.fromSeconds(6)}[r]||Ii.fromSeconds(12))];case 5:return s.sent(),[3,6];case 6:return[2]}})})},Il=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Pl=function(){return Pl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Pl.apply(this,arguments)},Tl=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Cl=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},jl=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Nl=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Dl="file:///builds/ProtonVPN/browser-extension/proton-vpn-browser-extension/vpn-bex/source/js/state.ts".split("/").pop();if(!e())throw new Error("'use background' directive detected in: "+Dl);var Ll,Al=_i(wi,"[state]"),Rl=_i(gi,"[state]"),Ml=_i(bi,"[state]"),$l=0,Ul=function(){var e,t;return!!(null===(t=null===(e=null==Ll?void 0:Ll.data)||void 0===e?void 0:e.error)||void 0===t?void 0:t.Warning)},Gl={},Fl=function(e){var t,n;return e===(null===(n=null===(t=null==Ll?void 0:Ll.data)||void 0===t?void 0:t.server)||void 0===n?void 0:n.proxyHost)||/^(.*\.)?protonvpn(\.net|\.com)(:\d+)?$/.test(e)||!!Gl[e]};function Vl(e,t){var n,r,o=Ll.data;if(!e||(null===(n=o.credsData)||void 0===n?void 0:n.Username)===e.Username&&(null===(r=o.credsData)||void 0===r?void 0:r.Password)===e.Password||Object.assign(o,{credsTry:0,credsData:e}),o.credsData)return{authCredentials:{username:o.credsData.Username,password:o.credsData.Password}}}var Bl={name:"on",initializedAt:0,proxyEnabled:!1,refreshingState:!1,init:function(e){if(this.proxyEnabled=!1,Ll.data=Pl(Pl(Pl({credsData:void 0},null==e?void 0:e.data),Ll.data),{starting:!0}),void 0===Ll.data.server)return zl(ql)},connectCurrentServer:function(){return Tl(this,void 0,void 0,function(){var e,t,n;return Cl(this,function(r){switch(r.label){case 0:return e=null===(n=null==Ll?void 0:Ll.data)||void 0===n?void 0:n.server,Rl("Connect to",e),(t=!!e)?[4,this.setProxy(e,e.bypassList||[])]:[3,2];case 1:t=r.sent(),r.label=2;case 2:return[2,t]}})})},setOption:function(e,t){return Tl(this,void 0,void 0,function(){var n;return Cl(this,function(r){switch(r.label){case 0:return e===ni.BYPASS_LIST?[3,1]:[3,4];case 1:return(null===(n=null==Ll?void 0:Ll.data)||void 0===n?void 0:n.server)?(Ll.data.server.bypassList=t,[4,this.connectCurrentServer()]):[3,3];case 2:r.sent(),r.label=3;case 3:return[3,4];case 4:return[2]}})})},setProxy:function(e){return Tl(this,arguments,void 0,function(e,t){var n,r,o,i;return void 0===t&&(t=[]),Cl(this,function(a){switch(a.label){case 0:return(null===(o=Ll.data)||void 0===o?void 0:o.starting)&&delete Ll.data.starting,Gl[e.proxyHost]=!0,[4,Dc()];case 1:return n=a.sent(),(r=!n)?[3,3]:[4,Nc()];case 2:r=((null===(i=a.sent())||void 0===i?void 0:i.time)||0)<Date.now(),a.label=3;case 3:return r?(Ml(n?"Expired token":"No token"),[2,!1]):[4,Wc(Yc(e.proxyHost,e.proxyPort,t))];case 4:return a.sent()?(this.proxyEnabled=!0,Gi(this.checkLogicalIsUp(n)),xl(),[2,!0]):[2,!1]}})})},setConnected:function(){return Tl(this,void 0,void 0,function(){var e,t,n,r,o,i,a,s,c;return Cl(this,function(u){switch(u.label){case 0:return(null===(a=null==Ll?void 0:Ll.data)||void 0===a?void 0:a.server)?(e=Date.now(),t=Ll,n=Ll.data.server,r=Ll.data.server.name,$l=e,[4,this.connectCurrentServer()]):(Jl(new Error($o("Error").t(nf||(nf=Il(["Server not found"],["Server not found"]))))),[2]);case 1:return u.sent()?((o=null===(s=Ll.data.server)||void 0===s?void 0:s.proxyHost)&&(i=null===(c=null==Ll?void 0:Ll.data)||void 0===c?void 0:c.credsData,function(e,t,n){Fi(Ol(e,t,n,1,300))}(o,null==i?void 0:i.Username,null==i?void 0:i.Password)),setTimeout(function(){var e;if(t===Ll&&(null===(e=Ll.data.server)||void 0===e?void 0:e.name)===r){al("connected",{server:n,error:Ll.data.error});var o=r||"";hs("on","".concat($o("Label").t(of||(of=Il(["Protected"],["Protected"])))," - ").concat(o))}},Math.max(1,200-(new Date).getTime()+e)),[2]):(Jl(new Error($o("Error").t(rf||(rf=Il(["Not able to control the browser network settings, possibly a permission is missing"],["Not able to control the browser network settings, possibly a permission is missing"]))))),[2])}})})},setCredentials:function(e){var t,n,r=null==e?void 0:e.Username,o=null==e?void 0:e.Password;if(r&&o){var i=null===(t=null==Ll?void 0:Ll.data)||void 0===t?void 0:t.credsData;r!==(null==i?void 0:i.Username)||o!==(null==i?void 0:i.Password)?function(e,t){if(!e||!t)return!0;var n=Ms(e),r=Ms(t);return n.sessionId!==r.sessionId||r.expiration>n.expiration}(i,e)&&(Object.assign(Ll.data,{credsTry:0,credsData:{Username:r,Password:o}}),Gi(this.setConnected())):(null===(n=Ll.data)||void 0===n?void 0:n.starting)&&Gi(this.setConnected())}},checkLogicalIsUp:function(e){return Tl(this,void 0,void 0,function(){var t,n,r,o,i,a,s,c,u,l,f,d,p,h;return Cl(this,function(v){switch(v.label){case 0:if(t=Date.now(),!(n=null===(d=null===(f=null==Ll?void 0:Ll.data)||void 0===f?void 0:f.server)||void 0===d?void 0:d.id)||t-$l<(Zs()?Ii.fromMinutes(20):Ii.fromMinutes(5)))return[2];r=this.initializedAt,$l=t,v.label=1;case 1:return v.trys.push([1,9,,10]),[4,ba(500)];case 2:return v.sent(),this.proxyEnabled&&ef()?[4,hc("vpn/v1/logicals?ID[]="+n)]:[2];case 3:return(o=v.sent().LogicalServers)[0]&&wu(o[0])?[3,8]:(a=e)?[3,5]:[4,Dc(!0)];case 4:a=v.sent(),v.label=5;case 5:return(i=a)?[4,ju(n,dl(i))]:[3,8];case 6:return s=v.sent(),c=s.server,(u=s.logical)&&c&&r===bf().initializedAt?[4,Kl(u,c,null===(h=null===(p=null==Ll?void 0:Ll.data)||void 0===p?void 0:p.server)||void 0===h?void 0:h.bypassList)]:[3,8];case 7:v.sent(),v.label=8;case 8:return[3,10];case 9:return l=v.sent(),ys(l),[3,10];case 10:return[2]}})})},refreshState:function(){return Tl(this,void 0,void 0,function(){var e,t,n,r,o,i,a,s;return Cl(this,function(c){switch(c.label){case 0:if(this.refreshingState)return[2];this.refreshingState=!0,c.label=1;case 1:return c.trys.push([1,,10,11]),Gi(this.checkLogicalIsUp()),(e=!(null===(i=Ll.data)||void 0===i?void 0:i.starting))?[4,Kc()]:[3,3];case 2:e=c.sent(),c.label=3;case 3:if(e)return[2];c.label=4;case 4:return c.trys.push([4,8,,9]),[4,yc(void 0,void 0,void 0,function(){var e,t,n,r,o,i,a,s;return bc(this,function(c){switch(c.label){case 0:return[4,Nc()];case 1:return e=c.sent(),t=((null==e?void 0:e.time)||0)-Date.now(),n=null==e?void 0:e.credentials,t<0&&!Sc?t<Ii.fromSeconds(-20)||!n?(r=jc,[4,zi()]):[3,3]:[3,5];case 2:return[2,r.apply(void 0,[null===(a=c.sent())||void 0===a?void 0:a.uid])];case 3:return o=Gi,i=jc,[4,zi()];case 4:o.apply(void 0,[i.apply(void 0,[null===(s=c.sent())||void 0===s?void 0:s.uid])]),c.label=5;case 5:return[2,n]}})})];case 5:return(t=c.sent())?(this.setCredentials(t),[2]):Ul()?[2]:(n=null===(a=null==Ll?void 0:Ll.data)||void 0===a?void 0:a.server,r=(null==n?void 0:n.name)||"",al("connecting",{server:n}),hs("connecting",$o("Status").t(af||(af=Il(["Connecting to ",""],["Connecting to ",""])),r)),[4,Dc(!0)]);case 6:if(t=c.sent(),!(Ul()||(null==t?void 0:t.Username)&&(null==t?void 0:t.Password)))return zl(ql),[2];if(this.setCredentials(t),!(null===(s=null==Ll?void 0:Ll.data)||void 0===s?void 0:s.server))throw new Error("No server");return[4,this.connectCurrentServer()];case 7:return c.sent(),[3,9];case 8:return Jl(o=c.sent()),Ri(o),[3,9];case 9:return[3,11];case 10:return this.refreshingState=!1,[7];case 11:return[2]}})})},handleProxyRequest:function(e){var t,n,r=Nl(Nl([],jl(y),!1),jl((null===(n=null===(t=null==Ll?void 0:Ll.data)||void 0===t?void 0:t.server)||void 0===n?void 0:n.bypassList)||[]),!1);if(function(e,t,n){var r=new URL(e.url),o=r.hostname;return!(-1===v.indexOf(o)||!t&&!/^\/?(api\/)?vpn\/location(\?.*)?$/.test(r.pathname))||(n||[]).some(function(t){return"."===t.charAt(0)?new RegExp(t.replace(".","\\.")+"$").test(o):!!aa(o,t)||(/[*\\/]/.test(t)?-1!==t.indexOf("/")?new RegExp("^"+(-1===t.indexOf("//")?"([^/]+.)?":"")+t.replace(".","\\.").replace("*",".*")).test(0===t.indexOf("://")?e.url.replace(/^[a-z]+(:\/\/)/,"$1"):0===t.indexOf("//")?e.url.replace(/^[a-z]+:(\/\/)/,"$1"):e.url):new RegExp(t.replace(".","\\.").replace("*",".*")+"$").test(o):o===t)})}(e,p,r))return{type:"direct"};var o=function(e){var t,n,r,o,i,a,s,c=Pl({type:O,host:null===(n=null===(t=null==Ll?void 0:Ll.data)||void 0===t?void 0:t.server)||void 0===n?void 0:n.proxyHost,port:null===(o=null===(r=null==Ll?void 0:Ll.data)||void 0===r?void 0:r.server)||void 0===o?void 0:o.proxyPort},null===(i=Vl(e))||void 0===i?void 0:i.authCredentials);return c.username&&c.password&&(c.proxyAuthorizationHeader=(a=c.username,s=c.password,"Basic "+btoa(a+":"+s))),c},i=function(){var e=(null==Ic?void 0:Ic.time)||0,t=Date.now();if(e>t)return e-t<Ii.fromSeconds(10)&&Gi(Dc(!0)),null==Ic?void 0:Ic.credentials}();if(i)return o(i);var a=function(e){return Dc(!0).then(function(t){return t?o(t):zi().then(function(t){return e>0?ba(400).then(function(){return a(e-1)}):((null==t?void 0:t.uid)?Jl(new Error($o("Error").t(sf||(sf=Il(["Server not found"],["Server not found"]))))):Yl(!0),{type:"direct"})})})};return a(3)},handleProxyAuthentication:function(e){return Tl(this,void 0,void 0,function(){var t,n,r,o;return Cl(this,function(i){switch(i.label){case 0:return e.isProxy?Ts(e)?[2,{cancel:!0}]:(t=e.challenger.host)===(null===(o=null===(r=null==Ll?void 0:Ll.data)||void 0===r?void 0:r.server)||void 0===o?void 0:o.proxyHost)||Gl[t]?[4,Dc()]:[3,2]:[3,2];case 1:return[2,(n=i.sent())&&Vl(n)||{cancel:!0}];case 2:return[2,void 0]}})})},checkConnectingState:function(e){var t,n;if(this.proxyEnabled){var r=null===(t=null==Ll?void 0:Ll.data)||void 0===t?void 0:t.server,o=(null==r?void 0:r.name)||"";al("connected",{server:r,error:Ll.data.error}),hs("on","".concat($o("Label").t(cf||(cf=Il(["Protected"],["Protected"])))," - ").concat(o))}else Date.now()-e>Ii.fromSeconds(30)&&Jl((null===(n=Ll.data)||void 0===n?void 0:n.error)||new Error("Connection timeout"))}},Hl={name:"loggedout",initializedAt:0,init:function(){return Tl(this,void 0,void 0,function(){return Cl(this,function(e){switch(e.label){case 0:return Pc(),Ll.data={},hs("loggedOut"),al("logged-out"),[4,Jc()];case 1:return e.sent(),[2]}})})},checkConnectingState:function(e){Date.now()-e>Ii.fromSeconds(5)&&al("logged-out")}},ql={name:"off",initializedAt:0,init:function(e){return Tl(this,void 0,void 0,function(){var t,n;return Cl(this,function(r){switch(r.label){case 0:return Pc(),Ll.data={},(t=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.error)&&(Ll.data.error=t instanceof Error?{message:t.message,stack:t.stack}:t),al("disconnected",{error:t}),hs(t?"error":"off",t&&Ei(t)),[4,Jc()];case 1:return r.sent(),[2]}})})},refreshState:function(){return Tl(this,void 0,void 0,function(){var e;return Cl(this,function(t){switch(t.label){case 0:return(e=Ll.data.server&&Date.now()-this.initializedAt>Ii.fromSeconds(3))?[4,Kc()]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return e?[4,Xl(Ll.data)]:[3,4];case 3:t.sent(),t.label=4;case 4:return[2]}})})},checkConnectingState:function(e){var t;Date.now()-e>Ii.fromSeconds(5)&&al("disconnected",{error:(null===(t=Ll.data)||void 0===t?void 0:t.error)||new Error("Connection initialization timeout")})}};function zl(e){var t,n,r,o=Ll||void 0;Ll=Object.assign({data:{}},e,{initializedAt:Date.now()}),Rl("Switch state to "+Ll.name,Ll.data),null===(t=Ll.init)||void 0===t||t.call(Ll,o),null===(n=Ll.refreshState)||void 0===n||n.call(Ll),Gi(Js.setValue(null===(r=Ll.data)||void 0===r?void 0:r.server))}function Wl(){zl(ql)}function Yl(e){var t=this;zl(Hl),Hi.get().then(function(n){return Tl(t,void 0,void 0,function(){return Cl(this,function(t){return ol(),rl(),Gi(Hi.remove()),Gi(qi.remove()),Gi(Yi()),vu(),Au(),hl(),e&&(null==n?void 0:n.uid)&&Gi(Ra("auth",{method:"DELETE"},void 0,n)),[2]})})}),Su("logged-out",$o("Info").t(uf||(uf=Il(["Logged out"],["Logged out"])))),Rl("Logged out")}function Jl(e){e&&Gi(function(){return yl(this,void 0,void 0,function(){return bl(this,function(e){return[2,_l({successConnectionsInRow:0,milliSecondsConnectedInRow:0,lastSeenConnectedTimestamp:void 0})]})})}()),Su("connected-server",e?"".concat(Ei(e)):$o("Info").t(lf||(lf=Il(["Disconnected"],["Disconnected"])))),bf().data.error=e,zl(ql)}function Kl(e,t,n){return Tl(this,void 0,void 0,function(){var r,o,i;return Cl(this,function(a){switch(a.label){case 0:return r=0!==(e.Features&Bc.SECURE_CORE),o=t.Label||"",[4,Xl({server:{id:e.ID,name:e.Name,exitIp:t.ExitIP,entryCountry:e.EntryCountry,exitCountry:e.ExitCountry,exitCity:(null===(i=e.Translations)||void 0===i?void 0:i.City)||e.City,exitEnglishCity:e.City,secureCore:r,proxyHost:x||t.Domain,proxyPort:r?k||S:S+(!E&&/^\d+$/.test(o)?parseInt(o,10):0),bypassList:n}})];case 1:return a.sent(),[2]}})})}function Xl(e){return Tl(this,void 0,void 0,function(){var t,n,r,o;return Cl(this,function(i){switch(i.label){case 0:return t=Zl,n=[e],[4,Js.get()];case 1:return[2,t.apply(void 0,n.concat([null===(o=null===(r=i.sent())||void 0===r?void 0:r.value)||void 0===o?void 0:o.name]))]}})})}function Zl(e,t){return Tl(this,void 0,void 0,function(){var n,r,o,i;return Cl(this,function(a){return delete Ll.data.error,Object.assign(Ll.data,e),zl(Bl),n=null===(o=null==e?void 0:e.server)||void 0===o?void 0:o.name,r=null===(i=null==e?void 0:e.server)||void 0===i?void 0:i.exitCity,t&&t===n||Su("connected-server",n?r?$o("Info").t(ff||(ff=Il(["Connected to "," in ",""],["Connected to "," in ",""])),n,r):$o("Info").t(df||(df=Il(["Connected to ",""],["Connected to ",""])),n):$o("Info").t(pf||(pf=Il(["Connected"],["Connected"])))),[2]})})}function Ql(){return Ll&&"loggedout"!==Ll.name}function ef(){return Ll&&"on"===Ll.name}function tf(){return Tl(this,void 0,void 0,function(){var e,t,n,r,o,i,a,s,c,u,l,f,d,p;return Cl(this,function(h){switch(h.label){case 0:return e=L.item("auto-connect"),t=L.item("secure-core"),[4,tl()];case 1:return(n=h.sent())?[4,Promise.all([Ru(),bu(),e.getDefined({value:!0}),sl.getDefined({value:[]}),t.getDefined({value:!1})])]:[2];case 2:return r=jl.apply(void 0,[h.sent(),5]),o=r[0],i=r[1],a=r[2],s=r[3],c=r[4],(null==o?void 0:o.connected)&&(null==a?void 0:a.value)?[4,zi()]:[3,5];case 3:return(null===(p=h.sent())||void 0===p?void 0:p.uid)?(u=Xs(n),l=Mu(i.filter(fl(u,c)).filter(function(e){return u>=e.Tier}),o,function(e){var t=mu(e);return t?[t]:[]}),l[0]?(f=("random"===o.pick?l[Math.floor(Math.random()*l.length)]:Iu(l,u))||l[0],(null==(d=Pu(f))?void 0:d.Domain)?[4,Kl(f,d,ll(u,s.value))]:[3,5]):[3,5]):[2];case 4:h.sent(),h.label=5;case 5:return[2]}})})}var nf,rf,of,af,sf,cf,uf,lf,ff,df,pf,hf=!1,vf=[];function yf(){return Tl(this,void 0,void 0,function(){return Cl(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,us()];case 1:return[2,e.sent()?ql:Hl];case 2:return e.sent(),[2,Hl];case 3:return[2]}})})}function bf(){var e=this;return Ll||(Rl("New state creation"),Ll={data:{}},Js.get().then(function(t){return Tl(e,void 0,void 0,function(){var e,n;return Cl(this,function(r){switch(r.label){case 0:return(e=null==t?void 0:t.value)?[4,Zl({server:e},e.name)]:[3,2];case 1:case 4:return r.sent(),[2];case 2:return Al("[getCurrentState]",null==t?void 0:t.value),n=zl,[4,yf()];case 3:return n.apply(void 0,[r.sent()]),[4,tf()]}})})}).finally(function(){hf=!0,vf.forEach(function(e){e()}),vf=[]})),Ll}var mf,gf=function(e){var t,n;return null===(n=null===(t=Ll)||void 0===t?void 0:t.handleProxyRequest)||void 0===n?void 0:n.call(t,e)},wf=function(){var e=chrome.proxy;if(!e)return!1;var t=e.onRequest;return!t||(t.hasListener(gf)||t.addListener(gf,{urls:["<all_urls>"]}),!0)},_f=function(){return _f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},_f.apply(this,arguments)},xf={vivaldi:{id:"4",welcomePage:"https://vivaldi.com/protonvpn/welcome/"}},Sf=(mf=void 0,function(){if(!mf)for(var e in mf={},xf){var t=xf[e];mf["".concat(t.id)]=_f({name:e},t)}return mf}),Ef=function(e){return Sf()["".concat(e)]},kf=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Of=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},If=function(e){return kf(void 0,void 0,void 0,function(){return Of(this,function(t){return[2,new Promise(function(t){var r,o,i=null===(o=null===(r=n.g[e])||void 0===r?void 0:r.protonvpn)||void 0===o?void 0:o.getStatus;"function"!=typeof i?t({oauthAllowed:!1,loggedInUser:!1,signupButton:!1}):i(function(n){var r;"boolean"==typeof(null==n?void 0:n.isLoggedIn)?t({partnerId:null===(r=xf[e])||void 0===r?void 0:r.id,oauthAllowed:!0,loggedInUser:n.isLoggedIn,signupButton:n.canSignUp||!1}):t({oauthAllowed:!1,loggedInUser:!1,signupButton:!1})})})]})})},Pf=function(){return kf(void 0,void 0,void 0,function(){var e,t;return Of(this,function(n){switch(n.label){case 0:return e=Object.keys(xf),[4,Promise.all(e.map(If))];case 1:return t=n.sent().filter(function(e){return e.oauthAllowed}),[2,t[0]||{oauthAllowed:!1,loggedInUser:!1,signupButton:!1}]}})})},Tf=function(){if(!browser.tabs)throw new Error("Some permissions for the extension are missing, please try to re-install");return browser.tabs},Cf=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},jf=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Nf=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Df=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Lf=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Af=!1,Rf=[],Mf=L.item("servers-count",t.LOCAL),$f=function(){return Nf(void 0,void 0,void 0,function(){var e,t;return Df(this,function(n){switch(n.label){case 0:if(Af)return[2,new Promise(function(e,t){Rf.push([e,t])})];Af=!0,n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,Va("vpn/servers-count")];case 2:return e=n.sent(),Gi(Mf.setValue(e)),Rf.forEach(function(t){(0,Lf(t,1)[0])(e)}),[2,e];case 3:throw t=n.sent(),Rf.forEach(function(e){(0,Lf(e,2)[1])(t)}),t;case 4:return Rf=[],Af=!1,[7];case 5:return[2]}})})},Uf=function(){return Nf(void 0,void 0,void 0,function(){var e,t,n,r;return Df(this,function(o){switch(o.label){case 0:return[4,Mf.get()];case 1:if(e=o.sent(),t=eu(e),e&&t<rc())return[2,e.value];if(e&&t<2*rc())return Gi($f()),[2,e.value];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,$f()];case 3:return(n=o.sent()).Servers<12e3||n.Countries<110?(Ri(new Error("Incorrect results from API: servers = ".concat(n.Servers,", countries = ").concat(n.Countries))),[2,{Servers:13626,Countries:122,Capacity:15942}]):[2,n];case 4:if(r=o.sent(),null==e?void 0:e.value)return[2,e.value];throw r;case 5:return[2]}})})},Gf=function(e,t){void 0===t&&(t=!0);var n,r=(n=e,btoa(n).trim()).replace(/\+/g,"-").replace(/\//g,"_");return t?r.replace(/=/g,""):r},Ff=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Vf=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Bf={signup:"2"},Hf=function(e){return Ff(void 0,[e],void 0,function(e){var n,r,o,i=e.host,a=e.action,c=e.partnerId,u=e.independent;return Vf(this,function(e){switch(e.label){case 0:return n=Gf(function(e){for(var t=[],n=16384,r=e.length,o=0;o<r;o+=n)t.push(String.fromCharCode.apply(String,e.subarray(o,o+n<r?o+n:r)));return t.join("")}(crypto.getRandomValues(new Uint8Array(32)))),r={partnerId:c,independent:u},[4,L.setItem("f".concat(n),r,t.LOCAL)];case 1:return e.sent(),o={app:"proton-vpn-browser-extension",appVersion:s(),state:n,t:a&&Bf[a]||"1",plan:"vpn2024"},c&&(o.partnerId=c),u&&(o.independent="1"),[2,"".concat(i,"/authorize?").concat(new URLSearchParams(o).toString())]}})})},qf=function(){return qf=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},qf.apply(this,arguments)},zf=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Wf=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Yf=function(e,t,n){return zf(void 0,void 0,void 0,function(){var r,o,i,a,s;return Wf(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,(r=null===(i=browser.scripting)||void 0===i?void 0:i.executeScript)?r(qf({target:{tabId:e,allFrames:!0}},t())):null===(s=(a=Tf()).executeScript)||void 0===s?void 0:s.call(a,e,{code:n()})];case 1:return c.sent(),[3,3];case 2:return o=c.sent(),bi(o),[3,3];case 3:return[2]}})})},Jf=function(){return Jf=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Jf.apply(this,arguments)},Kf=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Xf=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Zf=n.g||window;Zf.browser||(Zf.browser=chrome);var Qf=L.item("tabs",t.LOCAL),ed=function(e){var t,n;!function(e){Gi(Kf(void 0,void 0,void 0,function(){var t,n,r,o;return Xf(this,function(i){switch(i.label){case 0:return n=(t=Qf).set,r=[{}],[4,Qf.load({})];case 1:return[4,n.apply(t,[Jf.apply(void 0,[Jf.apply(void 0,r.concat([i.sent()])),(o={},o[e]=!0,o)])])];case 2:return[2,i.sent()]}})}))}(e),Gi(null===(n=(t=Tf()).executeScript)||void 0===n?void 0:n.call(t,e,{code:"\n\t\t\tchrome.runtime.connect();\n\t\t\twindow.addEventListener('message', (event) => {\n\t\t\t\tif (event.source != window) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tchrome.runtime.sendMessage({...event.data, tabId: ".concat(JSON.stringify(e),"});\n\t\t\t}, false);\n\t\t")}))},td=function(e,t){return Kf(void 0,void 0,void 0,function(){var n,r,o,i,a,s;return Xf(this,function(c){switch(c.label){case 0:return t?(n=t.partnerId?Ef(t.partnerId):void 0,o=(r=Promise).all,e?(i=[e],[3,3]):[3,1]):[2];case 1:return s=(a=Object).keys,[4,Qf.load({})];case 2:i=s.apply(a,[c.sent()]),c.label=3;case 3:return[4,o.apply(r,[i.map(function(e){return Kf(void 0,void 0,void 0,function(){var r;return Xf(this,function(o){switch(o.label){case 0:return e=Number(e),r=null==n?void 0:n.welcomePage,[4,Yf(e,function(){return{func:function(e,t){t&&(location.href=t),window.postMessage(e)},args:[t,r]}},function(){return"\n\t\t\t\t\t".concat(r?"location.href = ".concat(JSON.stringify(r),";"):"","\n\t\t\t\t\twindow.postMessage(").concat(JSON.stringify(t),");\n\t\t\t\t")})];case 1:return o.sent(),[2]}})})})])];case 4:return c.sent(),Gi(Qf.set({})),[2]}})})},nd=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},rd=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},od={},id=function(e,t){return nd(void 0,void 0,void 0,function(){var n,r;return rd(this,function(o){switch(o.label){case 0:if(n="string"==typeof e?{url:e}:e,r=t||n.url){if(od[r])throw new Error("Url already open");od[r]=!0,setTimeout(function(){delete od[r]},800)}return[4,Tf().create(n)];case 1:return[2,o.sent()]}})})},ad=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},sd=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},cd=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},ud=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},ld=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ad(void 0,ud([],cd(e),!1),void 0,function(e){var t,n=void 0===e?{}:e,r=n.action,o=n.partnerId,i=n.independent;return sd(this,function(e){switch(e.label){case 0:return[4,qs("openForkTab")];case 1:if(e.sent())throw new Error("Fork in progress");return zs("openForkTab",500),t=id,[4,Hf({host:u,action:r,partnerId:o,independent:i})];case 2:return t.apply(void 0,[e.sent(),"fork"]).then(function(e){e.id&&ed(e.id);var t=function(n){var r,o;e.id===n&&(Tf().onRemoved.removeListener(t),null===(o=null===(r=browser.action)||void 0===r?void 0:r.openPopup)||void 0===o||o.call(r))};Tf().onRemoved.addListener(t)}),[2]}})})},fd=["http://*/*","https://*/*","ftp://*/*","ws://*/*","wss://*/*","https://account.protonvpn.com/*","https://account.proton.me/*"];"https://account.proton.me"!==u&&fd.push(u+"/*");var dd,pd,hd,vd,yd,bd,md,gd,wd,_d,xd,Sd,Ed,kd,Od={permissions:["proxy"],origins:fd},Id=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Pd=void 0,Td=0,Cd=function(e){Pd||(Pd=13626);var t=function(e,t){var n=Math.floor(e/t)*t;return n===Pd?n-100:n}(Pd,100),n=zo().format(t);e&&"querySelectorAll"in e&&e.querySelectorAll(".incentive-paragraph").forEach(function(e){e.innerHTML=$o("Info").plural(t,function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new Ao(e,t)}(dd||(dd=Id(["High performance Swiss VPN that protects your privacy. Maximum security, more than "," server and no restrictions."],["High performance Swiss VPN that protects your privacy. Maximum security, more than "," server and no restrictions."])),n),"High performance Swiss VPN that protects your privacy. Maximum security, more than ".concat(n," servers and no restrictions."))})},jd=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Nd=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Dd=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ld=function(){if(Date.now()-Td>Ii.fromHours(3))return Uf().then(function(e){var t;return t=e.Servers,Pd=t,Td=Date.now(),Cd(),e})},Ad=function(e,t,n,r){return Nd(void 0,void 0,void 0,function(){var o,i,a,s,u,l,f,d,p,h,v,y,m,g,w,_,x;return Dd(this,function(S){switch(S.label){case 0:return e&&t?((r=!(void 0!==r&&!r||!chrome.proxy))&&chrome.permissions.contains(Od,function(r){r||Rd(e,t,n,!1)}),o=function(e){return function(t){if(t){s.classList.add("update-extension"),s.innerHTML=$o("Action").t(hd||(hd=jd(["Update"],["Update"])));var n=(null==t?void 0:t.Error)||Ei(t);i[0]&&(i[0].classList.remove("incentive-paragraph"),i[0].innerHTML=" "+n),i[1]&&(i[1].style.display="none"),a&&(a.style.display="none");var r=new Error(e+": "+n);r.previous=t,Ri(r)}}},null===(x=Ld())||void 0===x||x.catch(o("prepareSigningView")),i=e.querySelectorAll("p"),a=e.querySelector("button.sign-up-button"),s=e.querySelector("button.sign-in-button"),u=e.querySelector("a.sign-in-link"),s.classList.remove("update-extension"),l=function(e){void 0===e&&(e=""),s.innerHTML=e||(r?$o("Action").t(vd||(vd=jd(["Sign in"],["Sign in"]))):$o("Action").t(yd||(yd=jd(["Next"],["Next"]))))},[4,Pf()]):[2,ld()];case 1:return f=S.sent(),d=f.oauthAllowed,p=f.signupButton,h=f.partnerId,l(d?$o("Action").t(bd||(bd=jd(["Sign in with Vivaldi"],["Sign in with Vivaldi"]))):""),u.style.display=d?"inline":"none",d?((v=e.querySelector(".sign-up-button-box"))&&!p&&(v.style.display="none"),e.classList.add("partner"),y="img/partner-welcome-image-dark@2x.svg",m=new Image,[4,new Promise(function(e){m.onload=e,m.onerror=e,m.src=y,setTimeout(e,1e3)})]):[3,3];case 2:S.sent(),e.querySelectorAll("img.welcome-background").forEach(function(e){e.src=y}),(g=e.querySelector("h1"))&&(g.innerText=$o("Title").t(md||(md=jd(["Proton VPN for Vivaldi"],["Proton VPN for Vivaldi"])))),(w=e.querySelector(".incentive-paragraph"))&&(w.innerText=$o("Info").t(gd||(gd=jd(["Protect yourself online with Proton's free highspeed VPN."],["Protect yourself online with Proton's free highspeed VPN."])))),S.label=3;case 3:if(e.style.display="block",t.style.display="none",n&&(n.style.display="none"),_=function(e){return Nd(void 0,void 0,void 0,function(){var t;return Dd(this,function(n){switch(n.label){case 0:return t=setTimeout(function(){null===window||void 0===window||window.close()},200),[4,browser.permissions.request(Od)];case 1:return n.sent()?(r||Gi(si(ri.PROXY)),clearTimeout(t),[4,ld({partnerId:e})]):[2];case 2:return n.sent(),null===window||void 0===window||window.close(),[2]}})})},s.addEventListener("click",function(){return Nd(void 0,void 0,void 0,function(){return Dd(this,function(e){switch(e.label){case 0:return s.classList.contains("update-extension")?(Gi(id((/^moz-extension:/.test(location.href)?{name:"Firefox",type:"firefox",pluginsUrl:"https://addons.mozilla.org/firefox/addon/proton-vpn-firefox-extension",storeReviewsUrl:"https://addons.mozilla.org/firefox/addon/proton-vpn-firefox-extension/reviews/"}:{name:"Chrome",type:"chromium",pluginsUrl:"chrome://extensions/",storeReviewsUrl:"https://chromewebstore.google.com/detail/proton-vpn-fast-secure/".concat(c,"/reviews")}).pluginsUrl)),null===window||void 0===window||window.close(),[2]):[4,_(h)];case 1:return e.sent(),[2]}})})}),u&&u.addEventListener("click",function(){return Nd(void 0,void 0,void 0,function(){return Dd(this,function(e){switch(e.label){case 0:return[4,_(void 0)];case 1:return e.sent(),[2]}})})}),setTimeout(function(){s.scrollIntoView()}),i[0]){if(!r)return i[0].classList.remove("incentive-paragraph"),i[0].innerHTML="<b>".concat($o("Info").t(wd||(wd=jd(["Allow VPN permissions"],["Allow VPN permissions"]))),"</b><br><br>")+$o("Info").t(_d||(_d=jd(["To get started, youll need to enable VPN permissions on your browser."],["To get started, youll need to enable VPN permissions on your browser."])))+"<br><br>"+$o("Info").t(xd||(xd=jd(["Press <b>Next</b>, then click <b>Allow</b> on the pop-up from your browser."],["Press <b>Next</b>, then click <b>Allow</b> on the pop-up from your browser."])))+"<br><br>"+$o("Info").t(Sd||(Sd=jd(["Then just click the Proton VPN icon to sign in."],["Then just click the Proton VPN icon to sign in."]))),[2];!function(e,t,n){if(n)return t.classList.add("partner-subtitle"),t.classList.remove("incentive-paragraph"),void(t.innerText=$o("Info").t(pd||(pd=Id(["Protect yourself online with Proton's free highspeed VPN."],["Protect yourself online with Proton's free highspeed VPN."]))));t.classList.add("incentive-paragraph"),Cd(e)}(e,i[0],d)}return r&&b?(!d&&i[1]&&(i[1].style.display="",i[1].innerHTML=$o("Action").t(Ed||(Ed=jd(["New to Proton?"],["New to Proton?"])))),a&&(a.style.display="",a.innerHTML=$o("Action").t(kd||(kd=jd(["Create an account"],["Create an account"]))),a.addEventListener("click",function(){return Nd(void 0,void 0,void 0,function(){return Dd(this,function(e){switch(e.label){case 0:return[4,ld({action:"signup",partnerId:h})];case 1:return e.sent(),null===window||void 0===window||window.close(),[2]}})})})),pa().then(o("getUpdateError")),[2]):(i[1]&&(i[1].style.display="none"),a&&(a.style.display="none"),[2])}})})},Rd=function(e,t,n,r){Gi(Ad(e,t,n,r))},Md=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},$d=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ud=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Gd=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Fd=n.g||window;Fd.browser||(Fd.browser=chrome);var Vd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Md(void 0,Gd([],Ud(e),!1),void 0,function(e){var t,n,r;return void 0===e&&(e={}),$d(this,function(o){switch(o.label){case 0:return Ld(),[4,Xi(e)];case 1:return o.sent(),t=document.getElementById("spinner"),n=document.getElementById("sign-in-view"),r=document.getElementById("logged-view"),n&&r?(Rd(n,r,t),[2,!1]):(al("logged-out"),[2,!1])}})})},Bd=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Hd=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},qd=n.g||window;qd.browser||(qd.browser=chrome);var zd,Wd,Yd=function(e){return Bd(void 0,[e],void 0,function(e){var n,r,o,i,a,s,c=e.state,u=e.selector;return Hd(this,function(e){switch(e.label){case 0:return n="f".concat(c),[4,L.getItem(n,void 0,t.LOCAL)];case 1:if(!(r=e.sent()))throw new Error("Invalid state");return Gi(L.removeItem(n)),[4,Va("auth/sessions/forks/".concat(u))];case 2:return o=e.sent(),i=o.UID,a=o.AccessToken,s=o.RefreshToken,[2,{session:{accessToken:a,refreshToken:s,uid:i},forkState:r}]}})})},Jd=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Kd=function(){return Kd=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Kd.apply(this,arguments)},Xd=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Zd=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Qd=function(e){return Xd(void 0,void 0,void 0,function(){var t,n,r,o,i,a,s,u,l,f,d,p,h;return Zd(this,function(v){switch(v.label){case 0:if(!e||"object"!=typeof e)return[2];if(n=(t=e).payload,r=t.extension,o=t.token,r&&r!==c)return[2];if(i=o?{token:o}:{},!n||"object"!=typeof n)return[2,Kd(Kd({},i),{type:"error"})];a=n.selector,s=n.persistent,u=n.state,v.label=1;case 1:return v.trys.push([1,4,,5]),[4,Yd({state:u,selector:a})];case 2:return l=v.sent(),f=l.session,d=l.forkState,f.persistent=s,f.partnerId=d.partnerId||void 0,[4,Xi(f)];case 3:return v.sent(),Gi(nl()),[2,Kd(Kd({},i),{type:"success",partnerId:f.partnerId,payload:{title:$o("Info").t(zd||(zd=Jd(["You're signed in"],["You're signed in"]))),message:$o("Info").t(Wd||(Wd=Jd(["Open the Proton VPN browser extension to continue"],["Open the Proton VPN browser extension to continue"])))}})];case 4:return p=v.sent(),mi(p),h=Ei(p),[2,Kd(Kd(Kd({},i),{type:"error"}),h?{payload:{message:h}}:{})];case 5:return[2]}})})},ep=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},tp=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},np="file:///builds/ProtonVPN/browser-extension/proton-vpn-browser-extension/vpn-bex/source/js/messaging/messaging.ts".split("/").pop();if(!e())throw new Error("'use background' directive detected in: "+np);var rp,op,ip,ap,sp=function(e){return ep(void 0,void 0,void 0,function(){var t,n,r,o,i,a,s,c,u,l;return tp(this,function(f){switch(f.label){case 0:switch(t=e.type,n=e.data,t){case oi.FORK:return[3,1];case ii.USER:return[3,4];case ii.PM_USER:return[3,7];case ti.SIGN_OUT:return[3,10];case ti.SWITCH_ACCOUNT:return[3,12];case ii.STATE:return[3,14];case ti.DISCONNECT:return[3,15];case ti.CONNECTING:return[3,16];case ti.CONNECT:return[3,17];case oi.FORGET_ERROR:return[3,19];case oi.LOG:return[3,20];case ri.PROXY:return[3,21];case ni.BYPASS_LIST:return[3,22]}return[3,23];case 1:return r=td,o=[e.tabId],[4,Qd(e)];case 2:return[4,r.apply(void 0,o.concat([f.sent()]))];case 3:return f.sent(),[2,null];case 4:case 7:return[4,zi()];case 5:if(!(null===(i=f.sent())||void 0===i?void 0:i.uid))throw new Error("No session");return[4,nl()];case 6:case 9:return[2,f.sent()];case 8:if(!(null===(a=f.sent())||void 0===a?void 0:a.uid))throw new Error("No session");return[4,zu(!0)];case 10:return Yl(!0),[4,Vd()];case 11:case 13:case 18:return f.sent(),[3,23];case 12:return Yl(!1),[4,Vd()];case 14:return[2,bf().data];case 15:return Jl(),[3,23];case 16:return null===(c=(s=bf()).checkConnectingState)||void 0===c||c.call(s,n.connectionAttemptTime),[3,23];case 17:return[4,Kl(n.logical,n.server,n.bypassList)];case 19:return delete bf().data.error,[3,23];case 20:return pi(n),[3,23];case 21:return wf(),[3,23];case 22:return null===(l=(u=bf()).setOption)||void 0===l||l.call(u,t,n),[3,23];case 23:return[2,void 0]}})})},cp=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},up=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},lp=function(e){return cp(void 0,void 0,void 0,function(){var t;return up(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,5]),[4,sp(e)];case 1:return[2,n.sent()];case 2:return(t=n.sent())instanceof Zi?(Yl(!1),[4,Vd()]):[3,4];case 3:return n.sent(),[2,{error:t}];case 4:return[2,{error:t}];case 5:return[2]}})})},fp=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},dp=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},pp=function(){var e=0,t=new Date,n=Zs()?Ii.fromHours(1):Ii.fromMinutes(15);ma(n,n/5,function(){return fp(void 0,void 0,void 0,function(){var n,r,o;return dp(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),n=sa,r=["logicalUpdate"],[4,lu(void 0,void 0,void 0,function(){var e,t,n,r;return fu(this,function(o){switch(o.label){case 0:return[4,pu.get()];case 1:return e=o.sent(),t=eu(e),!e||t>tc()?[4,yu(e)]:[3,3];case 2:return[2,o.sent()];case 3:return[4,hc("vpn/loads")];case 4:return n=o.sent().LogicalServers,r={},n.forEach(function(e){r[e.ID]=e}),e.value.forEach(function(e){r[e.ID]&&gu(Object.assign(e,r[e.ID]))}),[4,pu.set(e)];case 5:return o.sent(),[2,e.value]}})})];case 1:return n.apply(void 0,r.concat([i.sent()])),t=new Date,e=0,[3,3];case 2:return o=i.sent(),++e>5&&bi("Loagical load update failed after "+e+" attempts, last update was ",t,o),[3,3];case 3:return[2]}})})})},hp=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},vp=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},yp=function(e){return hp(void 0,void 0,void 0,function(){return vp(this,function(t){switch(t.label){case 0:return hs("loggedOut"),Pc(),[4,tl(!0)];case 1:return t.sent()?e?[4,Xl({server:e})]:[3,3]:[2];case 2:case 4:return t.sent(),[2];case 3:return Wl(),[4,tf()]}})})},bp=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},mp=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},gp=_i(wi,"[initState]"),wp=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},_p=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},xp=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Sp=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},Ep=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},kp="file:///builds/ProtonVPN/browser-extension/proton-vpn-browser-extension/vpn-bex/source/js/background.ts".split("/").pop();if(!e())throw new Error("'use background' directive detected in: "+kp);Gi($c(void 0,void 0,void 0,function(){return Uc(this,function(e){switch(e.label){case 0:return[4,Wc(Yc("localhost",9))];case 1:return[2,e.sent()]}})})),$i(),Rs(),n.g.browser||(n.g.browser=chrome),browser.runtime.onMessage.addListener(function(e){var t=new Promise(function(t){return cp(void 0,void 0,void 0,function(){var n;return up(this,function(r){switch(r.label){case 0:return[4,lp(e)];case 1:return n=r.sent(),t({received:!0,success:!n||!("object"==typeof n&&n.error),result:n}),[2]}})})});if("broadcast"!==e.respondTo)return t;t.then(function(t){Gi(browser.runtime.sendMessage(browser.runtime.id,{type:"answer:"+e.requestId,respondTo:"none",data:function(){try{return JSON.parse(JSON.stringify(t))}catch(e){return{result:{error:"".concat(e)}}}}()}))})}),browser.runtime.onMessageExternal.addListener(function(e,t){return cp(void 0,void 0,void 0,function(){var n,r,o;return up(this,function(i){switch(i.label){case 0:return e.type!==oi.FORK?[3,5]:[4,Qd(e)];case 1:return n=i.sent(),(r=(null==n?void 0:n.partnerId)?null===(o=Ef(n.partnerId))||void 0===o?void 0:o.welcomePage:void 0)?[4,Yf(t.tab.id,function(){return{func:function(e){location.href=e},args:[r]}},function(){return"location.href = ".concat(JSON.stringify(r),";")})]:[3,4];case 2:return i.sent(),[4,ba(500)];case 3:i.sent(),i.label=4;case 4:return[2,n];case 5:return[2]}})})}),setTimeout(function(){return bp(void 0,void 0,void 0,function(){var e,t,n;return mp(this,function(r){switch(r.label){case 0:return gp("Init state",(new Error).stack),[4,new Promise(function(e){hf?e():(vf.push(e),bf())})];case 1:return r.sent(),[4,Js.get()];case 2:if(e=null===(n=r.sent())||void 0===n?void 0:n.value,gp(e),e?ef():Ql())return[3,6];gp(e?"Not connected":"Not logged in"),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,yp(e)];case 4:return r.sent(),[3,6];case 5:return t=r.sent(),sa("changeState",{state:"disconnected",server:void 0,error:t}),[3,6];case 6:return ef()?[3,8]:[4,Jc()];case 7:r.sent(),r.label=8;case 8:return setInterval(function(){return Ui(function(){var e,t;null===(t=(e=bf()).refreshState)||void 0===t||t.call(e)})},Ii.fromSeconds(1)),function(){var e,t=function(){lc().catch(function(e){(e instanceof Zi||e.logout)&&Yl(!1)})},n=Qs();ma(n,n/10,t),null===(e=navigator.connection)||void 0===e||e.addEventListener("change",t)}(),pp(),[2]}})})},1),wf(),Gi(Po(void 0,void 0,void 0,function(){var e,t;return To(this,function(n){switch(n.label){case 0:if("en_US"===(e=qo()))return Fo(e,{}),[2];n.label=1;case 1:return n.trys.push([1,3,,8]),[4,Vo(e)];case 2:return n.sent(),[3,8];case 3:if(n.sent(),(t=Ho(e.split("_")[0]||""))===e)return Fo(e,{}),[2];n.label=4;case 4:return n.trys.push([4,6,,7]),[4,Vo(t)];case 5:return n.sent(),[3,7];case 6:return n.sent(),Fo("en_US",{}),[3,7];case 7:return[3,8];case 8:return[2]}})})),browser.runtime.onInstalled.addListener(function(e){return Cf(void 0,void 0,void 0,function(){var t;return jf(this,function(n){switch(n.label){case 0:return[4,kf(void 0,void 0,void 0,function(){return Of(this,function(e){switch(e.label){case 0:return[4,Pf()];case 1:return[2,e.sent().oauthAllowed]}})})];case 1:return n.sent()?[2]:"install"===e.reason?[3,2]:[3,4];case 2:return t=browser.runtime.getURL("/onboarding.html"),[4,Tf().create({url:t})];case 3:n.sent(),n.label=4;case 4:return[2]}})})}),browser.proxy.settings.onChange.addListener(function(e){return _p(void 0,void 0,void 0,function(){var t,n,r;return xp(this,function(o){switch(o.label){case 0:return(t=ef())?[3,2]:[4,Ks()];case 1:t=o.sent(),o.label=2;case 2:return t?("controlled_by_this_extension"===e.levelOfControl||Jl(new Error((i=e.levelOfControl,a=null===(r=null===(n=e.value)||void 0===n?void 0:n.rules)||void 0===r?void 0:r.singleProxy,s=(null==a?void 0:a.host)||"",c=(null==a?void 0:a.port)||"",u=Boolean(s||c),l=u?"".concat(s,":").concat(c):"","controlled_by_other_extensions"===i?u?$o("Info").t(rp||(rp=wp(["Disconnected by another extension, it connected to ",""],["Disconnected by another extension, it connected to ",""])),l):$o("Info").t(op||(op=wp(["Disconnected by another extension"],["Disconnected by another extension"]))):u?$o("Info").t(ip||(ip=wp(["Disconnected, settings were overridden to ",""],["Disconnected, settings were overridden to ",""])),l):$o("Info").t(ap||(ap=wp(["Disconnected, settings were overridden"],["Disconnected, settings were overridden"])))))),[2]):[2]}var i,a,s,c,u,l})})}),browser.idle.onStateChanged.addListener(function(e){return Sp(void 0,void 0,void 0,function(){var t,n,r,o,i;return Ep(this,function(a){switch(a.label){case 0:return function(e){bs=e}(e),"active"!==e?[2]:"on"===(null==(t=bf())?void 0:t.name)||-1!==(null===(o=null===(r=null==t?void 0:t.data)||void 0===r?void 0:r.error)||void 0===o?void 0:o.httpStatus)?[3,3]:[4,Js.get()];case 1:return(n=null===(i=a.sent())||void 0===i?void 0:i.value)?[4,Xl({server:n})]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})})})}()}();